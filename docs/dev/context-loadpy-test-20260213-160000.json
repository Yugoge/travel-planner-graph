{
  "request_id": "dev-loadpy-test-20260213-160000",
  "timestamp": "2026-02-13T16:00:00Z",
  "requirement": {
    "original": "测试load.py脚本的360度无死角全情况下的运行良好程度并修复",
    "clarified": "Comprehensive testing of scripts/load.py across all parameter combinations and edge cases, fix any issues found",
    "what": "Test load.py with all possible parameter combinations: --agent/--agents, --level 1/2/3, --day, --poi, --poi-index, --pretty, --output",
    "why": "Ensure load.py works reliably in all scenarios to prevent data access issues during workflows",
    "where": ["scripts/load.py"],
    "scope": {
      "included": [
        "Test all parameter combinations",
        "Test edge cases (invalid trip, missing files, malformed JSON)",
        "Test with single agent vs multiple agents",
        "Test all 3 levels of data access",
        "Test day filtering",
        "Test POI extraction",
        "Test pretty vs compact output",
        "Test file output vs stdout",
        "Fix any bugs or issues found",
        "Document test results"
      ],
      "excluded": [
        "Changes to load.py architecture",
        "Changes to agent JSON schemas"
      ]
    },
    "success_criteria": [
      "All parameter combinations tested",
      "All edge cases handled gracefully",
      "No crashes or errors in valid scenarios",
      "Clear error messages for invalid inputs",
      "Test report generated with coverage matrix",
      "Any bugs fixed with regression tests"
    ]
  },
  "test_scenarios": {
    "basic": [
      "--agents timeline --level 1",
      "--agents timeline --level 2 --day 1",
      "--agents timeline --level 3 --day 1",
      "--agents timeline,meals,budget --level 3 --day 1",
      "--agents timeline --level 3 --day 1 --pretty"
    ],
    "edge_cases": [
      "Invalid trip slug",
      "Non-existent agent name",
      "Day out of range",
      "POI without level 3",
      "Malformed JSON in agent file",
      "Missing agent file",
      "--agent and --agents both specified",
      "Neither --agent nor --agents specified"
    ],
    "output_modes": [
      "stdout (default)",
      "--output /tmp/test.json",
      "--pretty (formatted)",
      "compact (default)"
    ]
  },
  "context": {
    "test_trip": "china-feb-15-mar-7-2026-20260202-195429",
    "valid_agents": ["timeline", "meals", "attractions", "entertainment", "shopping", "accommodation", "transportation", "budget"],
    "valid_days": "1-21",
    "environment": {
      "venv_path": "venv/",
      "python_version": "3.x"
    }
  },
  "development_approach": {
    "strategy": "Create comprehensive test script that runs all scenarios, captures output, validates results, reports failures",
    "script_to_create": "scripts/test-load-py.sh",
    "validation_approach": "Run test script, analyze output, fix any failures, re-run until all tests pass"
  }
}
