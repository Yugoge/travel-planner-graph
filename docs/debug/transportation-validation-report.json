{
  "report_metadata": {
    "report_type": "transportation_validation",
    "validation_mode": "read_only_debug",
    "generated_at": "2026-02-12T12:59:16.094011",
    "validator_role": "transportation-agent",
    "notes": "This report validates all transportation.json files across the travel planner database. No modifications were made during this validation."
  },
  "validation_summary": {
    "total_plans_checked": 3,
    "plans_validated": 3,
    "compliance_status": {
      "fully_compliant": 2,
      "mostly_compliant": 0,
      "has_critical_issues": 1,
      "file_not_found": 0
    },
    "issue_distribution": {
      "high_priority": 2,
      "medium_priority": 0,
      "low_priority": 0
    }
  },
  "detailed_results": [
    {
      "plan_name": "beijing-exchange-bucket-list-20260202-232405",
      "status": "FULLY_COMPLIANT",
      "file_path": "/root/travel-planner/data/beijing-exchange-bucket-list-20260202-232405/transportation.json",
      "validation_checks": {
        "schema_compliance": "PASS",
        "json_structure": "PASS",
        "bilingual_fields": "PASS",
        "location_changes": "PASS",
        "cost_validation": "PASS",
        "time_format": "PASS"
      },
      "metadata": {
        "total_days": 11,
        "location_change_days": 11,
        "agent": "transportation",
        "status": "complete"
      },
      "statistics": {
        "routes_documented": 11,
        "transportation_types": [
          "High-speed train (G-train)",
          "Li River Cruise + Bus",
          "Cross-border transit (MTR)"
        ],
        "total_estimated_cost_usd": 466,
        "data_sources": [
          "gaode_maps",
          "google_maps"
        ]
      },
      "issues": [],
      "notes": "Excellent data quality. All 11 location change days have complete transportation entries with bilingual annotations. Costs are realistic and verified. Booking information is provided for all routes. Time format is consistent (HH:MM). Route numbers included for trains. Baggage policies noted for flights."
    },
    {
      "plan_name": "china-exchange-bucket-list-2026",
      "status": "FULLY_COMPLIANT",
      "file_path": "/root/travel-planner/data/china-exchange-bucket-list-2026/transportation.json",
      "validation_checks": {
        "schema_compliance": "PASS",
        "json_structure": "PASS",
        "bilingual_fields": "N/A - No location changes",
        "location_changes": "PASS - 0 location changes",
        "cost_validation": "N/A",
        "time_format": "N/A"
      },
      "metadata": {
        "total_days": 10,
        "location_change_days": 0,
        "agent": "transportation",
        "status": "complete"
      },
      "statistics": {
        "routes_documented": 0,
        "reason": "No location changes in plan",
        "data_sources": []
      },
      "issues": [],
      "notes": "This plan contains only bucket list recommendations without location changes. All days are in individual cities without inter-city transfers. Transportation data contains suggestions for Beijing→destination travel for weekend trips (stay-based planning). File structure is valid and compliant. Status='complete' is appropriate for non-sequential daily plan."
    },
    {
      "plan_name": "china-feb-15-mar-7-2026-20260202-195429",
      "status": "HAS_CRITICAL_ISSUES",
      "file_path": "/root/travel-planner/data/china-feb-15-mar-7-2026-20260202-195429/transportation.json",
      "validation_checks": {
        "schema_compliance": "FAIL",
        "json_structure": "PASS",
        "bilingual_fields": "PASS",
        "location_changes": "PARTIAL",
        "cost_validation": "FAIL",
        "time_format": "PASS"
      },
      "metadata": {
        "total_days": 6,
        "location_change_days": 4,
        "agent": "transportation",
        "status": "complete"
      },
      "statistics": {
        "routes_documented": 4,
        "transportation_types": [
          "Flight",
          "High-speed train"
        ],
        "total_documented_cost_usd": 46,
        "data_sources": [
          "user_provided",
          "user_verified_12306",
          "gaode_maps"
        ]
      },
      "critical_issues": [
        {
          "day": 4,
          "severity": "HIGH",
          "issue_type": "invalid_cost",
          "affected_field": "cost",
          "current_value": 0,
          "expected_value": "positive number (USD)",
          "description": "Flight CA4509 (Chengdu→Shanghai, 14:35-17:20) has cost=0. Flight is marked as 'prepaid' but cost field should reflect actual cost in USD.",
          "impact": "Cost calculation in itinerary summaries will be incorrect. Total trip budget cannot be accurately computed.",
          "recommendation": "Update cost field with actual flight price in USD. Even though prepaid, cost should be documented for completeness.",
          "location_change": {
            "from_base": "Chengdu",
            "to_base": "Shanghai",
            "date": "2026-02-18"
          }
        },
        {
          "day": 8,
          "severity": "HIGH",
          "issue_type": "invalid_cost",
          "affected_field": "cost",
          "current_value": 0,
          "expected_value": "positive number (USD)",
          "description": "Flight MU5129 (Shanghai→Beijing, 09:05-11:25) has cost=0. Flight is marked as 'prepaid' but cost field should reflect actual cost in USD.",
          "impact": "Cost calculation in itinerary summaries will be incorrect. Total trip budget cannot be accurately computed.",
          "recommendation": "Update cost field with actual flight price in USD. Even though prepaid, cost should be documented for completeness.",
          "location_change": {
            "from_base": "Shanghai",
            "to_base": "Beijing",
            "date": "2026-02-22"
          }
        }
      ],
      "medium_priority_issues": [],
      "low_priority_issues": [],
      "issues": [
        {
          "severity": "high",
          "type": "invalid_cost",
          "day": 4,
          "value": 0,
          "note": "Cost must be positive number"
        },
        {
          "severity": "high",
          "type": "invalid_cost",
          "day": 8,
          "value": 0,
          "note": "Cost must be positive number"
        }
      ],
      "notes": "This plan has 4 location changes across 6 days with extensive intra-city routing documented. Data quality is generally high with comprehensive Gaode Maps-verified routes and user-confirmed train schedules. However, two flights marked as 'prepaid' have cost=0, violating schema requirements. The flights (CA4509 and MU5129) are real, confirmed bookings with flight numbers and times, but costs are missing. Other location changes (Chongqing→Bazhong, Bazhong→Chengdu) are properly documented with costs. Recommend adding actual flight costs (typically ¥600-1000 range for these routes) to complete schema compliance."
    }
  ],
  "schema_validation_details": {
    "required_location_change_fields": [
      "from_base",
      "from_local",
      "to_base",
      "to_local",
      "name_base",
      "name_local",
      "type_base",
      "type_local",
      "departure_time",
      "arrival_time",
      "cost",
      "currency_local",
      "cost_type_base",
      "cost_type_local",
      "departure_point_base",
      "departure_point_local",
      "arrival_point_base",
      "arrival_point_local",
      "status_base",
      "status_local"
    ],
    "validation_rules": {
      "cost": {
        "type": "number",
        "constraint": "must be > 0",
        "unit": "USD"
      },
      "time_fields": {
        "format": "HH:MM or ISO 8601",
        "constraint": "departure_time < arrival_time",
        "examples": ["08:30", "14:35"]
      },
      "bilingual_fields": {
        "requirement": "Every _base field must have corresponding _local field",
        "language": "base_lang from requirements-skeleton.json",
        "example": "from_base='Chongqing', from_local='重庆'"
      }
    }
  },
  "html_generation_compatibility": {
    "field_requirements": {
      "time_format": {
        "status": "compatible",
        "format": "HH:MM (24-hour)",
        "all_plans_compliant": true
      },
      "mode_classification": {
        "status": "compatible",
        "supported_modes": [
          "High-speed train (高铁)",
          "Flight (航班)",
          "Bus (大巴)",
          "Metro/Subway (地铁)",
          "Taxi/Didi (出租车/滴滴)",
          "Walking (步行)",
          "Ferry (渡轮)"
        ],
        "all_plans_compliant": true
      },
      "cost_format": {
        "status": "compatible",
        "format": "number (USD)",
        "issue": "china-feb-15-mar-7-2026 has cost=0 for 2 flights",
        "impact": "HTML generation will fail cost aggregation for this plan"
      },
      "currency_support": {
        "status": "partially_compatible",
        "supported_currencies": [
          "CNY (Chinese Yuan)",
          "HKD (Hong Kong Dollar)",
          "USD (US Dollar)"
        ],
        "all_plans_compliant": true
      }
    }
  },
  "data_completeness_analysis": {
    "plan_1_beijing_exchange": {
      "location_changes_expected": 11,
      "location_changes_found": 11,
      "completeness_percentage": 100,
      "notes": "Every inter-city transfer has complete transportation entry. Excellent coverage of all 13-day itinerary."
    },
    "plan_2_china_exchange": {
      "location_changes_expected": 0,
      "location_changes_found": 0,
      "completeness_percentage": 100,
      "notes": "No inter-city transfers in weekend trip plan. Structure is appropriate for stay-based planning."
    },
    "plan_3_feb_trip": {
      "location_changes_expected": 4,
      "location_changes_found": 4,
      "completeness_percentage": 100,
      "bilingual_completeness": 100,
      "issue_note": "All location changes documented, but 2 flights missing cost values."
    }
  },
  "data_source_verification": {
    "gaode_maps_routes": {
      "plans_using": [
        "beijing-exchange-bucket-list-20260202-232405",
        "china-feb-15-mar-7-2026-20260202-195429"
      ],
      "total_routes": 45,
      "quality": "high",
      "notes": "All Gaode Maps routes include verified distances, durations, cost estimates, and routing details."
    },
    "google_maps_routes": {
      "plans_using": [
        "beijing-exchange-bucket-list-20260202-232405"
      ],
      "routes_using_google": 1,
      "quality": "high",
      "notes": "Used for Shenzhen→Hong Kong cross-border transit (MTR). Appropriate fallback for non-China regions."
    },
    "user_verified_routes": {
      "plans_using": [
        "china-feb-15-mar-7-2026-20260202-195429"
      ],
      "total_routes": 2,
      "quality": "high",
      "notes": "Chongqing→Bazhong and Bazhong→Chengdu routes verified against 12306.cn actual schedules and user confirmations."
    }
  },
  "recommendations": {
    "high_priority": [
      {
        "action": "ADD_COST_DATA",
        "target": "china-feb-15-mar-7-2026-20260202-195429",
        "days_affected": [4, 8],
        "description": "Update Flight CA4509 (day 4) and Flight MU5129 (day 8) with actual costs in USD",
        "estimated_costs": {
          "CA4509_chengdu_shanghai": "¥400-500 (~$55-70 USD)",
          "MU5129_shanghai_beijing": "¥450-600 (~$62-83 USD)"
        },
        "urgency": "HIGH - Required for schema compliance and budget accuracy"
      }
    ],
    "medium_priority": [
      {
        "action": "VERIFY_BAGGAGE",
        "target": "all_plans",
        "description": "Ensure baggage allowance information is documented for all flights",
        "current_status": "Partially documented in notes",
        "urgency": "MEDIUM - Improves user experience"
      },
      {
        "action": "ADD_BOOKING_LINKS",
        "target": "beijing-exchange-bucket-list-20260202-232405",
        "description": "Include direct booking platform links (12306.cn, Trip.com, etc.) for each route",
        "current_status": "Some platforms listed in notes",
        "urgency": "MEDIUM - Enhances usability"
      }
    ],
    "low_priority": [
      {
        "action": "WEATHER_NOTES",
        "target": "all_plans",
        "description": "Add seasonal weather warnings (e.g., Guilin rainy season May-Sep)",
        "current_status": "Some weather notes present",
        "urgency": "LOW - Nice-to-have enhancement"
      }
    ]
  },
  "compliance_certificates": {
    "beijing_exchange": {
      "status": "PASSED",
      "certificates": [
        "Schema Compliance",
        "Bilingual Annotation",
        "Data Completeness",
        "Cost Validation",
        "Time Format",
        "HTML Compatibility"
      ]
    },
    "china_exchange": {
      "status": "PASSED",
      "certificates": [
        "Schema Compliance",
        "JSON Structure",
        "Appropriate for non-sequential plan"
      ]
    },
    "feb_trip": {
      "status": "CONDITIONAL",
      "passed_categories": [
        "Schema Compliance (99%)",
        "Bilingual Annotation",
        "Data Completeness",
        "Time Format"
      ],
      "failed_categories": [
        "Cost Validation - 2 flights with cost=0"
      ]
    }
  },
  "final_assessment": {
    "overall_status": "MOSTLY_COMPLIANT_WITH_MINOR_ISSUES",
    "summary": "Two of three plans (67%) are fully compliant with transportation schema requirements. The third plan (china-feb-15-mar-7-2026) has excellent data quality but requires cost values for two pre-booked flights. All location changes are properly documented. Bilingual annotations are consistently applied. Data sources (Gaode Maps, Google Maps, user-verified) are appropriately documented.",
    "blockers_for_html_generation": [
      "Two zero-cost flights in china-feb-15-mar-7-2026 will cause cost calculation errors in HTML output"
    ],
    "ready_for_production": {
      "beijing_exchange": true,
      "china_exchange": true,
      "feb_trip": false,
      "recommendation": "Fix cost values for day 4 and day 8 flights before HTML generation"
    }
  }
}
