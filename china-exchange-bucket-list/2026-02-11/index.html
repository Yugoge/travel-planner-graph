<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>China Exchange Bucket List - 10 Destination Cities</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      overflow-x: hidden;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    // Embedded PLAN_DATA
    const PLAN_DATA = {
  "trip_summary": {
    "trip_type": "Bucket List",
    "trip_type_local": "",
    "description": "China Exchange Bucket List - 10 Destination Cities",
    "description_local": "",
    "base_location": "Beijing",
    "period": "0 days",
    "period_local": "",
    "travelers": "1 adult",
    "travelers_local": "",
    "budget_per_trip": "‚Ç¨200-500 per trip",
    "preferences": "Cultural exploration, natural scenery, food experiences, Exchange student budget, weekend availability",
    "base_display": "EN",
    "local_display": "Local",
    "ui_labels": {
      "base_display": "EN",
      "local_display": "Local",
      "base": {
        "time": "Time",
        "cost": "Cost",
        "type": "Type",
        "stars": "Stars",
        "checkin": "Check-in",
        "checkout": "Check-out",
        "location": "Location",
        "cuisine": "Cuisine",
        "signature": "Signature Dishes",
        "opening_hours": "Opening Hours",
        "duration": "Duration",
        "route": "Route",
        "route_number": "Route Number",
        "company": "Company",
        "status": "Status",
        "amenities": "Amenities",
        "links": "Links",
        "user_plans": "User Plans",
        "meals": "Meals",
        "attractions": "Attractions",
        "entertainment": "Entertainment",
        "accommodation": "Accommodation",
        "transportation": "Transportation",
        "shopping": "Shopping",
        "budget": "Budget",
        "transport": "Transport",
        "trip_type": "Trip Type",
        "base_location": "Base Location",
        "period": "Period",
        "travelers": "Travelers",
        "budget_trip": "Budget / Trip",
        "breakfast": "Breakfast",
        "lunch": "Lunch",
        "dinner": "Dinner",
        "cat_breakfast": "Breakfast",
        "cat_lunch": "Lunch",
        "cat_dinner": "Dinner",
        "cat_attraction": "Attraction",
        "cat_entertainment": "Entertainment",
        "cat_checkin": "Check-in",
        "kanban_view": "Kanban View",
        "timeline_view": "Timeline View",
        "prepaid": "Prepaid",
        "free": "Free",
        "optional": "Optional",
        "show_less": "Show less",
        "show_more": "Show more",
        "no_items": "No items in this category",
        "no_timeline": "No timeline data available",
        "no_timeline_sub": "This day has no scheduled activities with time information",
        "coming_soon": "Itinerary coming soon...",
        "day_prefix": "Day",
        "day_format": "Day {n}",
        "days_count": "{n} days",
        "days_count_1": "1 day",
        "total": "Total",
        "google_maps": "Google Maps",
        "booking_link": "Booking",
        "link": "Link",
        "open_google": "Open in Google Maps",
        "search_rednote": "Search on Xiaohongshu",
        "urgent": "URGENT",
        "required": "REQUIRED",
        "verified": "VERIFIED",
        "recommended": "RECOMMENDED",
        "high_speed_train": "High-speed Train",
        "flight": "Flight",
        "booking_required": "Booking Required"
      },
      "local": {}
    }
  },
  "trips": [
    {
      "name": "Xi'an",
      "name_local": "",
      "days_count": 2,
      "cover": "",
      "days": [
        {
          "day": 1,
          "date": "Day 1",
          "location": "Xi'an",
          "location_local": "",
          "cover": "",
          "user_plans": [
            "Terracotta Warriors visit",
            "Ancient City Wall experience",
            "Muslim Quarter food exploration",
            "Historical sites",
            "Best months: March, April, May",
            "Trip type: weekend_extended"
          ],
          "meals": {},
          "attractions": [
            {
              "name_base": "Terracotta Army Museum",
              "name_local": "Áß¶ÂßãÁöáÂÖµÈ©¨‰øëÂçöÁâ©È¶Ü",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Historical Site",
              "type_local": "",
              "cost": 15.552855407047387,
              "cost_local": 128.0,
              "opening_hours": "08:30-18:00 (Mar-Nov), 08:30-17:30 (Dec-Feb)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/7fff5e779ae4b3f4b01307e04e3a40d7",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Xi'an City Wall",
              "name_local": "Ë•øÂÆâÂüéÂ¢ô",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Historical Site",
              "type_local": "",
              "cost": 6.804374240583232,
              "cost_local": 56.0,
              "opening_hours": "08:00-22:00 (summer), 08:00-19:00 (winter)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/f858d7753932ea21d02a7990a5bec413",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Muslim Quarter",
              "name_local": "ÂõûÊ∞ëË°ó",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Cultural District",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (food stalls peak 10:00-22:00)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/d26415f3cec64b43dec8326299534486",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Moxy Xi'an Downtown",
            "name_local": "Ë•øÂÆâÁπÅÂçé‰∏≠ÂøÉËé´ÂÖãË•øÈÖíÂ∫ó",
            "type_base": "Mid-Range",
            "type_local": "",
            "location_base": "282 Xiyi Rd, Xincheng District",
            "location_local": "282 Xiyi Rd, Xincheng District",
            "coordinates": {},
            "cost": 63.183475091130006,
            "cost_local": 520.0,
            "stars": 0,
            "amenities_base": [
              "Modern design",
              "Central location",
              "Near nightlife",
              "International brand",
              "Young vibe"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/7b0e631d5e40aac2f27af044dc7bdf04"
          },
          "transportation": {
            "name_base": "Beijing ‚Üí Xi'an",
            "name_local": "",
            "from_base": "Beijing",
            "to_base": "Xi'an",
            "from_local": "",
            "to_local": "",
            "departure_point_base": "Beijing West Railway Station",
            "departure_point_local": "Beijing West Railway Station",
            "arrival_point_base": "Xi'an North Railway Station",
            "arrival_point_local": "Xi'an North Railway Station",
            "type_base": "G-train",
            "type_local": "",
            "icon": "üöÑ",
            "route_number": "G55/G56",
            "company_base": "",
            "company_local": "",
            "cost": 65,
            "cost_local": 520,
            "cost_type_base": "",
            "cost_type_local": "",
            "status_base": "RECOMMENDED",
            "status_local": "",
            "notes_base": "Duration: 4.5h | Frequency: 22 daily departures | Fastest option, convenient for luggage. Book 2-3 weeks ahead for holidays.",
            "notes_local": "",
            "time": {
              "start": "06:39",
              "end": "12:00"
            }
          },
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 22.357229647630618,
            "entertainment": 0,
            "accommodation": 63.183475091130006,
            "shopping": 0,
            "transportation": 65,
            "total": 150.5407047387606
          }
        },
        {
          "day": 2,
          "date": "Day 2",
          "location": "Xi'an",
          "location_local": "",
          "cover": "",
          "user_plans": [],
          "meals": {},
          "attractions": [
            {
              "name_base": "Big Wild Goose Pagoda",
              "name_local": "Â§ßÈõÅÂ°î",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Religious Site",
              "type_local": "",
              "cost": 5.346294046172539,
              "cost_local": 44.0,
              "opening_hours": "08:00-17:30 (last entry 17:00)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/00f713e61c99c4956ab27df73afdde71",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Shaanxi History Museum",
              "name_local": "ÈôïË•øÂéÜÂè≤ÂçöÁâ©È¶Ü",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Museum",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "09:00-17:30 (closed Mondays), last entry 16:00",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/62a12f5596a19455be8bddea89f87bb3",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Mount Huashan",
              "name_local": "ÂçéÂ±±",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 20.413122721749694,
              "cost_local": 168.0,
              "opening_hours": "24/7 (cable cars operate 07:00-19:00)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/51279a07d6da0f46ddd4a11183d9c1bc",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Moxy Xi'an Downtown",
            "name_local": "Ë•øÂÆâÁπÅÂçé‰∏≠ÂøÉËé´ÂÖãË•øÈÖíÂ∫ó",
            "type_base": "Mid-Range",
            "type_local": "",
            "location_base": "282 Xiyi Rd, Xincheng District",
            "location_local": "282 Xiyi Rd, Xincheng District",
            "coordinates": {},
            "cost": 63.183475091130006,
            "cost_local": 520.0,
            "stars": 0,
            "amenities_base": [
              "Modern design",
              "Central location",
              "Near nightlife",
              "International brand",
              "Young vibe"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/7b0e631d5e40aac2f27af044dc7bdf04"
          },
          "transportation": null,
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 25.759416767922232,
            "entertainment": 0,
            "accommodation": 63.183475091130006,
            "shopping": 0,
            "transportation": 0,
            "total": 88.94289185905224
          }
        }
      ]
    },
    {
      "name": "Tianjin",
      "name_local": "",
      "days_count": 1,
      "cover": "",
      "days": [
        {
          "day": 3,
          "date": "Day 3",
          "location": "Tianjin",
          "location_local": "",
          "cover": "",
          "user_plans": [
            "Italian Style Street",
            "Architecture exploration",
            "Day trip option from Beijing",
            "Best months: March, April, May, June",
            "Trip type: weekend_short"
          ],
          "meals": {},
          "attractions": [
            {
              "name_base": "Italian Style Street",
              "name_local": "ÊÑèÂ§ßÂà©È£éÊÉÖË°ó",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Cultural District",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (shops and cafes typically 10:00-22:00)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/52d1de4e7ea0cc8f42dce4c12dd3a3cc",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Tianjin Eye",
              "name_local": "Â§©Ê¥•‰πãÁúº",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Modern Attraction",
              "type_local": "",
              "cost": 8.748481166464154,
              "cost_local": 72.0,
              "opening_hours": "09:30-21:30 (weekdays), 09:30-22:00 (weekends)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/5aff6d3ff23183316cbf3705b47d2398",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Ancient Culture Street",
              "name_local": "Âè§ÊñáÂåñË°ó",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Cultural District",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "09:00-22:00 (shops vary)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/96241eb72b50ecf42ca1fd8cb0e91dfb",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            },
            {
              "name_base": "Five Great Avenues",
              "name_local": "‰∫îÂ§ßÈÅì",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Architectural District",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (museums within have specific hours)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/3138223e49d8298d3b62d0b2105acc6b",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "17:30",
                "end": "19:30"
              },
              "links": {}
            },
            {
              "name_base": "Porcelain House",
              "name_local": "Áì∑ÊàøÂ≠ê",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Museum",
              "type_local": "",
              "cost": 6.804374240583232,
              "cost_local": 56.0,
              "opening_hours": "09:00-18:00",
              "optional": false,
              "image": "https://aos-cdn-image.amap.com/sns/ugccomment/3f36409c-8095-41a3-ae32-2f661142a871.jpg",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "20:00",
                "end": "22:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Pan Pacific Tianjin",
            "name_local": "Â§©Ê¥•Ê≥õÂ§™Âπ≥Ê¥ãÂ§ßÈÖíÂ∫ó",
            "type_base": "High-End",
            "type_local": "",
            "location_base": "Hongqiao District",
            "location_local": "Hongqiao District",
            "coordinates": {},
            "cost": 82.62454434993924,
            "cost_local": 680.0,
            "stars": 0,
            "amenities_base": [
              "Luxury international brand",
              "River views",
              "Excellent service",
              "Central location"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/ddb0a00ceeef0055969051096f60d49d"
          },
          "transportation": {
            "name_base": "Beijing ‚Üí Tianjin",
            "name_local": "",
            "from_base": "Beijing",
            "to_base": "Tianjin",
            "from_local": "",
            "to_local": "",
            "departure_point_base": "Beijing South Railway Station",
            "departure_point_local": "Beijing South Railway Station",
            "arrival_point_base": "Tianjin Railway Station",
            "arrival_point_local": "Tianjin Railway Station",
            "type_base": "C-train",
            "type_local": "",
            "icon": "üöÑ",
            "route_number": "",
            "company_base": "",
            "company_local": "",
            "cost": 7,
            "cost_local": 58,
            "cost_type_base": "",
            "cost_type_local": "",
            "status_base": "RECOMMENDED",
            "status_local": "",
            "notes_base": "Duration: 30 minutes | Frequency: Every 20 minutes, 200+ daily departures | Fastest and most convenient. Day trip possible. Non-stop trains (C2001-C2198) are fastest.",
            "notes_local": "",
            "time": {
              "start": "06:00",
              "end": "12:00"
            }
          },
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 15.552855407047385,
            "entertainment": 0,
            "accommodation": 82.62454434993924,
            "shopping": 0,
            "transportation": 7,
            "total": 105.17739975698663
          }
        }
      ]
    },
    {
      "name": "Suzhou",
      "name_local": "",
      "days_count": 2,
      "cover": "",
      "days": [
        {
          "day": 4,
          "date": "Day 4",
          "location": "Suzhou",
          "location_local": "",
          "cover": "",
          "user_plans": [
            "Classical gardens exploration",
            "Water town experience",
            "Traditional culture",
            "Best months: March, April, May",
            "Trip type: weekend"
          ],
          "meals": {},
          "attractions": [
            {
              "name_base": "Humble Administrator's Garden",
              "name_local": "ÊãôÊîøÂõ≠",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Classical Garden",
              "type_local": "",
              "cost": 10.692588092345078,
              "cost_local": 88.0,
              "opening_hours": "07:30-17:30 (Mar-May), 07:30-17:00 (Nov-Feb)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/72263ebfa1dfbeefe0269400e6ba822f",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Lingering Garden",
              "name_local": "ÁïôÂõ≠",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Classical Garden",
              "type_local": "",
              "cost": 7.290400972053463,
              "cost_local": 60.0,
              "opening_hours": "07:30-17:00",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/9a023735af5bae8759d1ad0ddeaf45d3",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Pingjiang Road Historic District",
              "name_local": "Âπ≥Ê±üË∑ØÂéÜÂè≤Ë°óÂå∫",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Cultural District",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (shops 10:00-22:00)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/5b8d0cdca4174cc7a052a5e06035975f",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Scholars Hotel PingJiangFu Suzhou",
            "name_local": "ËãèÂ∑û‰π¶È¶ôÂ∫úÈÇ∏ÈÖíÂ∫óÂπ≥Ê±üÂ∫ú",
            "type_base": "Mid-Range",
            "type_local": "",
            "location_base": "60 Baita E Rd, Gusu District",
            "location_local": "60 Baita E Rd, Gusu District",
            "coordinates": {},
            "cost": 63.183475091130006,
            "cost_local": 520.0,
            "stars": 0,
            "amenities_base": [
              "Traditional Chinese architecture",
              "On Pingjiang Road",
              "Boutique hotel",
              "Cultural experience",
              "Garden courtyard"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/f66c76e98158c95bb4d77014802ac048"
          },
          "transportation": {
            "name_base": "Beijing ‚Üí Suzhou",
            "name_local": "",
            "from_base": "Beijing",
            "to_base": "Suzhou",
            "from_local": "",
            "to_local": "",
            "departure_point_base": "Beijing South Railway Station",
            "departure_point_local": "Beijing South Railway Station",
            "arrival_point_base": "Suzhou North Railway Station",
            "arrival_point_local": "Suzhou North Railway Station",
            "type_base": "G-train",
            "type_local": "",
            "icon": "üöÑ",
            "route_number": "",
            "company_base": "",
            "company_local": "",
            "cost": 68,
            "cost_local": 550,
            "cost_type_base": "",
            "cost_type_local": "",
            "status_base": "RECOMMENDED",
            "status_local": "",
            "notes_base": "Duration: 5h | Frequency: 34 daily departures | Comfortable and scenic. Fastest trains take 4h 10min.",
            "notes_local": "",
            "time": {
              "start": "07:39",
              "end": "12:00"
            }
          },
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 17.98298906439854,
            "entertainment": 0,
            "accommodation": 63.183475091130006,
            "shopping": 0,
            "transportation": 68,
            "total": 149.16646415552856
          }
        },
        {
          "day": 5,
          "date": "Day 5",
          "location": "Suzhou",
          "location_local": "",
          "cover": "",
          "user_plans": [],
          "meals": {},
          "attractions": [
            {
              "name_base": "Tiger Hill",
              "name_local": "Ëôé‰∏ò",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Historical Site",
              "type_local": "",
              "cost": 10.692588092345078,
              "cost_local": 88.0,
              "opening_hours": "07:30-17:30 (summer), 07:30-17:00 (winter)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/111735141e7df5df834172fe6dec5e78",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Zhouzhuang Water Town",
              "name_local": "Âë®Â∫ÑÂè§Èïá",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Water Town",
              "type_local": "",
              "cost": 13.122721749696233,
              "cost_local": 108.0,
              "opening_hours": "08:00-21:00 (day ticket), overnight stay available",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/c25463f31b94e681d96182971e40d73d",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Suzhou Museum",
              "name_local": "ËãèÂ∑ûÂçöÁâ©È¶Ü",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Museum",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "09:00-17:00 (closed Mondays), last entry 16:00",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/aced2ad6e6cebff9f83132f53195b0a5",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Scholars Hotel PingJiangFu Suzhou",
            "name_local": "ËãèÂ∑û‰π¶È¶ôÂ∫úÈÇ∏ÈÖíÂ∫óÂπ≥Ê±üÂ∫ú",
            "type_base": "Mid-Range",
            "type_local": "",
            "location_base": "60 Baita E Rd, Gusu District",
            "location_local": "60 Baita E Rd, Gusu District",
            "coordinates": {},
            "cost": 63.183475091130006,
            "cost_local": 520.0,
            "stars": 0,
            "amenities_base": [
              "Traditional Chinese architecture",
              "On Pingjiang Road",
              "Boutique hotel",
              "Cultural experience",
              "Garden courtyard"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/f66c76e98158c95bb4d77014802ac048"
          },
          "transportation": null,
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 23.81530984204131,
            "entertainment": 0,
            "accommodation": 63.183475091130006,
            "shopping": 0,
            "transportation": 0,
            "total": 86.99878493317132
          }
        }
      ]
    },
    {
      "name": "Hangzhou",
      "name_local": "",
      "days_count": 2,
      "cover": "",
      "days": [
        {
          "day": 6,
          "date": "Day 6",
          "location": "Hangzhou",
          "location_local": "",
          "cover": "",
          "user_plans": [
            "West Lake scenic area",
            "Tea culture experience",
            "Natural beauty",
            "Can combine with Suzhou",
            "Best months: March, April, May",
            "Trip type: weekend"
          ],
          "meals": {},
          "attractions": [
            {
              "name_base": "West Lake",
              "name_local": "Ë•øÊπñ",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (temples and attractions have individual hours)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/046f7db069e380fdc29375807debee83",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Lingyin Temple",
              "name_local": "ÁÅµÈöêÂØ∫",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Religious Site",
              "type_local": "",
              "cost": 5.83232077764277,
              "cost_local": 48.0,
              "opening_hours": "07:00-17:30 (temple), 07:00-18:00 (Feilai Feng scenic area)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/4aa0a6a1b6ee72c9833441f363cbb43a",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Longjing Tea Plantations",
              "name_local": "Èæô‰∫ïËå∂Âõ≠",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Cultural Experience",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (tea houses typically 08:00-18:00)",
              "optional": false,
              "image": "",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Grand Hyatt Hangzhou",
            "name_local": "Êù≠Â∑ûÂêõÊÇ¶ÈÖíÂ∫ó",
            "type_base": "High-End",
            "type_local": "",
            "location_base": "28 Hu Bin Road",
            "location_local": "28 Hu Bin Road",
            "coordinates": {},
            "cost": 102.06561360874848,
            "cost_local": 840.0,
            "stars": 0,
            "amenities_base": [
              "Directly on West Lake",
              "Stunning lake views",
              "Luxury facilities",
              "Pool and spa",
              "Multiple restaurants"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/24b28860f9dd77862da4615252ba76e1"
          },
          "transportation": {
            "name_base": "Beijing ‚Üí Hangzhou",
            "name_local": "",
            "from_base": "Beijing",
            "to_base": "Hangzhou",
            "from_local": "",
            "to_local": "",
            "departure_point_base": "Beijing South Railway Station",
            "departure_point_local": "Beijing South Railway Station",
            "arrival_point_base": "Hangzhou East Railway Station",
            "arrival_point_local": "Hangzhou East Railway Station",
            "type_base": "G-train/D-train",
            "type_local": "",
            "icon": "üöÑ",
            "route_number": "",
            "company_base": "",
            "company_local": "",
            "cost": 77,
            "cost_local": 618,
            "cost_type_base": "",
            "cost_type_local": "",
            "status_base": "RECOMMENDED",
            "status_local": "",
            "notes_base": "Duration: 5.5h | Frequency: 25 daily departures | Fuxing trains are fastest (4.5 hours). Book 2-3 weeks ahead for holidays.",
            "notes_local": "",
            "time": {
              "start": "06:30",
              "end": "12:00"
            }
          },
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 5.83232077764277,
            "entertainment": 0,
            "accommodation": 102.06561360874848,
            "shopping": 0,
            "transportation": 77,
            "total": 184.89793438639123
          }
        },
        {
          "day": 7,
          "date": "Day 7",
          "location": "Hangzhou",
          "location_local": "",
          "cover": "",
          "user_plans": [],
          "meals": {},
          "attractions": [
            {
              "name_base": "Xixi National Wetland Park",
              "name_local": "Ë•øÊ∫™ÂõΩÂÆ∂ÊπøÂú∞ÂÖ¨Âõ≠",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 10.692588092345078,
              "cost_local": 88.0,
              "opening_hours": "08:00-17:30 (Apr-Oct), 08:30-17:00 (Nov-Mar)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/ee8ba4fd213aa0ee5605e41415921500",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Leifeng Pagoda",
              "name_local": "Èõ∑Â≥∞Â°î",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Historical Site",
              "type_local": "",
              "cost": 5.346294046172539,
              "cost_local": 44.0,
              "opening_hours": "08:00-19:00 (summer), 08:00-17:30 (winter)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/58fbc3bf5460862ef2056ae1aa053754",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Hefang Street",
              "name_local": "Ê≤≥ÂùäË°ó",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Cultural District",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (shops 09:00-22:00)",
              "optional": false,
              "image": "https://aos-comment.amap.com/B0FFGQ772L/comment/dfda683d7fd2855875b23a290a590d3b_2048_2048_80.jpg",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Grand Hyatt Hangzhou",
            "name_local": "Êù≠Â∑ûÂêõÊÇ¶ÈÖíÂ∫ó",
            "type_base": "High-End",
            "type_local": "",
            "location_base": "28 Hu Bin Road",
            "location_local": "28 Hu Bin Road",
            "coordinates": {},
            "cost": 102.06561360874848,
            "cost_local": 840.0,
            "stars": 0,
            "amenities_base": [
              "Directly on West Lake",
              "Stunning lake views",
              "Luxury facilities",
              "Pool and spa",
              "Multiple restaurants"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/24b28860f9dd77862da4615252ba76e1"
          },
          "transportation": null,
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 16.038882138517618,
            "entertainment": 0,
            "accommodation": 102.06561360874848,
            "shopping": 0,
            "transportation": 0,
            "total": 118.1044957472661
          }
        }
      ]
    },
    {
      "name": "Guangzhou",
      "name_local": "",
      "days_count": 2,
      "cover": "",
      "days": [
        {
          "day": 8,
          "date": "Day 8",
          "location": "Guangzhou",
          "location_local": "",
          "cover": "",
          "user_plans": [
            "Cantonese food culture",
            "Modern city exploration",
            "Historical sites",
            "Best months: March, April, May",
            "Trip type: long_weekend"
          ],
          "meals": {},
          "attractions": [
            {
              "name_base": "Canton Tower",
              "name_local": "ÂπøÂ∑ûÂ°î",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Modern Attraction",
              "type_local": "",
              "cost": 20.413122721749694,
              "cost_local": 168.0,
              "opening_hours": "09:30-22:30",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/d5b56df50d024cbd33e4e1a16f77d419",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Shamian Island",
              "name_local": "Ê≤ôÈù¢Â≤õ",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Cultural District",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/ad345a3ea010cb6550eb6c045ff3a0b0",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Chen Clan Ancestral Hall",
              "name_local": "ÈôàÂÆ∂Á•†",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Historical Site",
              "type_local": "",
              "cost": 1.3608748481166462,
              "cost_local": 11.2,
              "opening_hours": "08:30-17:30 (last entry 17:00)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/0aaa86ae54f2cf06451f30fd5db7ad58",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            },
            {
              "name_base": "Baiyun Mountain",
              "name_local": "ÁôΩ‰∫ëÂ±±",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 0.6804374240583231,
              "cost_local": 5.6,
              "opening_hours": "06:00-21:00",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/18806769bd40794b77f7fb90252373b1",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "17:30",
                "end": "19:30"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Fraser Suites Guangzhou",
            "name_local": "ÂπøÂ∑ûËæâÁõõÈòÅÂõΩÈôÖÂÖ¨ÂØì",
            "type_base": "High-End",
            "type_local": "",
            "location_base": "230 Tianhe Rd, Tianhe District",
            "location_local": "230 Tianhe Rd, Tianhe District",
            "coordinates": {},
            "cost": 87.48481166464155,
            "cost_local": 720.0,
            "stars": 0,
            "amenities_base": [
              "Serviced apartments",
              "Full kitchen",
              "Spacious suites",
              "Pool and gym",
              "Central Tianhe location"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/4021ab40c89a46469432089fbf20b290"
          },
          "transportation": {
            "name_base": "Beijing ‚Üí Guangzhou",
            "name_local": "",
            "from_base": "Beijing",
            "to_base": "Guangzhou",
            "from_local": "",
            "to_local": "",
            "departure_point_base": "Beijing Capital (PEK) or Daxing (PKX)",
            "departure_point_local": "Beijing Capital (PEK) or Daxing (PKX)",
            "arrival_point_base": "Guangzhou Baiyun International Airport (CAN)",
            "arrival_point_local": "Guangzhou Baiyun International Airport (CAN)",
            "type_base": "Flight",
            "type_local": "",
            "icon": "‚úàÔ∏è",
            "route_number": "",
            "company_base": "",
            "company_local": "",
            "cost": 87,
            "cost_local": 700,
            "cost_type_base": "",
            "cost_type_local": "",
            "status_base": "RECOMMENDED",
            "status_local": "",
            "notes_base": "Duration: 3.5h | Frequency: 20+ daily flights | Much faster. Budget airlines available off-season. Add 2-3 hours for airport transfers.",
            "notes_local": "",
            "time": {
              "start": "09:00",
              "end": "12:00"
            }
          },
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 22.45443499392466,
            "entertainment": 0,
            "accommodation": 87.48481166464155,
            "shopping": 0,
            "transportation": 87,
            "total": 196.93924665856622
          }
        },
        {
          "day": 9,
          "date": "Day 9",
          "location": "Guangzhou",
          "location_local": "",
          "cover": "",
          "user_plans": [],
          "meals": {},
          "attractions": [
            {
              "name_base": "Sacred Heart Cathedral",
              "name_local": "Áü≥ÂÆ§Âú£ÂøÉÂ§ßÊïôÂ†Ç",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Religious Site",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "08:30-11:30, 14:30-17:30 (closed during services)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/abe02cda06c0e5c79e58e6a65e44fd87",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Yuexiu Park & Five Rams Statue",
              "name_local": "Ë∂äÁßÄÂÖ¨Âõ≠ & ‰∫îÁæäÈõïÂÉè",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Park",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "06:00-21:00 (park), 09:00-17:30 (museum)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/72ca990c37c72a6e1bab954f06e32791",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Beijing Road Pedestrian Street",
              "name_local": "Âåó‰∫¨Ë∑ØÊ≠•Ë°åË°ó",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Shopping District",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (shops 10:00-22:00)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/a199f9539ee0de4ee404d9a099bafc1f",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Fraser Suites Guangzhou",
            "name_local": "ÂπøÂ∑ûËæâÁõõÈòÅÂõΩÈôÖÂÖ¨ÂØì",
            "type_base": "High-End",
            "type_local": "",
            "location_base": "230 Tianhe Rd, Tianhe District",
            "location_local": "230 Tianhe Rd, Tianhe District",
            "coordinates": {},
            "cost": 87.48481166464155,
            "cost_local": 720.0,
            "stars": 0,
            "amenities_base": [
              "Serviced apartments",
              "Full kitchen",
              "Spacious suites",
              "Pool and gym",
              "Central Tianhe location"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/4021ab40c89a46469432089fbf20b290"
          },
          "transportation": null,
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 0,
            "entertainment": 0,
            "accommodation": 87.48481166464155,
            "shopping": 0,
            "transportation": 0,
            "total": 87.48481166464155
          }
        }
      ]
    },
    {
      "name": "Xiamen",
      "name_local": "",
      "days_count": 2,
      "cover": "",
      "days": [
        {
          "day": 10,
          "date": "Day 10",
          "location": "Xiamen",
          "location_local": "",
          "cover": "",
          "user_plans": [
            "Gulangyu Island",
            "Coastal scenery",
            "Colonial architecture",
            "Beach relaxation",
            "Best months: March, April, May",
            "Trip type: long_weekend"
          ],
          "meals": {},
          "attractions": [
            {
              "name_base": "Gulangyu Island",
              "name_local": "ÈºìÊµ™Â±ø",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Island",
              "type_local": "",
              "cost": 4.860267314702308,
              "cost_local": 40.0,
              "opening_hours": "24/7 (ferry schedule: 07:00-18:30)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/05b0e6e576cf50058e6e2fad7e7dacdc",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Xiamen University",
              "name_local": "Âé¶Èó®Â§ßÂ≠¶",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Campus",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "12:00-14:00, 17:30-24:00 (visitor access restricted to certain hours)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/4c6ef9f1f434a4e3c612a69b96348318",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Zengcuoan Village",
              "name_local": "ÊõæÂéùÂûµ",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Cultural District",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (shops/restaurants 10:00-23:00)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/9070a7cc55af8a233efa96fadc00ddf4",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            },
            {
              "name_base": "Nanputuo Temple",
              "name_local": "ÂçóÊôÆÈôÄÂØ∫",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Religious Site",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "04:00-18:00 (summer), 04:00-17:00 (winter)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/d9523753748f0cf2e26af8e5bffc8f89",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "17:30",
                "end": "19:30"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Millennium Harbourview Hotel Xiamen",
            "name_local": "Âé¶Èó®Êµ∑ÊôØÂçÉÁ¶ßÂ§ßÈÖíÂ∫ó",
            "type_base": "High-End",
            "type_local": "",
            "location_base": "12 Zhenhai Rd, Siming District",
            "location_local": "12 Zhenhai Rd, Siming District",
            "coordinates": {},
            "cost": 92.34507897934385,
            "cost_local": 760.0,
            "stars": 0,
            "amenities_base": [
              "Sea views",
              "Near Gulangyu ferry",
              "International brand",
              "Harbor location",
              "Comfortable rooms"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/0b4220d7b7670d0f2adcfed06bb1b933"
          },
          "transportation": {
            "name_base": "Beijing ‚Üí Xiamen",
            "name_local": "",
            "from_base": "Beijing",
            "to_base": "Xiamen",
            "from_local": "",
            "to_local": "",
            "departure_point_base": "Beijing Capital International Airport (PEK)",
            "departure_point_local": "Beijing Capital International Airport (PEK)",
            "arrival_point_base": "Xiamen Gaoqi International Airport (XMN)",
            "arrival_point_local": "Xiamen Gaoqi International Airport (XMN)",
            "type_base": "Flight",
            "type_local": "",
            "icon": "‚úàÔ∏è",
            "route_number": "",
            "company_base": "",
            "company_local": "",
            "cost": 112,
            "cost_local": 900,
            "cost_type_base": "",
            "cost_type_local": "",
            "status_base": "RECOMMENDED",
            "status_local": "",
            "notes_base": "Duration: 3h | Frequency: 12 direct flights daily (hourly) | Fastest option. Add 2-3 hours for airport transfers.",
            "notes_local": "",
            "time": {
              "start": "09:00",
              "end": "12:00"
            }
          },
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 4.860267314702308,
            "entertainment": 0,
            "accommodation": 92.34507897934385,
            "shopping": 0,
            "transportation": 112,
            "total": 209.20534629404617
          }
        },
        {
          "day": 11,
          "date": "Day 11",
          "location": "Xiamen",
          "location_local": "",
          "cover": "",
          "user_plans": [],
          "meals": {},
          "attractions": [
            {
              "name_base": "Hulishan Fortress",
              "name_local": "ËÉ°ÈáåÂ±±ÁÇÆÂè∞",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Historical Site",
              "type_local": "",
              "cost": 3.3049817739975698,
              "cost_local": 27.2,
              "opening_hours": "08:00-18:00",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/82ef7e11e1d17a132a0b5fcba9a8bada",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Zhongshan Road Pedestrian Street",
              "name_local": "‰∏≠Â±±Ë∑ØÊ≠•Ë°åË°ó",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Shopping District",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (shops 10:00-22:00)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/654bdaaa16ffeee0a8df58c6edd5864a",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Wanshi Botanical Garden",
              "name_local": "‰∏áÁü≥Ê§çÁâ©Âõ≠",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Botanical Garden",
              "type_local": "",
              "cost": 5.346294046172539,
              "cost_local": 44.0,
              "opening_hours": "06:30-18:00",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/a63581fcb3adda672d35f22d835504a4",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Millennium Harbourview Hotel Xiamen",
            "name_local": "Âé¶Èó®Êµ∑ÊôØÂçÉÁ¶ßÂ§ßÈÖíÂ∫ó",
            "type_base": "High-End",
            "type_local": "",
            "location_base": "12 Zhenhai Rd, Siming District",
            "location_local": "12 Zhenhai Rd, Siming District",
            "coordinates": {},
            "cost": 92.34507897934385,
            "cost_local": 760.0,
            "stars": 0,
            "amenities_base": [
              "Sea views",
              "Near Gulangyu ferry",
              "International brand",
              "Harbor location",
              "Comfortable rooms"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/0b4220d7b7670d0f2adcfed06bb1b933"
          },
          "transportation": null,
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 8.65127582017011,
            "entertainment": 0,
            "accommodation": 92.34507897934385,
            "shopping": 0,
            "transportation": 0,
            "total": 100.99635479951397
          }
        }
      ]
    },
    {
      "name": "Guilin",
      "name_local": "",
      "days_count": 2,
      "cover": "",
      "days": [
        {
          "day": 12,
          "date": "Day 12",
          "location": "Guilin",
          "location_local": "",
          "cover": "",
          "user_plans": [
            "Li River cruise",
            "Yangshuo karst landscapes",
            "Unique natural scenery",
            "Rural exploration",
            "Best months: April, May",
            "Trip type: holiday"
          ],
          "meals": {},
          "attractions": [
            {
              "name_base": "Li River Cruise",
              "name_local": "ÊºìÊ±üÊ∏∏Ëàπ",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 33.049817739975694,
              "cost_local": 272.0,
              "opening_hours": "Departures 09:00-10:00 (season dependent)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/342f87c869aff2e324eb3ade46e3855e",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Yangshuo Countryside & West Street",
              "name_local": "Èò≥Êúî‰π°Êùë & Ë•øË°ó",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7",
              "optional": false,
              "image": "https://aos-comment.amap.com/B0IAHC7KWH/comment/content_media_external_file_56886_ss__1767240169502_15023372.jpg",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Reed Flute Cave",
              "name_local": "Ëä¶Á¨õÂ≤©",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 15.552855407047387,
              "cost_local": 128.0,
              "opening_hours": "08:00-17:30 (summer), 08:30-17:00 (winter)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/d9bed94effa350fede311ba76e0df014",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Shangri-La Hotel Guilin",
            "name_local": "Ê°ÇÊûóÈ¶ôÊ†ºÈáåÊãâÂ§ßÈÖíÂ∫ó",
            "type_base": "High-End",
            "type_local": "",
            "location_base": "111 Huancheng North 2 Rd, Qixing District",
            "location_local": "111 Huancheng North 2 Rd, Qixing District",
            "coordinates": {},
            "cost": 82.62454434993924,
            "cost_local": 680.0,
            "stars": 0,
            "amenities_base": [
              "Luxury brand",
              "Near Li River",
              "Beautiful grounds",
              "Multiple restaurants",
              "Pool and spa"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/6628879d41f400d9acdbc9157370d5a7"
          },
          "transportation": {
            "name_base": "Beijing ‚Üí Guilin",
            "name_local": "",
            "from_base": "Beijing",
            "to_base": "Guilin",
            "from_local": "",
            "to_local": "",
            "departure_point_base": "Beijing West Railway Station",
            "departure_point_local": "Beijing West Railway Station",
            "arrival_point_base": "Guilin Railway Station",
            "arrival_point_local": "Guilin Railway Station",
            "type_base": "G-train",
            "type_local": "",
            "icon": "üöÑ",
            "route_number": "",
            "company_base": "",
            "company_local": "",
            "cost": 110,
            "cost_local": 886,
            "cost_type_base": "",
            "cost_type_local": "",
            "status_base": "RECOMMENDED",
            "status_local": "",
            "notes_base": "Duration: 8h | Frequency: 8 daily departures | Scenic journey through mountains. Comfortable for long trips.",
            "notes_local": "",
            "time": {
              "start": "07:08, 09:05, 10:15, 20:37 (key times)",
              "end": "12:00"
            }
          },
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 48.60267314702308,
            "entertainment": 0,
            "accommodation": 82.62454434993924,
            "shopping": 0,
            "transportation": 110,
            "total": 241.22721749696234
          }
        },
        {
          "day": 13,
          "date": "Day 13",
          "location": "Guilin",
          "location_local": "",
          "cover": "",
          "user_plans": [],
          "meals": {},
          "attractions": [
            {
              "name_base": "Longji Rice Terraces",
              "name_local": "ÈæôËÑäÊ¢ØÁî∞",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 13.122721749696233,
              "cost_local": 108.0,
              "opening_hours": "07:30-18:00",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/7b69d256c1aef3ab2e20d7b4a8a6fa52",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Elephant Trunk Hill",
              "name_local": "Ë±°ÈºªÂ±±",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landmark",
              "type_local": "",
              "cost": 9.234507897934385,
              "cost_local": 76.0,
              "opening_hours": "06:30-21:30",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/85083b528216d28f25499ea8872ef850",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Two Rivers and Four Lakes Cruise",
              "name_local": "‰∏§Ê±üÂõõÊπñÊ∏∏Ëàπ",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Sightseeing Cruise",
              "type_local": "",
              "cost": 27.217496962332927,
              "cost_local": 224.0,
              "opening_hours": "Cruises 19:00-21:00 (night cruise), 14:00-16:00 (day cruise)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/0ad72477a50f83fb1d6e786e20b3c7c9",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Shangri-La Hotel Guilin",
            "name_local": "Ê°ÇÊûóÈ¶ôÊ†ºÈáåÊãâÂ§ßÈÖíÂ∫ó",
            "type_base": "High-End",
            "type_local": "",
            "location_base": "111 Huancheng North 2 Rd, Qixing District",
            "location_local": "111 Huancheng North 2 Rd, Qixing District",
            "coordinates": {},
            "cost": 82.62454434993924,
            "cost_local": 680.0,
            "stars": 0,
            "amenities_base": [
              "Luxury brand",
              "Near Li River",
              "Beautiful grounds",
              "Multiple restaurants",
              "Pool and spa"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/6628879d41f400d9acdbc9157370d5a7"
          },
          "transportation": null,
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 49.57472660996355,
            "entertainment": 0,
            "accommodation": 82.62454434993924,
            "shopping": 0,
            "transportation": 0,
            "total": 132.19927095990278
          }
        }
      ]
    },
    {
      "name": "Zhangjiajie",
      "name_local": "",
      "days_count": 2,
      "cover": "",
      "days": [
        {
          "day": 14,
          "date": "Day 14",
          "location": "Zhangjiajie",
          "location_local": "",
          "cover": "",
          "user_plans": [
            "Avatar mountains (Zhangjiajie National Forest Park)",
            "Tianmen Mountain",
            "Glass bridge",
            "Unique natural landscapes",
            "Best months: April, May",
            "Trip type: holiday"
          ],
          "meals": {},
          "attractions": [
            {
              "name_base": "Zhangjiajie National Forest Park",
              "name_local": "Âº†ÂÆ∂ÁïåÂõΩÂÆ∂Ê£ÆÊûóÂÖ¨Âõ≠",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 32.077764277035236,
              "cost_local": 264.0,
              "opening_hours": "07:00-18:00 (last entry 16:00)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/77ad479478f6b6cc6f9ea4a59bbfa689",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Tianmen Mountain & Glass Skywalk",
              "name_local": "Â§©Èó®Â±± & ÁéªÁíÉÊ†àÈÅì",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 36.93803159173754,
              "cost_local": 304.0,
              "opening_hours": "08:00-16:30 (last cable car up)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/72518080d9c5f39fc2b6305de273d809",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Baofeng Lake",
              "name_local": "ÂÆùÂ≥∞Êπñ",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 12.636695018226002,
              "cost_local": 104.0,
              "opening_hours": "07:00-17:30",
              "optional": false,
              "image": "https://aos-comment.amap.com/B02E800EDV/comment/content_media_external_file_603_1760507496910_83150237.jpg",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Hilton Garden Inn Zhangjiajie Wulingyuan",
            "name_local": "Âº†ÂÆ∂ÁïåÊ≠¶ÈôµÊ∫êÂ∏åÂ∞îÈ°øËä±Âõ≠ÈÖíÂ∫ó",
            "type_base": "Mid-Range",
            "type_local": "",
            "location_base": "108 Baofeng Rd, Wulingyuan District",
            "location_local": "108 Baofeng Rd, Wulingyuan District",
            "coordinates": {},
            "cost": 68.04374240583232,
            "cost_local": 560.0,
            "stars": 0,
            "amenities_base": [
              "Near park entrance",
              "International brand",
              "Modern facilities",
              "Free breakfast",
              "Shuttle service"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/a8d19655c66a883463309f302bdfc155"
          },
          "transportation": {
            "name_base": "Beijing ‚Üí Zhangjiajie",
            "name_local": "",
            "from_base": "Beijing",
            "to_base": "Zhangjiajie",
            "from_local": "",
            "to_local": "",
            "departure_point_base": "Beijing Capital (PEK) or Daxing (PKX)",
            "departure_point_local": "Beijing Capital (PEK) or Daxing (PKX)",
            "arrival_point_base": "Zhangjiajie Hehua International Airport (DYG)",
            "arrival_point_local": "Zhangjiajie Hehua International Airport (DYG)",
            "type_base": "Flight",
            "type_local": "",
            "icon": "‚úàÔ∏è",
            "route_number": "",
            "company_base": "",
            "company_local": "",
            "cost": 124,
            "cost_local": 1000,
            "cost_type_base": "",
            "cost_type_local": "",
            "status_base": "RECOMMENDED",
            "status_local": "",
            "notes_base": "Duration: 2.5h | Frequency: 2 direct flights daily | RECOMMENDED. Fastest option. Limited flights, book early.",
            "notes_local": "",
            "time": {
              "start": "09:00",
              "end": "12:00"
            }
          },
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 81.65249088699879,
            "entertainment": 0,
            "accommodation": 68.04374240583232,
            "shopping": 0,
            "transportation": 124,
            "total": 273.6962332928311
          }
        },
        {
          "day": 15,
          "date": "Day 15",
          "location": "Zhangjiajie",
          "location_local": "",
          "cover": "",
          "user_plans": [],
          "meals": {},
          "attractions": [
            {
              "name_base": "Zhangjiajie Grand Canyon & Glass Bridge",
              "name_local": "Âº†ÂÆ∂ÁïåÂ§ßÂ≥°Ë∞∑ & ÁéªÁíÉÊ°•",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 20.413122721749694,
              "cost_local": 168.0,
              "opening_hours": "08:00-16:00 (glass bridge), 07:30-17:30 (canyon)",
              "optional": false,
              "image": "https://aos-comment.amap.com/B0FFIBO9TT/comment/f04d582bfe5511e51578d9ff0e7f2a3f_2048_2048_80.jpg",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Yellow Dragon Cave",
              "name_local": "ÈªÑÈæôÊ¥û",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Natural Landscape",
              "type_local": "",
              "cost": 13.122721749696233,
              "cost_local": 108.0,
              "opening_hours": "08:00-17:00",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/51020518193bd96ccee8da006d6515b7",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Hilton Garden Inn Zhangjiajie Wulingyuan",
            "name_local": "Âº†ÂÆ∂ÁïåÊ≠¶ÈôµÊ∫êÂ∏åÂ∞îÈ°øËä±Âõ≠ÈÖíÂ∫ó",
            "type_base": "Mid-Range",
            "type_local": "",
            "location_base": "108 Baofeng Rd, Wulingyuan District",
            "location_local": "108 Baofeng Rd, Wulingyuan District",
            "coordinates": {},
            "cost": 68.04374240583232,
            "cost_local": 560.0,
            "stars": 0,
            "amenities_base": [
              "Near park entrance",
              "International brand",
              "Modern facilities",
              "Free breakfast",
              "Shuttle service"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/a8d19655c66a883463309f302bdfc155"
          },
          "transportation": null,
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 33.53584447144593,
            "entertainment": 0,
            "accommodation": 68.04374240583232,
            "shopping": 0,
            "transportation": 0,
            "total": 101.57958687727825
          }
        }
      ]
    },
    {
      "name": "Hong Kong",
      "name_local": "",
      "days_count": 2,
      "cover": "",
      "days": [
        {
          "day": 16,
          "date": "Day 16",
          "location": "Hong Kong",
          "location_local": "",
          "cover": "",
          "user_plans": [
            "Victoria Peak views",
            "Street food exploration",
            "Hiking trails",
            "Modern city experience",
            "Can combine with Macau",
            "Best months: March, April, May",
            "Trip type: long_weekend"
          ],
          "meals": {},
          "attractions": [
            {
              "name_base": "Victoria Peak",
              "name_local": "Â§™Âπ≥Â±±",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Viewpoint",
              "type_local": "",
              "cost": 11.66464155528554,
              "cost_local": 96.0,
              "opening_hours": "Peak Tram: 07:00-midnight, Peak Tower: 10:00-23:00",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/4d43cbc851bb222b08bd97afe4b48faa",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Tsim Sha Tsui Promenade & Symphony of Lights",
              "name_local": "Â∞ñÊ≤ôÂíÄÊµ∑Êª®ÈïøÂªä & ÂπªÂΩ©ÂíèÈ¶ôÊ±ü",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Waterfront",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (Symphony of Lights show at 20:00 nightly)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/fbcc9f4bc86c738c6daf6403caa860cf",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Lantau Island: Big Buddha & Ngong Ping 360",
              "name_local": "Â§ßÂ±øÂ±±: Â§©ÂùõÂ§ß‰Ωõ & ÊòÇÂù™360",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Cultural Site",
              "type_local": "",
              "cost": 26.245443499392465,
              "cost_local": 216.0,
              "opening_hours": "Cable car: 10:00-18:00 (weekdays), 09:00-18:30 (weekends). Big Buddha: 10:00-17:30",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/12a5660634d3df002cd1ed39dc11bb68",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            },
            {
              "name_base": "Central-Mid-Levels Escalators & SoHo",
              "name_local": "‰∏≠ÁéØËá≥ÂçäÂ±±Ëá™Âä®Êâ∂Ê¢Ø & Ëç∑ÂçóÁæéÈ£üÂå∫",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Urban Experience",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "Down: 06:00-10:00, Up: 10:30-midnight",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/9d4d813cf32020ec54de6946f506cab4",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "17:30",
                "end": "19:30"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Ovolo Hong Kong, Central",
            "name_local": "È¶ôÊ∏Ø‰∏≠ÁéØÂ••ÂçéÈÖíÂ∫ó",
            "type_base": "High-End",
            "type_local": "",
            "location_base": "2 Arbuthnot Rd, Central",
            "location_local": "2 Arbuthnot Rd, Central",
            "coordinates": {},
            "cost": 136.08748481166464,
            "cost_local": 1120.0,
            "stars": 0,
            "amenities_base": [
              "Boutique luxury",
              "Hip Central location",
              "Free minibar",
              "Free happy hour",
              "Modern design",
              "Rooftop terrace"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/a2915b122c8b77a8cf2248dcfc5aa579"
          },
          "transportation": {
            "name_base": "Beijing ‚Üí Hong Kong",
            "name_local": "",
            "from_base": "Beijing",
            "to_base": "Hong Kong",
            "from_local": "",
            "to_local": "",
            "departure_point_base": "Beijing Capital (PEK) or Daxing (PKX)",
            "departure_point_local": "Beijing Capital (PEK) or Daxing (PKX)",
            "arrival_point_base": "Hong Kong International Airport (HKG)",
            "arrival_point_local": "Hong Kong International Airport (HKG)",
            "type_base": "Flight",
            "type_local": "",
            "icon": "‚úàÔ∏è",
            "route_number": "",
            "company_base": "",
            "company_local": "",
            "cost": 155,
            "cost_local": 1250,
            "cost_type_base": "",
            "cost_type_local": "",
            "status_base": "RECOMMENDED",
            "status_local": "",
            "notes_base": "Duration: 3.5h | Frequency: 20+ daily flights | Many flight options. Similar price to train. Add 2-3 hours for airport transfers.",
            "notes_local": "",
            "time": {
              "start": "09:00",
              "end": "12:00"
            }
          },
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 37.91008505467801,
            "entertainment": 0,
            "accommodation": 136.08748481166464,
            "shopping": 0,
            "transportation": 155,
            "total": 328.99756986634264
          }
        },
        {
          "day": 17,
          "date": "Day 17",
          "location": "Hong Kong",
          "location_local": "",
          "cover": "",
          "user_plans": [],
          "meals": {},
          "attractions": [
            {
              "name_base": "Dragon's Back Hike",
              "name_local": "ÈæôËÑäËøúË∂≥ÂæÑ",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Hiking Trail",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (daylight hiking recommended)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/e98111dae392956a5602cc5bc643c560",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Temple Street Night Market",
              "name_local": "Â∫ôË°óÂ§úÂ∏Ç",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Night Market",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "18:00-midnight (best 20:00-23:00)",
              "optional": false,
              "image": "https://aos-comment.amap.com/B0FFF01R3E/comment/38ac33cd262d64b92565656795b84ffb_2048_2048_80.jpg",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "Chi Lin Nunnery & Nan Lian Garden",
              "name_local": "ÂøóËé≤ÂáÄËãë & ÂçóËé≤Âõ≠Ê±†",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Temple Garden",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "Nunnery: 09:00-16:30, Garden: 07:00-21:00",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/f52affb0a8ceadd10a855b777615323b",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Ovolo Hong Kong, Central",
            "name_local": "È¶ôÊ∏Ø‰∏≠ÁéØÂ••ÂçéÈÖíÂ∫ó",
            "type_base": "High-End",
            "type_local": "",
            "location_base": "2 Arbuthnot Rd, Central",
            "location_local": "2 Arbuthnot Rd, Central",
            "coordinates": {},
            "cost": 136.08748481166464,
            "cost_local": 1120.0,
            "stars": 0,
            "amenities_base": [
              "Boutique luxury",
              "Hip Central location",
              "Free minibar",
              "Free happy hour",
              "Modern design",
              "Rooftop terrace"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://store.is.autonavi.com/showpic/a2915b122c8b77a8cf2248dcfc5aa579"
          },
          "transportation": null,
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 0,
            "entertainment": 0,
            "accommodation": 136.08748481166464,
            "shopping": 0,
            "transportation": 0,
            "total": 136.08748481166464
          }
        }
      ]
    },
    {
      "name": "Macau",
      "name_local": "",
      "days_count": 1,
      "cover": "",
      "days": [
        {
          "day": 18,
          "date": "Day 18",
          "location": "Macau",
          "location_local": "",
          "cover": "",
          "user_plans": [
            "Portuguese heritage sites",
            "Ruins of St. Paul's",
            "Egg tarts",
            "Casino area exploration",
            "Combine with Hong Kong trip",
            "Best months: March, April, May",
            "Trip type: weekend_or_addon"
          ],
          "meals": {},
          "attractions": [
            {
              "name_base": "Ruins of St. Paul's",
              "name_local": "Â§ß‰∏âÂ∑¥ÁâåÂùä",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Historical Site",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (Museum of Sacred Art behind ruins: 09:00-18:00, closed Tuesdays)",
              "optional": false,
              "image": "https://aos-cdn-image.amap.com/sns/ugccomment/b8c3041b-5856-4f8c-be94-bd6e39072008.jpg",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "10:00",
                "end": "12:00"
              },
              "links": {}
            },
            {
              "name_base": "Senado Square",
              "name_local": "ËÆÆ‰∫ã‰∫≠ÂâçÂú∞",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Cultural District",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (shops 10:00-22:00)",
              "optional": false,
              "image": "https://aos-comment.amap.com/B0FFIPIKST/comment/12AB744D_6A98_479B_90CB_F6C83FDE1A1F_L0_001_1500_200_1766592287917_74201623.jpg",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "12:30",
                "end": "14:30"
              },
              "links": {}
            },
            {
              "name_base": "A-Ma Temple",
              "name_local": "Â¶àÈòÅÂ∫ô",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Religious Site",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "07:00-18:00",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/37d721105336f84e512caa1c5e4976b5",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "15:00",
                "end": "17:00"
              },
              "links": {}
            },
            {
              "name_base": "The Venetian Macao",
              "name_local": "Êæ≥Èó®Â®ÅÂ∞ºÊñØ‰∫∫",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Casino Resort",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/4a3f567c586b93f147c5ae9e2a1004fe",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "17:30",
                "end": "19:30"
              },
              "links": {}
            },
            {
              "name_base": "Macau Tower",
              "name_local": "Êæ≥Èó®ÊóÖÊ∏∏Â°î",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Observation Tower",
              "type_local": "",
              "cost": 18.46901579586877,
              "cost_local": 152.0,
              "opening_hours": "10:00-21:00 (weekdays), 09:00-21:00 (weekends)",
              "optional": false,
              "image": "https://aos-comment.amap.com/B0KDY1VU4N/comment/content_media_external_images_media_10678_ss__1768268759783_24431919.jpg",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "20:00",
                "end": "22:00"
              },
              "links": {}
            },
            {
              "name_base": "Coloane Village",
              "name_local": "Ë∑ØÁéØÊùë",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Village",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "24/7 (village), shops 09:00-18:00",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/94e670d2a99be1f40a1da0de07928f87",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "22:30",
                "end": "24:30"
              },
              "links": {}
            },
            {
              "name_base": "Taipa Houses Museum",
              "name_local": "ÈæôÁéØËë°Èüµ‰ΩèÂÆÖÂºèÂçöÁâ©È¶Ü",
              "location_base": "",
              "location_local": "",
              "coordinates": {},
              "type_base": "Museum",
              "type_local": "",
              "cost": 0,
              "cost_local": 0,
              "opening_hours": "10:00-19:00 (closed Mondays)",
              "optional": false,
              "image": "https://store.is.autonavi.com/showpic/019d0013174fe79bf0a8ec252a671fdb",
              "notes_base": "",
              "notes_local": "",
              "time": {
                "start": "25:00",
                "end": "27:00"
              },
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": {
            "name_base": "Hotel S Macau",
            "name_local": "Êæ≥Èó®SÈÖíÂ∫ó",
            "type_base": "Mid-Range",
            "type_local": "",
            "location_base": "Pra√ßa de Ponte e Horta, 14 & 16",
            "location_local": "Pra√ßa de Ponte e Horta, 14 & 16",
            "coordinates": {},
            "cost": 72.90400972053463,
            "cost_local": 600.0,
            "stars": 0,
            "amenities_base": [
              "Boutique hotel",
              "Old town location",
              "Portuguese design",
              "Highly rated",
              "Walking distance to UNESCO sites"
            ],
            "amenities_local": [],
            "check_in": "",
            "check_out": "",
            "notes_base": "",
            "notes_local": "",
            "optional": false,
            "time": {
              "start": "15:00",
              "end": "16:00"
            },
            "links": {},
            "image": "https://aos-comment.amap.com/B0LGXUBJ7W/comment/0357C163_3A91_4BAD_9996_21D59F49A623_L0_001_1500_200_1765864958797_62065482.jpg"
          },
          "transportation": {
            "name_base": "Beijing ‚Üí Macau",
            "name_local": "",
            "from_base": "Beijing",
            "to_base": "Macau",
            "from_local": "",
            "to_local": "",
            "departure_point_base": "Beijing Capital (PEK) or Daxing (PKX)",
            "departure_point_local": "Beijing Capital (PEK) or Daxing (PKX)",
            "arrival_point_base": "Macau International Airport (MFM)",
            "arrival_point_local": "Macau International Airport (MFM)",
            "type_base": "Flight",
            "type_local": "",
            "icon": "‚úàÔ∏è",
            "route_number": "",
            "company_base": "",
            "company_local": "",
            "cost": 149,
            "cost_local": 1200,
            "cost_type_base": "",
            "cost_type_local": "",
            "status_base": "RECOMMENDED",
            "status_local": "",
            "notes_base": "Duration: 3.5h | Frequency: Limited direct flights | Limited flights. More expensive. Usually better to go via Hong Kong.",
            "notes_local": "",
            "time": {
              "start": "09:00",
              "end": "12:00"
            }
          },
          "shopping": [],
          "budget": {
            "meals": 0,
            "attractions": 18.46901579586877,
            "entertainment": 0,
            "accommodation": 72.90400972053463,
            "shopping": 0,
            "transportation": 149,
            "total": 240.3730255164034
          }
        }
      ]
    }
  ]
};
    const CURRENCY_SYMBOL = "‚Ç¨";

    
// ============================================================
// HOOKS
// ============================================================
const { useState, useEffect, useCallback } = React;

const useBreakpoint = () => {
  const [bp, setBp] = useState(() => {
    const w = window.innerWidth;
    return w < 640 ? 'sm' : w < 960 ? 'md' : 'lg';
  });
  useEffect(() => {
    const h = () => { const w = window.innerWidth; setBp(w < 640 ? 'sm' : w < 960 ? 'md' : 'lg'); };
    window.addEventListener('resize', h);
    return () => window.removeEventListener('resize', h);
  }, []);
  return bp;
};

// Mobile detection helper (reused by RedNoteLink, MapLink, etc.)
const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

// ============================================================
// ATOMS
// ============================================================
const LinkChip = ({ href, type, compact }) => {
  if (!href) return null;
  const cfg = {
    google_maps: { icon: 'üåç', label: 'Google Maps', bg: '#edf2fc', color: '#2b63b5' },
    gaode: { icon: 'üó∫Ô∏è', label: 'È´òÂæ∑', bg: '#e9f5ec', color: '#1a7a32' },
    xiaohongshu: { icon: 'üìï', label: 'Â∞èÁ∫¢‰π¶', bg: '#fce8e6', color: '#c5221f' },
    booking: { icon: 'üè®', label: 'Booking', bg: '#e8eaf6', color: '#1a237e' },
    dianping: { icon: '‚≠ê', label: 'ÁÇπËØÑ', bg: '#fff3e0', color: '#e65100' }
  }[type] || { icon: 'üîó', label: 'Link', bg: '#f5f5f5', color: '#666' };
  return (
    <a href={href} target="_blank" rel="noopener noreferrer" style={{
      display: 'inline-flex', alignItems: 'center', gap: '3px',
      padding: compact ? '2px 5px' : '2px 8px',
      background: cfg.bg, color: cfg.color,
      borderRadius: '3px', fontSize: compact ? '10px' : '11px',
      fontWeight: '500', textDecoration: 'none', transition: 'opacity .12s'
    }}
      onMouseEnter={e => e.currentTarget.style.opacity = '0.7'}
      onMouseLeave={e => e.currentTarget.style.opacity = '1'}
    >{cfg.icon}{compact ? '' : ` ${cfg.label}`}</a>
  );
};

const LinksRow = ({ links, compact }) => {
  if (!links || !Object.keys(links).length) return null;
  return (
    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '4px', marginTop: '8px' }}>
      {Object.entries(links).map(([t, u]) => <LinkChip key={t} href={u} type={t} compact={compact} />)}
    </div>
  );
};

const PropertyRow = ({ label, children }) => (
  <div style={{ display: 'flex', alignItems: 'baseline', padding: '5px 0', fontSize: '14px', lineHeight: '1.6' }}>
    <span style={{ width: '130px', flexShrink: 0, color: '#9b9a97', fontSize: '13px' }}>{label}</span>
    <span style={{ color: '#37352f' }}>{children}</span>
  </div>
);

const Section = ({ title, icon, children }) => (
  <div style={{ marginBottom: '32px' }}>
    <div style={{
      display: 'flex', alignItems: 'center', gap: '8px',
      fontSize: '15px', fontWeight: '600', color: '#37352f',
      paddingBottom: '6px', marginBottom: '14px',
      borderBottom: '1px solid #edece9'
    }}>
      <span style={{ fontSize: '16px' }}>{icon}</span> {title}
    </div>
    {children}
  </div>
);

const Donut = ({ budget, size = 80, onBudgetClick, day }) => {
  const items = [
    { v: budget.meals || 0, c: '#f0b429', k: 'meals' },
    { v: budget.attractions || 0, c: '#4a90d9', k: 'attractions' },
    { v: budget.entertainment || 0, c: '#9b6dd7', k: 'entertainment' },
    { v: budget.accommodation || 0, c: '#45b26b', k: 'accommodation' },
    { v: budget.shopping || 0, c: '#e07c5a', k: 'shopping' },
    { v: budget.transportation || 0, c: '#0ea5e9', k: 'transportation' }
  ].filter(i => i.v > 0);
  const t = items.reduce((s, i) => s + i.v, 0);
  if (t === 0) return (
    <svg width={size} height={size} viewBox="0 0 36 36">
      <circle cx="18" cy="18" r="15.915" fill="none" stroke="#e5e4e1" strokeWidth="2.5" />
      <text x="18" y="18" textAnchor="middle" dy=".35em" fontSize="6" fill="#9b9a97">{CURRENCY_SYMBOL}0</text>
    </svg>
  );
  let cum = 0;
  const p = (r, a) => ({ x: 50 + r * Math.cos((a - 90) * Math.PI / 180), y: 50 + r * Math.sin((a - 90) * Math.PI / 180) });
  const arc = (sa, ea) => { const s = p(44, ea), e = p(44, sa); return `M${s.x},${s.y}A44,44,0,${ea - sa > 180 ? 1 : 0},0,${e.x},${e.y}L50,50Z`; };
  return (
    <svg viewBox="0 0 100 100" style={{ width: size, height: size }}>
      {items.length === 1 ? (
        <circle cx="50" cy="50" r="44" fill={items[0].c} style={{ cursor: onBudgetClick ? 'pointer' : 'default' }} onClick={() => onBudgetClick && onBudgetClick(items[0].k, day)} />
      ) : (
        items.map((it, i) => { const a = (it.v / t) * 360; const d = arc(cum, cum + a); cum += a; return <path key={i} d={d} fill={it.c} style={{ cursor: onBudgetClick ? 'pointer' : 'default' }} onClick={() => onBudgetClick && onBudgetClick(it.k, day)} />; })
      )}
      <circle cx="50" cy="50" r="24" fill="white" />
    </svg>
  );
};

const PropLine = ({ label, value }) => (
  <div style={{ fontSize: '12px', lineHeight: 1.7 }}>
    <span style={{ color: '#9b9a97' }}>{label}</span>{' '}
    <span style={{ color: '#37352f' }}>{value}</span>
  </div>
);

// ============================================================
// SIDEBAR
// ============================================================
const Sidebar = ({ trips, selTrip, selDay, onSelect, isOpen, onClose, bp, lang }) => {
  const [exp, setExp] = useState({ [trips[0]?.name]: true });
  const mobile = bp === 'sm';
  const W = bp === 'lg' ? 240 : 220;

  return (
    <>
      {mobile && isOpen && <div onClick={onClose} style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.2)', zIndex: 199 }} />}
      <div style={{
        width: W, flexShrink: 0, background: '#fbfbfa', borderRight: '1px solid #f0efed',
        padding: '14px 8px', overflowY: 'auto', height: mobile ? '100%' : '100vh',
        position: mobile ? 'fixed' : 'sticky', top: 0, left: 0, bottom: mobile ? 0 : 'auto', zIndex: 200,
        transform: mobile && !isOpen ? `translateX(-${W + 10}px)` : 'none',
        transition: 'transform .25s ease',
        boxShadow: mobile && isOpen ? '2px 0 8px rgba(0,0,0,0.06)' : 'none'
      }}>
        <div style={{ padding: '4px 10px 12px', fontSize: '12px', fontWeight: '600', color: '#37352f', display: 'flex', alignItems: 'center', gap: '6px', lineHeight: '1.45' }}>
          <span>üìã</span>
          <span style={{ flex: 1 }}>{PLAN_DATA.trip_summary.description}</span>
          {mobile && <button onClick={onClose} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#b4b4b4', fontSize: '14px' }}>‚úï</button>}
        </div>

        {trips.map((trip, ti) => {
          const open = exp[trip.name] !== false;
          const has = trip.days.length > 0;
          return (
            <div key={trip.name}>
              <div
                onClick={() => { setExp(p => ({ ...p, [trip.name]: !p[trip.name] })); if (has) onSelect(ti, 0); if (mobile) onClose(); }}
                style={{
                  display: 'flex', alignItems: 'center', gap: '4px',
                  padding: '5px 10px', borderRadius: '5px', cursor: 'pointer',
                  fontSize: '13px', color: '#37352f',
                  background: selTrip === ti ? 'rgba(55,53,47,0.06)' : 'transparent',
                  borderLeft: selTrip === ti ? '2px solid #37352f' : '2px solid transparent',
                  transition: 'all .1s'
                }}
                onMouseEnter={e => { if (selTrip !== ti) e.currentTarget.style.background = 'rgba(55,53,47,0.03)'; }}
                onMouseLeave={e => { if (selTrip !== ti) e.currentTarget.style.background = 'transparent'; }}
              >
                <span style={{ fontSize: '9px', color: '#b4b4b4', transform: open ? 'rotate(90deg)' : '', transition: 'transform .15s', display: 'inline-block', marginRight: '2px' }}>‚ñ∂</span>
                <span style={{ fontWeight: '500', flex: 1 }}>{trip.name}</span>
                <span style={{ fontSize: '11px', color: '#b4b4b4' }}>({trip.days_count != null ? ((trip.days_count === 1 ? L('days_count_1', lang) : L('days_count', lang)).replace('{n}', trip.days_count)) : trip.days_label})</span>
              </div>
              {open && has && (
                <div style={{ marginLeft: '16px' }}>
                  {trip.days.map((d, di) => {
                    const active = selTrip === ti && selDay === di;
                    return (
                      <div key={di}
                        onClick={() => { onSelect(ti, di); if (mobile) onClose(); }}
                        style={{
                          padding: '4px 10px', borderRadius: '5px', cursor: 'pointer',
                          fontSize: '13px', color: '#37352f',
                          background: active ? 'rgba(55,53,47,0.06)' : 'transparent',
                          fontWeight: active ? '500' : '400',
                          borderLeft: active ? '2px solid #37352f' : '2px solid transparent',
                          transition: 'all .1s'
                        }}
                        onMouseEnter={e => { if (!active) e.currentTarget.style.background = 'rgba(55,53,47,0.03)'; }}
                        onMouseLeave={e => { if (!active) e.currentTarget.style.background = active ? 'rgba(55,53,47,0.06)' : 'transparent'; }}
                      >üìÑ {dayLabelSidebar(d, lang)}</div>
                    );
                  })}
                </div>
              )}
            </div>
          );
        })}
      </div>
    </>
  );
};

// ============================================================
// ITEM DETAIL SIDEBAR
// ============================================================
const ItemDetailSidebar = ({ item, type, onClose, bp, lang, mapProvider }) => {
  if (!item) return null;
  const sm = bp === 'sm';
  const W = sm ? '85%' : '400px';

  return (
    <>
      <div onClick={onClose} style={{
        position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.2)', zIndex: 299
      }} />
      <div style={{
        position: 'fixed', right: 0, top: 0, bottom: 0,
        width: W, background: '#fff',
        boxShadow: '-2px 0 8px rgba(0,0,0,0.08)',
        overflowY: 'auto', zIndex: 300,
        animation: 'slideIn 0.25s ease',
        padding: '24px'
      }}>
        <style>{`@keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }`}</style>

        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '20px' }}>
          <div style={{ fontSize: '20px' }}>
            {{ meal: 'üçΩÔ∏è', attraction: 'üìç', entertainment: 'üé≠', shopping: 'üõçÔ∏è', accommodation: 'üè®', transportation: item.icon || 'üöÑ' }[type] || 'üìÑ'}
          </div>
          <button onClick={onClose} style={{
            background: 'none', border: 'none', cursor: 'pointer',
            fontSize: '20px', color: '#b4b4b4', padding: '4px 8px'
          }}>‚úï</button>
        </div>

        {item.image && (
          <div style={{
            width: '100%', height: '200px', borderRadius: '8px',
            overflow: 'hidden', marginBottom: '20px', background: '#f5f3ef'
          }}>
            <img src={item.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover' }}
              onError={e => e.target.style.display = 'none'} />
          </div>
        )}

        <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#37352f', margin: '0 0 4px' }}>
          {type === 'transportation' ? (<>
            {item.icon} {lang === 'local' && item.from_local ? item.from_local : item.from_base} ‚Üí {lang === 'local' && item.to_local ? item.to_local : item.to_base}
          </>) : (<>
            {getDisplayName(item, lang)}
            <RedNoteLink name={item.name_local || item.name_base} />
          </>)}
        </h2>

        <div style={{ borderTop: '1px solid #f0efed', paddingTop: '16px' }}>
          {item.time && type !== 'transportation' && (
            <PropertyRow label={L('time', lang)}>
              {item.time.start} ‚Äì {item.time.end}
            </PropertyRow>
          )}
          {/* Category-specific field ordering */}
          {type === 'accommodation' ? (<>
            {item.check_in && <PropertyRow label={L('checkin', lang)}>{item.check_in}</PropertyRow>}
            {item.check_out && <PropertyRow label={L('checkout', lang)}>{item.check_out}</PropertyRow>}
            {(item.cost !== undefined && (item.cost > 0 || item.cost_type_base === 'prepaid')) && <PropertyRow label={L('cost', lang)}>{fmtCost(item.cost, item.cost_type_base, lang)}</PropertyRow>}
            {getDisplayField(item, 'type', lang) && <PropertyRow label={L('type', lang)}>{getDisplayField(item, 'type', lang)}</PropertyRow>}
            {item.stars > 0 && <PropertyRow label={L('stars', lang)}><span style={{ color: '#e9b200', letterSpacing: '1px' }}>{'‚òÖ'.repeat(item.stars)}</span></PropertyRow>}
            {(item.location_base || item.location_local) && <PropertyRow label={L('location', lang)}><MapLink item={item} lang={lang} mapProvider={mapProvider} /></PropertyRow>}
          </>) : type === 'transportation' ? (<>
            {item.time && <PropertyRow label={L('time', lang)}>{item.time.start} ‚Äì {item.time.end}</PropertyRow>}
            {item.cost != null && (item.cost > 0 || item.cost_type_base === 'prepaid') && <PropertyRow label={L('cost', lang)}>{fmtCost(item.cost, item.cost_type_base, lang)}</PropertyRow>}
            <PropertyRow label={L('type', lang)}>{getDisplayField(item, 'type', lang)}</PropertyRow>
            {item.route_number && <PropertyRow label={L('route_number', lang)}>{item.route_number}</PropertyRow>}
            {getDisplayField(item, 'company', lang) && <PropertyRow label={L('company', lang)}>{getDisplayField(item, 'company', lang)}</PropertyRow>}
            {getDisplayField(item, 'status', lang) && (
              <PropertyRow label={L('status', lang)}>
                <span style={{
                  padding: '2px 8px', borderRadius: '4px', fontSize: '12px', fontWeight: '600',
                  background: item.status_base?.includes('URGENT') ? '#fff4e6' : item.status_base?.includes('VERIFIED') ? '#e9f5ec' : '#edf2fc',
                  color: item.status_base?.includes('URGENT') ? '#d97706' : item.status_base?.includes('VERIFIED') ? '#1a7a32' : '#2b63b5'
                }}>
                  {getDisplayField(item, 'status', lang)}
                </span>
              </PropertyRow>
            )}
            {item.departure_point_base && <PropertyRow label={L('route', lang)}>{lang === 'local' && item.departure_point_local ? item.departure_point_local : item.departure_point_base} ‚Üí {lang === 'local' && item.arrival_point_local ? item.arrival_point_local : item.arrival_point_base}</PropertyRow>}
            {item.booking_required && (
              <div style={{ marginTop: '6px' }}>
                <span style={{ fontSize: '11px', padding: '2px 8px', background: '#fff3e0', border: '1px solid #ffcc80', borderRadius: '4px', color: '#e65100', fontWeight: '600' }}>
                  {L('booking_required', lang)}
                </span>
              </div>
            )}
          </>) : (<>
            {item.check_in && <PropertyRow label={L('checkin', lang)}>{item.check_in}</PropertyRow>}
            {item.check_out && <PropertyRow label={L('checkout', lang)}>{item.check_out}</PropertyRow>}
            {(item.cost !== undefined && (item.cost > 0 || item.cost_type_base === 'prepaid')) && <PropertyRow label={L('cost', lang)}>{fmtCost(item.cost, item.cost_type_base, lang)}</PropertyRow>}
            {getDisplayField(item, 'cuisine', lang) && <PropertyRow label={L('cuisine', lang)}>{getDisplayField(item, 'cuisine', lang)}</PropertyRow>}
            {getDisplayField(item, 'signature_dishes', lang) && <PropertyRow label={L('signature', lang)}>{getDisplayField(item, 'signature_dishes', lang)}</PropertyRow>}
            {getDisplayField(item, 'type', lang) && <PropertyRow label={L('type', lang)}>{getDisplayField(item, 'type', lang)}</PropertyRow>}
            {item.opening_hours && <PropertyRow label={L('opening_hours', lang)}>{item.opening_hours}</PropertyRow>}
            {(item.location_base || item.location_local) && <PropertyRow label={L('location', lang)}><MapLink item={item} lang={lang} mapProvider={mapProvider} /></PropertyRow>}
            {item.optional && <PropertyRow label={L('optional', lang)}><span style={{ padding: '2px 8px', background: '#f5f5f3', borderRadius: '4px', fontSize: '12px', color: '#9b9a97', fontWeight: '600' }}>{L('optional', lang)}</span></PropertyRow>}
            {item.stars > 0 && <PropertyRow label={L('stars', lang)}><span style={{ color: '#e9b200', letterSpacing: '1px' }}>{'‚òÖ'.repeat(item.stars)}</span></PropertyRow>}
          </>)}
          {((lang === 'local' && item.amenities_local && item.amenities_local.length > 0) ? item.amenities_local : (item.amenities_base && item.amenities_base.length > 0 ? item.amenities_base : null)) && (
            <div style={{ marginTop: '12px' }}>
              <div style={{ fontSize: '13px', fontWeight: '600', color: '#37352f', marginBottom: '8px' }}>{L('amenities', lang)}</div>
              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '4px' }}>
                {(lang === 'local' && item.amenities_local && item.amenities_local.length > 0 ? item.amenities_local : item.amenities_base).map((a, i) => (
                  <span key={i} style={{ fontSize: '12px', padding: '3px 8px', background: '#f5f5f3', borderRadius: '4px', color: '#6b6b6b' }}>{a}</span>
                ))}
              </div>
            </div>
          )}
          {(lang === 'local' && item.note_local ? item.note_local : item.note_base) && (
            <div style={{
              marginTop: '16px', padding: '12px 16px',
              background: '#fffdf5', borderRadius: '6px',
              border: '1px solid #f5ecd7', fontSize: '13px', color: '#9a6700'
            }}>
              üí° {lang === 'local' && item.note_local ? item.note_local : item.note_base}
            </div>
          )}
          {(lang === 'local' && item.notes_local ? item.notes_local : item.notes_base) && (
            <div style={{
              marginTop: '16px', padding: '12px 16px',
              background: '#f5f9fc', borderRadius: '6px',
              border: '1px solid #d9e8f5', fontSize: '13px', color: '#37352f', lineHeight: 1.6
            }}>
              {lang === 'local' && item.notes_local ? item.notes_local : item.notes_base}
            </div>
          )}
          {item.links && Object.keys(item.links).length > 0 && (
            <div style={{ marginTop: '20px' }}>
              <div style={{ fontSize: '13px', fontWeight: '600', color: '#37352f', marginBottom: '8px' }}>
                {L('links', lang)}
              </div>
              <LinksRow links={item.links} />
            </div>
          )}
        </div>
      </div>
    </>
  );
};

// ============================================================
// BUDGET DETAIL SIDEBAR
// ============================================================
const BudgetDetailSidebar = ({ category, items, total, onClose, bp, lang }) => {
  if (!category) return null;
  const sm = bp === 'sm';
  const W = sm ? '85%' : '400px';

  const categoryConfig = {
    meals: { icon: 'üçΩÔ∏è', label: L('meals', lang), color: '#f0b429' },
    attractions: { icon: 'üìç', label: L('attractions', lang), color: '#4a90d9' },
    entertainment: { icon: 'üé≠', label: L('entertainment', lang), color: '#9b6dd7' },
    accommodation: { icon: 'üè®', label: L('accommodation', lang), color: '#45b26b' },
    shopping: { icon: 'üõçÔ∏è', label: L('shopping', lang), color: '#e07c5a' },
    transportation: { icon: 'üöÑ', label: L('transport', lang), color: '#0ea5e9' }
  };
  const cfg = categoryConfig[category] || { icon: 'üí∞', label: L('budget', lang), color: '#37352f' };

  return (
    <>
      <div onClick={onClose} style={{
        position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.2)', zIndex: 299
      }} />
      <div style={{
        position: 'fixed', right: 0, top: 0, bottom: 0,
        width: W, background: '#fff',
        boxShadow: '-2px 0 8px rgba(0,0,0,0.08)',
        overflowY: 'auto', zIndex: 300,
        animation: 'slideIn 0.25s ease',
        padding: '24px'
      }}>
        <style>{`@keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }`}</style>

        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '24px' }}>
          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
            <div style={{ fontSize: '24px' }}>{cfg.icon}</div>
            <h2 style={{ fontSize: '20px', fontWeight: '700', color: '#37352f', margin: 0 }}>
              {cfg.label}
            </h2>
          </div>
          <button onClick={onClose} style={{
            background: 'none', border: 'none', cursor: 'pointer',
            fontSize: '20px', color: '#b4b4b4', padding: '4px 8px'
          }}>‚úï</button>
        </div>

        {items && items.length > 0 ? (
          <div>
            {items.map((item, i) => (
              <div key={i} style={{
                padding: '14px 16px',
                background: '#fbfbfa',
                borderRadius: '6px',
                border: '1px solid #f0efed',
                marginBottom: '10px'
              }}>
                <div style={{ fontSize: '14px', fontWeight: '600', color: '#37352f', marginBottom: '4px' }}>
                  {lang === 'local' && item.name_local ? item.name_local : (item.name_base || '')}
                </div>
                {lang !== 'local' && item.name_local && (
                  <div style={{ fontSize: '12px', color: '#9b9a97', marginBottom: '6px' }}>{item.name_local}</div>
                )}
                {lang === 'local' && item.name_base && item.name_base !== item.name_local && (
                  <div style={{ fontSize: '12px', color: '#9b9a97', marginBottom: '6px' }}>{item.name_base}</div>
                )}
                <div style={{
                  display: 'flex', justifyContent: 'space-between',
                  fontSize: '14px', marginTop: '8px'
                }}>
                  <span style={{ color: '#9b9a97' }}>{L('cost', lang)}</span>
                  <span style={{ fontWeight: '600', color: cfg.color }}>
                    {fmtCost(item.cost, undefined, lang)}
                  </span>
                </div>
              </div>
            ))}

            <div style={{
              marginTop: '20px', paddingTop: '16px',
              borderTop: '2px solid #edece9'
            }}>
              <div style={{
                display: 'flex', justifyContent: 'space-between',
                fontSize: '16px', fontWeight: '700', color: '#37352f'
              }}>
                <span>{L('total', lang)}</span>
                <span style={{ color: cfg.color }}>{CURRENCY_SYMBOL}{total.toFixed(0)}</span>
              </div>
            </div>
          </div>
        ) : (
          <div style={{ padding: '40px 20px', textAlign: 'center', color: '#9b9a97' }}>
            <div style={{ fontSize: '48px', marginBottom: '12px' }}>{cfg.icon}</div>
            <div style={{ fontSize: '14px' }}>{L('no_items', lang)}</div>
          </div>
        )}
      </div>
    </>
  );
};

// ============================================================
// KANBAN VIEW
// ============================================================
// Root cause fix (commit 8f2bddd): Helper to get display name based on language preference
const getDisplayName = (item, lang) => {
  if (!item) return '';
  if (lang === 'base') {
    return item.name_base || '';
  }
  return item.name_local || item.name_base || '';
};

// All costs are in display currency (from config). Use CURRENCY_SYMBOL.
const fmtCost = (c, costType, lng) => {
  if (costType === 'prepaid') return L('prepaid', lng);
  const n = Number(c);
  if (!n || n === 0) return L('free', lng);
  return Number.isInteger(n) ? `${CURRENCY_SYMBOL}${n}` : `${CURRENCY_SYMBOL}${n.toFixed(1)}`;
};

// Fix issues #4,7,12: Language-aware location display
const getDisplayLocation = (item, lang) => {
  if (!item) return '';
  if (lang === 'base') return item.location_base || '';
  return item.location_local || item.location_base || '';
};

// Bilingual field helper: returns local variant when lang='local' and data exists
const getDisplayField = (item, field, lang) => {
  if (!item) return '';
  if (lang === 'local' && item[field + '_local']) return item[field + '_local'];
  return item[field + '_base'] || '';
};

// Data-driven bilingual labels ‚Äî reads from PLAN_DATA.trip_summary.ui_labels
const L = (key, lng) => {
  const labels = PLAN_DATA.trip_summary.ui_labels || {};
  if (lng === 'local' && labels.local && labels.local[key]) {
    return labels.local[key];
  }
  if (labels.base && labels.base[key]) {
    return labels.base[key];
  }
  return key; // ultimate fallback: the key itself
};

// Format a YYYY-MM-DD date string into localized display
// Base lang: "Feb 15 (Sat)", Local lang: "2Êúà15Êó• (ÂÖ≠)"
const formatRealDate = (dateStr, lng) => {
  const m = dateStr.match(/^(\d{4})-(\d{2})-(\d{2})$/);
  if (!m) return null;
  const d = new Date(parseInt(m[1]), parseInt(m[2]) - 1, parseInt(m[3]));
  if (isNaN(d.getTime())) return null;
  const labels = PLAN_DATA.trip_summary.ui_labels || {};
  if (lng === 'local' && labels.local && labels.local.day_format) {
    // Local lang format: "2Êúà15Êó• (ÂÖ≠)"
    const localMonths = ['1','2','3','4','5','6','7','8','9','10','11','12'];
    const localDays = labels.local.weekdays_short || ['Êó•','‰∏Ä','‰∫å','‰∏â','Âõõ','‰∫î','ÂÖ≠'];
    return `${localMonths[d.getMonth()]}Êúà${d.getDate()}Êó• (${localDays[d.getDay()]})`;
  }
  // Base lang format: "Feb 15 (Sat)"
  const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  const days = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  return `${months[d.getMonth()]} ${d.getDate()} (${days[d.getDay()]})`;
};

// Day label helper ‚Äî handles format differences between languages
// For itinerary trips with real dates (YYYY-MM-DD): "Feb 15 (Sat) ‚Äì Chongqing"
// For bucket-list / no real date: "Day 3 ‚Äì Chongqing"
// Accepts day object or (dayNum, location, lng) for backward compat
const dayLabel = (dayNumOrObj, locationOrLng, lngOpt) => {
  // Support both: dayLabel(day, lang) and dayLabel(dayNum, location, lng)
  let dayNum, date, location, lng;
  if (typeof dayNumOrObj === 'object' && dayNumOrObj !== null) {
    // Called as dayLabel(dayObj, lang)
    const day = dayNumOrObj;
    dayNum = day.day;
    date = day.date || '';
    lng = locationOrLng;
    location = (lng === 'local' && day.location_local) ? day.location_local : day.location;
  } else {
    // Legacy: dayLabel(dayNum, location, lng)
    dayNum = dayNumOrObj;
    date = '';
    location = locationOrLng;
    lng = lngOpt;
  }
  // If day has a real date (YYYY-MM-DD), use formatted date instead of "Day N"
  const realDate = date ? formatRealDate(date, lng) : null;
  let prefix;
  if (realDate) {
    prefix = realDate;
  } else {
    const labels = PLAN_DATA.trip_summary.ui_labels || {};
    const fmt = (lng === 'local' && labels.local && labels.local.day_format)
      || (labels.base && labels.base.day_format) || 'Day {n}';
    prefix = fmt.replace('{n}', dayNum);
  }
  return prefix + (location ? ' ‚Äì ' + location : '');
};

// Day label for sidebar nav (with location for better context)
// Accepts day object or dayNum for backward compat
const dayLabelSidebar = (dayNumOrObj, lng) => {
  let dayNum, date, location;
  if (typeof dayNumOrObj === 'object' && dayNumOrObj !== null) {
    const day = dayNumOrObj;
    dayNum = day.day;
    date = day.date || '';
    location = (lng === 'local' && day.location_local) ? day.location_local : day.location;
  } else {
    dayNum = dayNumOrObj;
    date = '';
    location = '';
  }
  // Use real date if available
  const realDate = date ? formatRealDate(date, lng) : null;
  const prefix = realDate ? realDate : `Day ${dayNum}`;
  // Add location if available
  return location ? `${prefix} ‚Äì ${location}` : prefix;
};

// Day label for sidebar nav (no location) - deprecated in favor of dayLabelSidebar
// Accepts day object or dayNum for backward compat
const dayLabelShort = (dayNumOrObj, lng) => {
  let dayNum, date;
  if (typeof dayNumOrObj === 'object' && dayNumOrObj !== null) {
    dayNum = dayNumOrObj.day;
    date = dayNumOrObj.date || '';
  } else {
    dayNum = dayNumOrObj;
    date = '';
  }
  const realDate = date ? formatRealDate(date, lng) : null;
  if (realDate) return realDate;
  const labels = PLAN_DATA.trip_summary.ui_labels || {};
  const fmt = (lng === 'local' && labels.local && labels.local.day_format)
    || (labels.base && labels.base.day_format) || 'Day {n}';
  return fmt.replace('{n}', dayNum);
};

// Meal type emoji (kept separate from label text ‚Äî emoji is decoration, not translation)
const mealEmoji = { breakfast: 'üåÖ', lunch: '‚òÄÔ∏è', dinner: 'üåô' };

// Google Maps logo (from Simple Icons)
const GoogleMapsLogo = ({ size = 14 }) => (
  <svg viewBox="0 0 24 24" width={size} height={size} style={{ display: 'block', flexShrink: 0 }}>
    <path fill="#4285F4" d="M19.527 4.799c1.212 2.608.937 5.678-.405 8.173-1.101 2.047-2.744 3.74-4.098 5.614-.619.858-1.244 1.75-1.669 2.727-.141.325-.263.658-.383.992-.121.333-.224.673-.34 1.008-.109.314-.236.684-.627.687h-.007c-.466-.001-.579-.53-.695-.887-.284-.874-.581-1.713-1.019-2.525-.51-.944-1.145-1.817-1.79-2.671L19.527 4.799zM8.545 7.705l-3.959 4.707c.724 1.54 1.821 2.863 2.871 4.18.247.31.494.622.737.936l4.984-5.925-.029.01c-1.741.601-3.691-.291-4.392-1.987a3.377 3.377 0 0 1-.209-.716c-.063-.437-.077-.761-.004-1.198l.001-.007zM5.492 3.149l-.003.004c-1.947 2.466-2.281 5.88-1.117 8.77l4.785-5.689-.058-.05-3.607-3.035zM14.661.436l-3.838 4.563a.295.295 0 0 1 .027-.01c1.6-.551 3.403.15 4.22 1.626.176.319.323.683.377 1.045.068.446.085.773.012 1.22l-.003.016 3.836-4.561A8.382 8.382 0 0 0 14.67.439l-.009-.003zM9.466 5.868L14.162.285l-.047-.012A8.31 8.31 0 0 0 11.986 0a8.439 8.439 0 0 0-6.169 2.766l-.016.018 3.665 3.084z"/>
  </svg>
);

// Gaode Maps (È´òÂæ∑Âú∞Âõæ/AMap) logo - blue location pin with "A" based on brand color #0085fe
const GaodeLogo = ({ size = 14 }) => (
  <svg viewBox="0 0 24 24" width={size} height={size} style={{ display: 'block', flexShrink: 0 }}>
    <path fill="#0085fe" d="M12 0C7.31 0 3.5 3.81 3.5 8.5C3.5 14.88 12 24 12 24s8.5-9.12 8.5-15.5C20.5 3.81 16.69 0 12 0z"/>
    <text x="12" y="12" textAnchor="middle" fill="white" fontSize="10" fontWeight="bold" fontFamily="Arial,sans-serif" dy=".35em">A</text>
  </svg>
);

// Gaode Maps native app deeplink handler for mobile
// Tries native scheme directly, falls back to H5 after 1.5s timeout
const openGaodeNative = (gaodeScheme, gaodeH5) => {
  const start = Date.now();
  const onVisChange = () => {
    // If page became hidden within 3s of click, app probably opened
    if (document.hidden) {
      document.removeEventListener('visibilitychange', onVisChange);
      clearTimeout(fallbackTimer);
    }
  };
  document.addEventListener('visibilitychange', onVisChange);
  // Try native scheme directly
  window.location.href = gaodeScheme;
  // Fallback to H5 if app didn't open
  const fallbackTimer = setTimeout(() => {
    document.removeEventListener('visibilitychange', onVisChange);
    if (!document.hidden && Date.now() - start < 3000) {
      window.location.href = gaodeH5;
    }
  }, 1500);
};

// Map link component with provider toggle support (Google Maps / Gaode Maps)
const MapLink = ({ item, lang, mapProvider = 'gaode' }) => {
  const loc = getDisplayLocation(item, lang);
  if (!loc) return null;
  const coords = item.coordinates;
  let googleHref, gaodeH5, gaodeScheme;
  if (coords && (coords.latitude || coords.lat)) {
    const lat = coords.latitude || coords.lat;
    const lng = coords.longitude || coords.lng;
    googleHref = `https://www.google.com/maps/search/?api=1&query=${lat},${lng}`;
    gaodeH5 = `https://uri.amap.com/marker?position=${lng},${lat}&name=${encodeURIComponent(loc)}&callnative=0`;
    const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
    gaodeScheme = isIOS
      ? `iosamap://viewMap?sourceApplication=travel&poiname=${encodeURIComponent(loc)}&lat=${lat}&lon=${lng}&dev=0`
      : `androidamap://viewMap?sourceApplication=travel&poiname=${encodeURIComponent(loc)}&lat=${lat}&lon=${lng}&dev=0`;
  } else {
    googleHref = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(loc)}`;
    gaodeH5 = `https://uri.amap.com/search?keyword=${encodeURIComponent(loc)}&callnative=0`;
    const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
    gaodeScheme = isIOS
      ? `iosamap://poi?sourceApplication=travel&keywords=${encodeURIComponent(loc)}`
      : `androidamap://poi?sourceApplication=travel&keywords=${encodeURIComponent(loc)}`;
  }
  const isGaode = mapProvider === 'gaode';
  const Logo = isGaode ? GaodeLogo : GoogleMapsLogo;
  const title = isGaode ? 'Open in È´òÂæ∑Âú∞Âõæ' : 'Open in Google Maps';
  const color = isGaode ? '#0085fe' : '#4285F4';
  const handleClick = (e) => {
    e.stopPropagation();
    if (isGaode && isMobile) {
      e.preventDefault();
      openGaodeNative(gaodeScheme, gaodeH5);
    }
  };
  const href = isGaode ? gaodeH5 : googleHref;
  return (
    <span style={{ display: 'inline-flex', alignItems: 'center', gap: '4px' }}>
      <a href={href} target="_blank" rel="noopener noreferrer"
        style={{ color: color, textDecoration: 'none', borderBottom: `1px dashed ${color}` }}
        title={title}
        onClick={handleClick}>
        <span style={{ display: 'inline-flex', alignItems: 'center', gap: '3px' }}>
          <Logo size={14} />
          {loc}
        </span>
      </a>
    </span>
  );
};

// Fix issue #8: RedNote (Â∞èÁ∫¢‰π¶) search link component with official logo
// Official SVG source: https://static.cdnlogo.com/logos/r/77/rednote-xiaohongshu.svg
const XhsLogo = ({ size = 14 }) => (
  <svg viewBox="0 0 377.97 376.53" width={size} height={size} style={{ display: 'block', flexShrink: 0 }}>
    <path fill="#ff2842" d="M43.86,1.11C21.81,5.7,3.59,22.91,1.34,46.07c-2.33,23.92,0,49.25,0,73.3v149.53c0,27.5-6.94,64.79,10.75,87.96,19.11,25.02,53.98,19.06,81.6,19.06h214.03c8.48,0,18.08,1.24,26.39-.49,22.05-4.59,40.26-21.8,42.51-44.96,2.33-23.92,0-49.25,0-73.3V107.64c0-27.5,6.94-64.79-10.75-87.96C346.76-5.34,311.89.62,284.27.62H70.24c-8.48,0-18.08-1.24-26.39.49M177.26,134.02l-10.26,27.85h17.59l-14.66,35.18,13.19,1.47c-1.45,3.93-3.4,11.34-6.35,14.42-2.17,2.26-5.48,1.71-8.31,1.71-6.39,0-19.3,2.65-22.72-4.4-1.57-3.23.68-7.31,1.95-10.26,2.66-6.17,6.19-12.48,7.57-19.06-3.19,0-7.22.63-10.26-.49-11.4-4.19,1.28-22.52,3.91-28.83,1.85-4.43,4.04-14.05,8.06-16.86,5.65-3.94,14.24-1.21,20.28-.73M61.45,226.38c4.03,0,10.02,1.2,12.46-2.93,2.59-4.39.73-14.06.73-19.06v-48.38c0-4.53-2.29-18.38,1.71-21.26,3.29-2.37,17.1-1.87,18.57,2.2,2.4,6.66.24,17.83.24,24.92v46.91c0,8.04,1.39,17.39-1.95,24.92-3.19,7.18-18.04,13.59-25.41,8.06-3.24-2.43-5.55-11.6-6.35-15.39M284.27,134.02v7.33c5.47,0,12.33-1.12,17.59.49,17.56,5.36,16.13,22.61,16.13,37.63,2.93,0,5.93-.23,8.8.49,16.85,4.21,14.66,21.06,14.66,34.69,0,7.27,1.36,15.86-3.42,21.99-5.27,6.75-13.9,5.86-21.5,5.86-2.36,0-6.25.75-8.31-.73-3.85-2.77-5.54-11-6.35-15.39,4.82,0,13.51,1.65,17.35-1.95,4.52-4.25,2.67-20.86-2.69-23.7-2.84-1.5-7.16-.73-10.26-.73h-21.99v42.51h-20.52v-42.51h-20.52v-20.52h20.52v-17.59h-13.19v-20.52h13.19v-7.33h20.52M237.36,141.35v20.52h-11.73v61.57h19.06v19.06h-67.43l7.82-18.32,18.57-.73v-61.57h-11.73v-20.52h45.44M320.92,161.88c0-4.17-.76-9.17.49-13.19,4.9-15.82,28.76-3.07,16.86,10.02-1.35,1.49-3.73,2.22-5.62,2.69-3.75.94-7.89.49-11.73.49M61.45,161.88l-6.11,54.24-10.02,17.59-8.8-23.46,4.4-48.38h20.52M128.88,161.88l4.4,48.38-8.8,21.99h-2.93c-7.87-12.46-8.87-25.31-10.26-39.58-.99-10.14-2.93-20.58-2.93-30.78h20.52M284.27,161.88v17.59h13.19v-17.59h-13.19M174.32,223.45l-7.33,19.06h-32.25l7.82-19.79,11.24.24,20.52.49Z"/>
  </svg>
);
const RedNoteLink = ({ name }) => {
  if (!name) return null;
  const webUrl = `https://www.xiaohongshu.com/search_result/?keyword=${encodeURIComponent(name)}&source=web_explore_feed`;
  const deepUrl = `xhsdiscover://search/result?keyword=${encodeURIComponent(name)}`;
  const href = isMobile ? deepUrl : webUrl;
  return (
    <a href={href} target={isMobile ? '_self' : '_blank'} rel="noopener noreferrer"
      style={{ display: 'inline-flex', alignItems: 'center', gap: '3px', marginLeft: '6px', padding: '2px 6px', background: '#fff0f0', borderRadius: '4px', textDecoration: 'none', fontSize: '11px', color: '#ff2442', border: '1px solid #ffe0e0', transition: 'all .12s', verticalAlign: 'middle' }}
      title="Search on Â∞èÁ∫¢‰π¶"
      onClick={e => e.stopPropagation()}
      onMouseEnter={e => { e.currentTarget.style.background = '#ffe0e0'; }}
      onMouseLeave={e => { e.currentTarget.style.background = '#fff0f0'; }}>
      <XhsLogo size={14} />
      <span style={{ fontWeight: '600' }}>Â∞èÁ∫¢‰π¶</span>
    </a>
  );
};

const ExpandableNotes = ({ text, textLocal, lang, maxLines = 2 }) => {
  const [expanded, setExpanded] = useState(false);
  const displayText = lang === 'local' && textLocal ? textLocal : text;
  if (!displayText) return null;
  return (
    <div style={{ marginTop: '6px', fontSize: '12px', color: '#6b6b6b', background: '#fafaf8', padding: '8px 10px', borderRadius: '6px', border: '1px solid #f0efed' }}>
      <div style={{
        overflow: expanded ? 'visible' : 'hidden',
        display: expanded ? 'block' : '-webkit-box',
        WebkitLineClamp: expanded ? 'unset' : maxLines,
        WebkitBoxOrient: 'vertical',
        lineHeight: 1.6,
        whiteSpace: 'pre-wrap'
      }}>
        {displayText}
      </div>
      <button onClick={(e) => { e.stopPropagation(); setExpanded(!expanded); }}
        style={{ background: 'none', border: 'none', color: '#4a90d9', fontSize: '11px', cursor: 'pointer', padding: '4px 0 0', fontWeight: '500' }}>
        {expanded ? L('show_less', lang) : L('show_more', lang)}
      </button>
    </div>
  );
};

const KanbanView = ({ day, tripSummary, showSummary, bp, lang, mapProvider, onItemClick, onBudgetClick }) => {
  const sm = bp === 'sm';
  const px = sm ? '16px' : bp === 'md' ? '32px' : '48px';

  return (
    <div style={{ maxWidth: '960px', margin: '0 auto' }}>
      <div style={{
        width: '100%',
        height: sm ? '120px' : '200px',
        background: day.cover ? `linear-gradient(to bottom, rgba(0,0,0,0) 50%, rgba(0,0,0,0.03) 100%), url(${day.cover})` : '#f5f5f5',
        backgroundSize: 'cover', backgroundPosition: 'center'
      }} />

      <div style={{ padding: `0 ${px}` }}>
        <div style={{ marginTop: sm ? '-24px' : '-36px', marginBottom: '24px' }}>
          <div style={{ fontSize: sm ? '40px' : '56px', lineHeight: 1, marginBottom: '8px' }}>üó∫Ô∏è</div>

          {showSummary ? (
            <>
              <h1 style={{ fontSize: sm ? '24px' : '36px', fontWeight: '700', color: '#37352f', margin: '0 0 20px', lineHeight: 1.25 }}>
                {lang === 'local' && tripSummary.description_local ? tripSummary.description_local : tripSummary.description}
              </h1>
              <div style={{
                padding: sm ? '12px' : '16px 20px',
                background: '#fbfbfa', borderRadius: '8px',
                border: '1px solid #f0efed', marginBottom: '32px'
              }}>
                <PropertyRow label={L('trip_type', lang)}>{lang === 'local' && tripSummary.trip_type_local ? tripSummary.trip_type_local : tripSummary.trip_type}</PropertyRow>
                {tripSummary.base_location && <PropertyRow label={L('base_location', lang)}>{tripSummary.base_location}</PropertyRow>}
                <PropertyRow label={L('period', lang)}>{lang === 'local' && tripSummary.period_local ? tripSummary.period_local : tripSummary.period}</PropertyRow>
                <PropertyRow label={L('travelers', lang)}>{lang === 'local' && tripSummary.travelers_local ? tripSummary.travelers_local : tripSummary.travelers}</PropertyRow>
                <PropertyRow label={L('budget_trip', lang)}>{tripSummary.budget_per_trip}</PropertyRow>
                {/* Preferences hidden per user request */}
              </div>
            </>
          ) : (
            <h1 style={{ fontSize: sm ? '24px' : '36px', fontWeight: '700', color: '#37352f', margin: '0 0 24px', lineHeight: 1.25 }}>
              {dayLabel(day, lang)}
            </h1>
          )}

          {showSummary && (
            <h2 style={{ fontSize: sm ? '20px' : '26px', fontWeight: '700', color: '#37352f', margin: '0 0 28px' }}>
              {dayLabel(day, lang)}
            </h2>
          )}
        </div>

        {/* User Plans */}
        {day.user_plans && day.user_plans.length > 0 && (
          <Section title={L('user_plans', lang)} icon="üìù">
            <div style={{
              padding: '14px 18px', background: '#fafafa', borderRadius: '6px',
              border: '1px solid #f0efed'
            }}>
              <ul style={{ margin: 0, padding: '0 0 0 18px', fontSize: '14px', lineHeight: 2, color: '#37352f' }}>
                {day.user_plans.map((p, i) => <li key={i}>{p}</li>)}
              </ul>
            </div>
          </Section>
        )}

        {/* Meals */}
        <Section title={L('meals', lang)} icon="üçΩÔ∏è">
          <div style={{ display: 'grid', gridTemplateColumns: sm ? '1fr' : 'repeat(3, 1fr)', gap: '14px' }}>
            {['breakfast', 'lunch', 'dinner'].map(type => {
              const meal = day.meals[type];
              if (!meal) return null;
              const lb = (mealEmoji[type] || '') + ' ' + L(type, lang);
              return (
                <div key={type} style={{
                  background: '#fff', borderRadius: '8px',
                  boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)',
                  overflow: 'hidden', transition: 'box-shadow .15s', cursor: 'pointer'
                }}
                  onClick={() => onItemClick && onItemClick(meal, 'meal')}
                  onMouseEnter={e => e.currentTarget.style.boxShadow = '0 2px 8px rgba(0,0,0,0.08), 0 0 0 1px rgba(0,0,0,0.04)'}
                  onMouseLeave={e => e.currentTarget.style.boxShadow = '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)'}
                >
                  <div style={{ width: '100%', height: sm ? '100px' : '130px', overflow: 'hidden', background: '#f5f3ef' }}>
                    <img src={meal.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover' }}
                      onError={e => { e.target.style.display = 'none'; }} />
                  </div>
                  <div style={{ padding: '12px 14px' }}>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: '#37352f', marginBottom: '6px' }}>
                      {lb}: {getDisplayName(meal, lang)}
                      <RedNoteLink name={meal.name_local || meal.name_base} />
                    </div>
                    <div style={{ fontSize: '12px', color: '#6b6b6b', lineHeight: 1.7 }}>
                      {meal.time && <div><span style={{ color: '#9b9a97' }}>{L('time', lang)}</span> {meal.time.start} ‚Äì {meal.time.end}</div>}
                      {meal.cost > 0 && <div><span style={{ color: '#9b9a97' }}>{L('cost', lang)}</span> {fmtCost(meal.cost, undefined, lang)}</div>}
                      {getDisplayField(meal, 'cuisine', lang) && <div><span style={{ color: '#9b9a97' }}>{L('cuisine', lang)}</span> {getDisplayField(meal, 'cuisine', lang)}</div>}
                      {(meal.location_base || meal.location_local) && <div><span style={{ color: '#9b9a97' }}>{L('location', lang)}</span> <MapLink item={meal} lang={lang} mapProvider={mapProvider} /></div>}
                      {getDisplayField(meal, 'signature_dishes', lang) && !sm && <div><span style={{ color: '#9b9a97' }}>{L('signature', lang)}</span> {getDisplayField(meal, 'signature_dishes', lang)}</div>}
                    </div>
                    <ExpandableNotes text={meal.notes_base} textLocal={meal.notes_local} lang={lang} />
                    <LinksRow links={meal.links} compact={sm} />
                  </div>
                </div>
              );
            })}
          </div>
        </Section>

        {/* Attractions + Right column */}
        <div style={{ display: 'grid', gridTemplateColumns: sm ? '1fr' : '1fr 1fr', gap: '24px' }}>
          {/* Attractions */}
          <Section title={L('attractions', lang)} icon="üìç">
            {day.attractions.map((attr, i) => (
              <div key={i} style={{
                background: '#fff', borderRadius: '8px',
                boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)',
                overflow: 'hidden', marginBottom: '14px', transition: 'box-shadow .15s', cursor: 'pointer'
              }}
                onClick={() => onItemClick && onItemClick(attr, 'attraction')}
                onMouseEnter={e => e.currentTarget.style.boxShadow = '0 2px 8px rgba(0,0,0,0.08), 0 0 0 1px rgba(0,0,0,0.04)'}
                onMouseLeave={e => e.currentTarget.style.boxShadow = '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)'}
              >
                {sm ? (
                  <>
                    <div style={{ height: '110px', overflow: 'hidden', background: '#eef4f9' }}>
                      <img src={attr.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover' }} onError={e => e.target.style.display = 'none'} />
                    </div>
                    <div style={{ padding: '12px 14px' }}>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#37352f', marginBottom: '4px' }}>
                        {getDisplayName(attr, lang)}
                        <RedNoteLink name={attr.name_local || attr.name_base} />
                        {attr.optional && <span style={{ fontSize: '11px', padding: '2px 6px', background: '#f5f5f3', border: '1px solid #e0e0e0', borderRadius: '4px', color: '#9b9a97', marginLeft: '6px', fontWeight: '600', verticalAlign: 'middle' }}>{L('optional', lang)}</span>}
                      </div>
                      {attr.time && <PropLine label={L('time', lang)} value={`${attr.time.start} ‚Äì ${attr.time.end}`} />}
                      {attr.cost > 0 && <PropLine label={L('cost', lang)} value={<>{fmtCost(attr.cost, undefined, lang)}</>} />}
                      <PropLine label={L('type', lang)} value={getDisplayField(attr, 'type', lang)} />
                      {(attr.location_base || attr.location_local) && <PropLine label={L('location', lang)} value={<MapLink item={attr} lang={lang} mapProvider={mapProvider} />} />}
                      <ExpandableNotes text={attr.notes_base} textLocal={attr.notes_local} lang={lang} />
                      <LinksRow links={attr.links} compact />
                    </div>
                  </>
                ) : (
                  <div style={{ display: 'flex' }}>
                    <div style={{ width: '140px', flexShrink: 0, overflow: 'hidden', background: '#eef4f9' }}>
                      <img src={attr.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover', minHeight: '160px' }} onError={e => e.target.style.display = 'none'} />
                    </div>
                    <div style={{ padding: '14px 16px', flex: 1, lineHeight: 1.7 }}>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#37352f', marginBottom: '2px' }}>
                        {getDisplayName(attr, lang)}
                        <RedNoteLink name={attr.name_local || attr.name_base} />
                        {attr.optional && <span style={{ fontSize: '11px', padding: '2px 6px', background: '#f5f5f3', border: '1px solid #e0e0e0', borderRadius: '4px', color: '#9b9a97', marginLeft: '6px', fontWeight: '600', verticalAlign: 'middle' }}>{L('optional', lang)}</span>}
                      </div>
                      {attr.time && <PropLine label={L('time', lang)} value={`${attr.time.start} ‚Äì ${attr.time.end}`} />}
                      {attr.cost > 0 && <PropLine label={L('cost', lang)} value={<>{fmtCost(attr.cost, undefined, lang)}</>} />}
                      <PropLine label={L('type', lang)} value={getDisplayField(attr, 'type', lang)} />
                      {(attr.location_base || attr.location_local) && <PropLine label={L('location', lang)} value={<MapLink item={attr} lang={lang} mapProvider={mapProvider} />} />}
                      <ExpandableNotes text={attr.notes_base} textLocal={attr.notes_local} lang={lang} />
                      <LinksRow links={attr.links} />
                    </div>
                  </div>
                )}
              </div>
            ))}
          </Section>

          {/* Right column */}
          <div>
            {day.entertainment?.length > 0 && (
              <Section title={L('entertainment', lang)} icon="üé≠">
                {day.entertainment.map((ent, i) => (
                  <div key={i} style={{
                    background: '#fff', borderRadius: '8px',
                    boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)',
                    overflow: 'hidden', marginBottom: '10px', cursor: 'pointer'
                  }}
                    onClick={() => onItemClick && onItemClick(ent, 'entertainment')}
                  >
                    {ent.image && (
                      <div style={{ width: '100%', height: sm ? '100px' : '120px', overflow: 'hidden', background: '#f5f3ef' }}>
                        <img src={ent.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover' }}
                          onError={e => { e.target.style.display = 'none'; }} />
                      </div>
                    )}
                    <div style={{ padding: '14px 16px' }}>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#37352f', marginBottom: '8px' }}>
                        {getDisplayName(ent, lang)}
                        <RedNoteLink name={ent.name_local || ent.name_base} />
                      </div>
                      {ent.time && <PropLine label={L('time', lang)} value={`${ent.time.start} ‚Äì ${ent.time.end}`} />}
                      {ent.cost > 0 && <PropLine label={L('cost', lang)} value={fmtCost(ent.cost, undefined, lang)} />}
                      <PropLine label={L('type', lang)} value={getDisplayField(ent, 'type', lang)} />
                      {(ent.location_base || ent.location_local) && <PropLine label={L('location', lang)} value={<MapLink item={ent} lang={lang} mapProvider={mapProvider} />} />}
                      {ent.duration && <PropLine label={L('duration', lang)} value={ent.duration} />}
                      {(lang === 'local' && ent.note_local ? ent.note_local : ent.note_base) && (
                        <div style={{ marginTop: '8px', padding: '8px 12px', background: '#fffdf5', borderRadius: '5px', border: '1px solid #f5ecd7', fontSize: '12px', color: '#9a6700' }}>
                          üí° {lang === 'local' && ent.note_local ? ent.note_local : ent.note_base}
                        </div>
                      )}
                      <ExpandableNotes text={ent.notes_base} textLocal={ent.notes_local} lang={lang} />
                      <LinksRow links={ent.links} compact={sm} />
                    </div>
                  </div>
                ))}
              </Section>
            )}

            {day.shopping && day.shopping.length > 0 && (
              <Section title={L('shopping', lang)} icon="üõçÔ∏è">
                {day.shopping.map((shop, i) => (
                  <div key={i} style={{
                    background: '#fff', borderRadius: '8px',
                    boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)',
                    overflow: 'hidden', marginBottom: '10px', cursor: 'pointer'
                  }}
                    onClick={() => onItemClick && onItemClick(shop, 'shopping')}
                  >
                    {shop.image && (
                      <div style={{ width: '100%', height: sm ? '100px' : '120px', overflow: 'hidden', background: '#f5f3ef' }}>
                        <img src={shop.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover' }}
                          onError={e => { e.target.style.display = 'none'; }} />
                      </div>
                    )}
                    <div style={{ padding: '14px 16px' }}>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#37352f', marginBottom: '8px' }}>
                        {getDisplayName(shop, lang)}
                        <RedNoteLink name={shop.name_local || shop.name_base} />
                      </div>
                      {shop.time && <PropLine label={L('time', lang)} value={`${shop.time.start} ‚Äì ${shop.time.end}`} />}
                      {shop.cost > 0 && <PropLine label={L('cost', lang)} value={fmtCost(shop.cost, undefined, lang)} />}
                      <PropLine label={L('type', lang)} value={getDisplayField(shop, 'type', lang)} />
                      {(shop.location_base || shop.location_local) && <PropLine label={L('location', lang)} value={<MapLink item={shop} lang={lang} mapProvider={mapProvider} />} />}
                      <ExpandableNotes text={shop.notes_base} textLocal={shop.notes_local} lang={lang} />
                    </div>
                  </div>
                ))}
              </Section>
            )}

            {day.accommodation && (
              <Section title={L('accommodation', lang)} icon="üè®">
                <div style={{
                  background: '#fff', borderRadius: '8px',
                  boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)',
                  overflow: 'hidden', cursor: 'pointer'
                }}
                  onClick={() => onItemClick && onItemClick(day.accommodation, 'accommodation')}
                >
                  {day.accommodation.image && (
                    <div style={{ width: '100%', height: sm ? '120px' : '160px', overflow: 'hidden', background: '#f5f3ef' }}>
                      <img src={day.accommodation.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover' }}
                        onError={e => { e.target.style.display = 'none'; }} />
                    </div>
                  )}
                  <div style={{ padding: '14px 16px' }}>
                    <div style={{ fontSize: '14px', fontWeight: '600', color: '#37352f', marginBottom: '4px' }}>
                      {getDisplayName(day.accommodation, lang)}
                      <RedNoteLink name={day.accommodation.name_local || day.accommodation.name_base} />
                    </div>
                    {day.accommodation.time && <PropLine label={L('time', lang)} value={`${day.accommodation.time.start} ‚Äì ${day.accommodation.time.end}`} />}
                    {day.accommodation.check_in && <PropLine label={L('checkin', lang)} value={day.accommodation.check_in} />}
                    {day.accommodation.check_out && <PropLine label={L('checkout', lang)} value={day.accommodation.check_out} />}
                    {day.accommodation.cost > 0 && <PropLine label={L('cost', lang)} value={fmtCost(day.accommodation.cost, undefined, lang)} />}
                    <PropLine label={L('type', lang)} value={getDisplayField(day.accommodation, 'type', lang)} />
                    {day.accommodation.stars > 0 && <PropLine label={L('stars', lang)} value={<span style={{ color: '#e9b200', letterSpacing: '1px' }}>{'‚òÖ'.repeat(day.accommodation.stars)}</span>} />}
                    <PropLine label={L('location', lang)} value={<MapLink item={day.accommodation} lang={lang} mapProvider={mapProvider} />} />
                    <ExpandableNotes text={day.accommodation.notes_base} textLocal={day.accommodation.notes_local} lang={lang} />
                    <LinksRow links={day.accommodation.links} compact={sm} />
                  </div>
                </div>
              </Section>
            )}

            {day.transportation && (
              <Section title={L('transportation', lang)} icon={day.transportation.icon}>
                <div style={{
                  background: '#fff', borderRadius: '8px',
                  boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)',
                  overflow: 'hidden', cursor: 'pointer'
                }}
                  onClick={() => onItemClick && onItemClick(day.transportation, 'transportation')}
                >
                  <div style={{ padding: '14px 16px' }}>
                    <div style={{ fontSize: '14px', fontWeight: '600', color: '#37352f', marginBottom: '8px', display: 'flex', alignItems: 'center', gap: '6px' }}>
                      {day.transportation.icon}
                      {' '}
                      {lang === 'local' && day.transportation.from_local ? day.transportation.from_local : day.transportation.from_base}
                      {' ‚Üí '}
                      {lang === 'local' && day.transportation.to_local ? day.transportation.to_local : day.transportation.to_base}
                    </div>
                    {day.transportation.time && <PropLine label={L('time', lang)} value={`${day.transportation.time.start} ‚Äì ${day.transportation.time.end}`} />}
                    {(day.transportation.cost > 0 || day.transportation.cost_type_base === 'prepaid') && (
                      <PropLine label={L('cost', lang)} value={fmtCost(day.transportation.cost, day.transportation.cost_type_base, lang)} />
                    )}
                    <PropLine label={L('type', lang)} value={getDisplayField(day.transportation, 'type', lang)} />
                    {day.transportation.route_number && <PropLine label={L('route_number', lang)} value={day.transportation.route_number} />}
                    {getDisplayField(day.transportation, 'company', lang) && <PropLine label={L('company', lang)} value={getDisplayField(day.transportation, 'company', lang)} />}
                    {getDisplayField(day.transportation, 'status', lang) && (
                      <div style={{ marginTop: '4px' }}>
                        <span style={{
                          padding: '2px 8px', borderRadius: '4px', fontSize: '11px', fontWeight: '600',
                          background: day.transportation.status_base?.includes('URGENT') ? '#fff4e6' : day.transportation.status_base?.includes('VERIFIED') ? '#e9f5ec' : '#edf2fc',
                          color: day.transportation.status_base?.includes('URGENT') ? '#d97706' : day.transportation.status_base?.includes('VERIFIED') ? '#1a7a32' : '#2b63b5'
                        }}>
                          {getDisplayField(day.transportation, 'status', lang)}
                        </span>
                      </div>
                    )}
                    <PropLine label={L('route', lang)} value={`${lang === 'local' && day.transportation.departure_point_local ? day.transportation.departure_point_local : day.transportation.departure_point_base} ‚Üí ${lang === 'local' && day.transportation.arrival_point_local ? day.transportation.arrival_point_local : day.transportation.arrival_point_base}`} />
                    {(lang === 'local' && day.transportation.note_local ? day.transportation.note_local : day.transportation.note_base) && (
                      <div style={{ marginTop: '8px', padding: '8px 12px', background: '#fffdf5', borderRadius: '5px', border: '1px solid #f5ecd7', fontSize: '12px', color: '#9a6700' }}>
                        üí° {lang === 'local' && day.transportation.note_local ? day.transportation.note_local : day.transportation.note_base}
                      </div>
                    )}
                    <ExpandableNotes text={day.transportation.notes_base} textLocal={day.transportation.notes_local} lang={lang} />
                  </div>
                </div>
              </Section>
            )}

            <Section title={L('budget', lang)} icon="üí∞">
              <div style={{
                background: '#fff', borderRadius: '8px',
                boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)',
                padding: '16px'
              }}>
                <div style={{ display: 'flex', alignItems: sm ? 'center' : 'center', gap: '20px', flexDirection: sm ? 'column' : 'row' }}>
                  <Donut budget={day.budget} size={sm ? 72 : 88} onBudgetClick={onBudgetClick} day={day} />
                  <div style={{ fontSize: '13px', color: '#6b6b6b', lineHeight: 2, flex: 1, width: '100%' }}>
                    {[
                      { k: 'meals', l: L('meals', lang), c: '#f0b429' },
                      { k: 'attractions', l: L('attractions', lang), c: '#4a90d9' },
                      { k: 'entertainment', l: L('entertainment', lang), c: '#9b6dd7' },
                      { k: 'accommodation', l: L('accommodation', lang), c: '#45b26b' },
                      { k: 'shopping', l: L('shopping', lang), c: '#e07c5a' },
                      { k: 'transportation', l: L('transport', lang), c: '#0ea5e9' }
                    ].filter(r => day.budget[r.k] > 0).map(r => (
                      <div key={r.k} style={{
                        display: 'flex', alignItems: 'center', gap: '8px',
                        cursor: 'pointer', padding: '4px 6px', margin: '0 -6px',
                        borderRadius: '4px', transition: 'background .12s'
                      }}
                        onClick={() => onBudgetClick && onBudgetClick(r.k, day)}
                        onMouseEnter={e => e.currentTarget.style.background = 'rgba(55,53,47,0.04)'}
                        onMouseLeave={e => e.currentTarget.style.background = 'transparent'}
                      >
                        <span style={{ width: '10px', height: '10px', borderRadius: '3px', background: r.c, flexShrink: 0 }} />
                        <span style={{ flex: 1 }}>{r.l}</span>
                        <span style={{ fontWeight: '600', color: '#37352f' }}>{fmtCost(day.budget[r.k], undefined, lang)}</span>
                      </div>
                    ))}
                    <div style={{ borderTop: '1px solid #edece9', marginTop: '8px', paddingTop: '8px', fontWeight: '700', color: '#37352f', display: 'flex', justifyContent: 'space-between' }}>
                      <span>{L('total', lang)}</span><span>{CURRENCY_SYMBOL}{day.budget.total.toFixed(0)}</span>
                    </div>
                  </div>
                </div>
              </div>
            </Section>
          </div>
        </div>
      </div>
    </div>
  );
};

// ============================================================
// TIMELINE VIEW
// ============================================================
const TimelineView = ({ day, bp, lang, mapProvider, onItemClick }) => {
  // Fix #6: Add z-index state for click handling of overlapping items
  const [topItemIndex, setTopItemIndex] = useState(null);
  const sm = bp === 'sm';
  const px = sm ? '16px' : bp === 'md' ? '32px' : '48px';
  const timeW = sm ? '48px' : '62px';

  const entries = [];
  const add = (item, type, label) => {
    // Only add if item has valid time with start and end
    if (item?.time?.start && item?.time?.end) {
      entries.push({ ...item, _type: type, _label: label });
    }
  };
  // Add transportation if exists (Fix Issue #8, #9: bilingual label respects lang toggle)
  if (day.transportation) {
    const tFrom = lang === 'local' && day.transportation.from_local ? day.transportation.from_local : day.transportation.from_base;
    const tTo = lang === 'local' && day.transportation.to_local ? day.transportation.to_local : day.transportation.to_base;
    add(day.transportation, 'transportation', `${tFrom} ‚Üí ${tTo}`);
  }
  add(day.meals.breakfast, 'meal', L('cat_breakfast', lang));
  add(day.meals.lunch, 'meal', L('cat_lunch', lang));
  add(day.meals.dinner, 'meal', L('cat_dinner', lang));
  day.attractions?.forEach(a => add(a, 'attraction', L('cat_attraction', lang)));
  day.entertainment?.forEach(e => add(e, 'entertainment', L('cat_entertainment', lang)));
  if (day.accommodation) add(day.accommodation, 'accommodation', L('cat_checkin', lang));
  // Fix issue #6: Add travel segments from timeline
  day.travel_segments?.forEach(t => {
    const label = lang === 'local' && t.name_local ? t.name_local : (t.name_base || '');
    add(t, 'travel', label);
  });

  // Sort by start time
  entries.sort((a, b) => a.time.start.localeCompare(b.time.start));

  const firstH = entries.length ? parseInt(entries[0].time.start) : 8;
  const lastH = entries.length ? Math.min(parseInt(entries[entries.length - 1].time.start) + 2, 24) : 20;
  const hours = []; for (let h = firstH; h <= lastH; h++) hours.push(h);

  const hH = sm ? 68 : 80;
  const typeStyle = {
    transportation: { bg: '#f0f9ff', border: '#7dd3fc', dot: '#0ea5e9' },
    meal: { bg: '#fffdf5', border: '#ebd984', dot: '#f0b429' },
    attraction: { bg: '#f6fafd', border: '#a8cceb', dot: '#4a90d9' },
    entertainment: { bg: '#faf6fd', border: '#c9aee6', dot: '#9b6dd7' },
    accommodation: { bg: '#f5fbf6', border: '#a2d9b1', dot: '#45b26b' },
    shopping: { bg: '#fff7f5', border: '#f0b29a', dot: '#e07c5a' },
    travel: { bg: '#f8f8f8', border: '#d0d0d0', dot: '#999' }
  };

  const top = (t) => { const [h, m] = t.split(':').map(Number); return (h - firstH) * hH + (m / 60) * hH; };
  const rawHgt = (s, e) => top(e) - top(s);
  const hgt = (s, e) => Math.max(rawHgt(s, e), sm ? 56 : 64);

  // Debug: log entries count
  if (entries.length === 0) {
    console.warn('Timeline has no entries for day:', day.day, day.location);
  }

  return (
    <div style={{ maxWidth: '900px', margin: '0 auto' }}>
      <div style={{
        width: '100%', height: sm ? '100px' : '160px',
        background: day.cover ? `url(${day.cover})` : '#f5f5f5',
        backgroundSize: 'cover', backgroundPosition: 'center'
      }} />

      <div style={{ padding: `0 ${px}` }}>
        <div style={{ marginTop: sm ? '-20px' : '-30px', marginBottom: '24px' }}>
          <div style={{ fontSize: sm ? '36px' : '48px', lineHeight: 1, marginBottom: '6px' }}>üìç</div>
          <h2 style={{ fontSize: sm ? '22px' : '28px', fontWeight: '700', color: '#37352f', margin: 0 }}>
            {dayLabel(day, lang)}
          </h2>
        </div>

        {entries.length === 0 ? (
          <div style={{ padding: '40px 20px', textAlign: 'center', color: '#9b9a97' }}>
            <div style={{ fontSize: '48px', marginBottom: '16px' }}>‚è∞</div>
            <div style={{ fontSize: '16px', marginBottom: '8px' }}>{L('no_timeline', lang)}</div>
            <div style={{ fontSize: '13px' }}>{L('no_timeline_sub', lang)}</div>
          </div>
        ) : (
          <div style={{ display: 'flex', position: 'relative' }}>
          <div style={{ width: timeW, flexShrink: 0 }}>
            {hours.map(h => (
              <div key={h} style={{ height: hH, fontSize: '12px', color: '#c4c4c0', fontFamily: 'ui-monospace, monospace', paddingTop: '2px' }}>
                {String(h).padStart(2, '0')}:00
              </div>
            ))}
          </div>

          <div style={{ flex: 1, position: 'relative', borderLeft: '1px dashed #e5e4e1', minWidth: 0 }}>
            {hours.map(h => <div key={h} style={{ height: hH, borderBottom: '1px solid #f5f5f3' }} />)}

            {entries.map((entry, i) => {
              const st = typeStyle[entry._type] || typeStyle.attraction;
              const t = top(entry.time.start);
              const entryH = hgt(entry.time.start, entry.time.end);
              const tooNarrow = entryH < (sm ? 32 : 40);
              const showText = !tooNarrow && entryH > (sm ? 40 : 48);
              const showSubtext = !tooNarrow && entryH > (sm ? 56 : 68);
              // Fix #6: Use dynamic z-index based on click state
              const isTop = topItemIndex === i;
              const zIdx = isTop ? 10 : 2;
              return (
                <div key={i} style={{
                  position: 'absolute', top: t, left: '10px', right: '10px',
                  height: entryH - 4,
                  background: st.bg, borderLeft: `3px ${entry.optional ? 'dashed' : 'solid'} ${st.border}`,
                  borderRadius: '6px', padding: tooNarrow ? '0 6px' : (sm ? '8px 10px' : '10px 14px'),
                  display: 'flex', gap: tooNarrow ? '0' : '10px', alignItems: tooNarrow ? 'center' : 'flex-start',
                  boxShadow: isTop ? '0 4px 12px rgba(0,0,0,0.12)' : '0 1px 3px rgba(0,0,0,0.04)',
                  zIndex: zIdx, overflow: 'hidden', transition: 'all .15s', cursor: 'pointer'
                }}
                  onClick={() => { setTopItemIndex(i); onItemClick && onItemClick(entry, entry._type); }}
                  onMouseEnter={e => { if (!isTop) e.currentTarget.style.boxShadow = '0 2px 8px rgba(0,0,0,0.08)'; }}
                  onMouseLeave={e => { if (!isTop) e.currentTarget.style.boxShadow = '0 1px 3px rgba(0,0,0,0.04)'; }}
                >
                  <div style={{
                    position: 'absolute', left: '-8px', top: '50%', transform: 'translateY(-50%)',
                    width: '8px', height: '8px', borderRadius: '50%',
                    background: st.dot, border: '2px solid #fff'
                  }} />

                  {entry.image && !sm && showText && (
                    <div style={{ width: '50px', height: '50px', borderRadius: '6px', overflow: 'hidden', flexShrink: 0 }}>
                      <img src={entry.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover' }} onError={e => e.target.style.display = 'none'} />
                    </div>
                  )}
                  <div style={{ flex: 1, minWidth: 0 }}>
                    <div style={{ fontSize: '11px', color: '#b4b4b4' }}>{entry.time.start} ‚Äì {entry.time.end}</div>
                    {showText && (
                    <div style={{
                      fontSize: sm ? '12px' : '14px', fontWeight: '600', color: '#37352f',
                      whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis'
                    }}>
                      {entry._type === 'transportation' || entry._type === 'travel' ? (
                        <span>{entry._type === 'transportation' ? entry.icon : (entry.icon || 'üö∂')} {entry._label}{entry.duration ? ` (${entry.duration})` : ''}</span>
                      ) : (
                        <span>{entry._label}: {getDisplayName(entry, lang)}</span>
                      )}
                      {entry.optional && (
                        <span style={{ fontSize: '11px', padding: '2px 6px', background: '#f5f5f3', border: '1px solid #e0e0e0', borderRadius: '4px', color: '#9b9a97', marginLeft: '6px', fontWeight: '600', verticalAlign: 'middle' }}>{L('optional', lang)}</span>
                      )}
                    </div>
                    )}
                    {showSubtext && (entry._type === 'transportation' ? (
                      <div style={{ fontSize: '11px', color: '#9b9a97', marginTop: '2px', lineHeight: 1.5 }}>
                        <div>{lang === 'local' && entry.departure_point_local ? entry.departure_point_local : entry.departure_point_base} ‚Üí {lang === 'local' && entry.arrival_point_local ? entry.arrival_point_local : entry.arrival_point_base}</div>
                        {entry.route_number && entry.route_number !== 'VERIFIED' && (
                          <div>{lang === 'local' && entry.type_local ? entry.type_local : entry.type_base} {entry.route_number}</div>
                        )}
                        {entry.status_base && (
                          <span style={{
                            display: 'inline-block',
                            marginTop: '2px',
                            padding: '2px 6px',
                            borderRadius: '3px',
                            fontSize: '10px',
                            fontWeight: '600',
                            background: entry.status_base?.includes('URGENT') ? '#fff4e6' :
                                       entry.status_base?.includes('VERIFIED') ? '#e9f5ec' : '#edf2fc',
                            color: entry.status_base?.includes('URGENT') ? '#d97706' :
                                  entry.status_base?.includes('VERIFIED') ? '#1a7a32' : '#2b63b5'
                          }}>
                            {lang === 'local' && entry.status_local ? entry.status_local : entry.status_base}
                          </span>
                        )}
                      </div>
                    ) : (
                      <div style={{ display: 'flex', alignItems: 'center', gap: '6px', fontSize: '11px', color: '#9b9a97', flexWrap: 'wrap', marginTop: '2px' }}>
                        {entry.recommended_duration && <span>‚è± {entry.recommended_duration}</span>}
                        {entry.cost !== undefined && Number(entry.cost) > 0 && (
                          <span style={{
                            padding: '1px 6px', borderRadius: '3px', fontWeight: '600',
                            background: '#f5f5f3',
                            color: '#37352f'
                          }}>
                            {fmtCost(entry.cost, undefined, lang)}
                          </span>
                        )}
                        {entry.stars && <span style={{ color: '#e9b200' }}>{'‚òÖ'.repeat(entry.stars)}</span>}
                      </div>
                    ))}
                    {showSubtext && entry._type !== 'transportation' && <LinksRow links={entry.links} compact={sm} />}
                  </div>
                </div>
              );
            })}
          </div>
        </div>
        )}
      </div>
    </div>
  );
};

// ============================================================
// APP
// ============================================================
function NotionTravelApp() {
  const [selTrip, setSelTrip] = useState(0);
  const [selDay, setSelDay] = useState(0);
  const [view, setView] = useState('kanban');
  const [sbOpen, setSbOpen] = useState(false);
  const [selectedItem, setSelectedItem] = useState(null);
  const [selectedBudgetCat, setSelectedBudgetCat] = useState(null);
  // Root cause fix (commit 8f2bddd): Add language toggle for bilingual POI display
  const [lang, setLang] = useState('local');  // 'local' or 'base'
  const [mapProvider, setMapProvider] = useState('gaode');  // 'gaode' or 'google'
  const bp = useBreakpoint();
  const sm = bp === 'sm';

  const trip = PLAN_DATA.trips[selTrip];
  const day = trip?.days?.[selDay];

  const handleItemClick = (item, type) => {
    setSelectedBudgetCat(null);
    setSelectedItem({ item, type });
  };

  const handleBudgetClick = (category, dayData) => {
    setSelectedItem(null);

    let items = [];
    let total = 0;

    if (category === 'meals') {
      ['breakfast', 'lunch', 'dinner'].forEach(mealType => {
        if (dayData.meals[mealType]) {
          items.push(dayData.meals[mealType]);
          total += dayData.meals[mealType].cost || 0;
        }
      });
    } else if (category === 'attractions') {
      items = dayData.attractions || [];
      total = dayData.budget.attractions || 0;
    } else if (category === 'entertainment') {
      items = dayData.entertainment || [];
      total = dayData.budget.entertainment || 0;
    } else if (category === 'accommodation') {
      items = dayData.accommodation ? [dayData.accommodation] : [];
      total = dayData.budget.accommodation || 0;
    } else if (category === 'shopping') {
      items = dayData.shopping || [];
      total = dayData.budget.shopping || 0;
    } else if (category === 'transportation') {
      items = dayData.transportation ? [dayData.transportation] : [];
      total = dayData.budget.transportation || 0;
    }

    setSelectedBudgetCat({ category, items, total });
  };

  return (
    <div style={{
      display: 'flex',
      fontFamily: "ui-sans-serif, -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, 'Noto Sans SC', sans-serif",
      background: '#ffffff', minHeight: '100vh', color: '#37352f'
    }}>
      <Sidebar
        trips={PLAN_DATA.trips} selTrip={selTrip} selDay={selDay}
        onSelect={(ti, di) => { setSelTrip(ti); setSelDay(di); }}
        isOpen={sbOpen} onClose={() => setSbOpen(false)} bp={bp}
        lang={lang}
      />

      <div style={{ flex: 1, minWidth: 0 }}>
        <div style={{
          borderBottom: '1px solid #f0efed',
          padding: `0 ${sm ? '12px' : '20px'}`,
          display: 'flex', alignItems: 'center', flexWrap: 'wrap',
          position: 'sticky', top: 0, background: 'rgba(255,255,255,0.97)',
          backdropFilter: 'blur(8px)', zIndex: 50, gap: '2px'
        }}>
          {sm && (
            <button onClick={() => setSbOpen(true)} style={{
              background: 'none', border: 'none', cursor: 'pointer',
              fontSize: '17px', padding: '10px 6px 10px 2px', color: '#37352f'
            }}>‚ò∞</button>
          )}
          {['kanban', 'timeline'].map(m => (
            <button key={m} onClick={() => setView(m)} style={{
              padding: sm ? '10px 8px' : '11px 16px', background: 'none', border: 'none',
              borderBottom: view === m ? '2px solid #37352f' : '2px solid transparent',
              fontSize: '14px', fontWeight: view === m ? '600' : '400',
              color: view === m ? '#37352f' : '#b4b4b4',
              cursor: 'pointer', transition: 'all .12s', whiteSpace: 'nowrap'
            }}>
              {m === 'kanban' ? L('kanban_view', lang) : L('timeline_view', lang)}
            </button>
          ))}
          <div style={{ marginLeft: 'auto', display: 'flex', alignItems: 'center', gap: sm ? '6px' : '12px', ...(sm ? { width: '100%', justifyContent: 'flex-end', paddingBottom: '6px' } : {}) }}>
            {/* Map provider toggle */}
            <div style={{ display: 'flex', gap: '2px', background: '#f5f5f3', borderRadius: '6px', padding: '2px', border: '1px solid #e0e0e0' }}>
              <button onClick={() => setMapProvider('gaode')} style={{
                padding: sm ? '5px 6px' : '6px 10px',
                background: mapProvider === 'gaode' ? '#e6f3ff' : 'transparent',
                border: mapProvider === 'gaode' ? '1px solid #0085fe' : '1px solid transparent',
                borderRadius: '4px',
                fontSize: '12px', fontWeight: mapProvider === 'gaode' ? '600' : '400',
                color: mapProvider === 'gaode' ? '#0085fe' : '#6b6b6b',
                cursor: 'pointer', transition: 'all .12s',
                display: 'flex', alignItems: 'center', gap: '3px'
              }}>
                <GaodeLogo size={12} />
                {sm ? 'È´òÂæ∑' : 'È´òÂæ∑Âú∞Âõæ'}
              </button>
              <button onClick={() => setMapProvider('google')} style={{
                padding: sm ? '5px 6px' : '6px 10px',
                background: mapProvider === 'google' ? '#e8f0fe' : 'transparent',
                border: mapProvider === 'google' ? '1px solid #4285F4' : '1px solid transparent',
                borderRadius: '4px',
                fontSize: '12px', fontWeight: mapProvider === 'google' ? '600' : '400',
                color: mapProvider === 'google' ? '#4285F4' : '#6b6b6b',
                cursor: 'pointer', transition: 'all .12s',
                display: 'flex', alignItems: 'center', gap: '3px'
              }}>
                <GoogleMapsLogo size={12} />
                Google
              </button>
            </div>
            {/* Language toggle */}
            <div style={{ display: 'flex', gap: '4px' }}>
              <button onClick={() => setLang('local')} style={{
                padding: sm ? '8px 10px' : '9px 14px',
                background: lang === 'local' ? '#e9f5ec' : '#f5f5f3',
                border: `1px solid ${lang === 'local' ? '#45b26b' : '#e0e0e0'}`,
                borderRadius: '6px',
                fontSize: '13px', fontWeight: lang === 'local' ? '600' : '400',
                color: lang === 'local' ? '#45b26b' : '#6b6b6b',
                cursor: 'pointer', transition: 'all .12s'
              }}>
                {PLAN_DATA.trip_summary.local_display || 'Local'}
              </button>
              <button onClick={() => setLang('base')} style={{
                padding: sm ? '8px 10px' : '9px 14px',
                background: lang === 'base' ? '#e9f5ec' : '#f5f5f3',
                border: `1px solid ${lang === 'base' ? '#45b26b' : '#e0e0e0'}`,
                borderRadius: '6px',
                fontSize: '13px', fontWeight: lang === 'base' ? '600' : '400',
                color: lang === 'base' ? '#45b26b' : '#6b6b6b',
                cursor: 'pointer', transition: 'all .12s'
              }}>
                {PLAN_DATA.trip_summary.base_display || 'EN'}
              </button>
            </div>
          </div>
        </div>

        {day ? (
          view === 'kanban'
            ? <KanbanView
                day={day}
                tripSummary={PLAN_DATA.trip_summary}
                showSummary={selDay === 0 && selTrip === 0}
                bp={bp}
                lang={lang}
                mapProvider={mapProvider}
                onItemClick={handleItemClick}
                onBudgetClick={handleBudgetClick}
              />
            : <TimelineView
                day={day}
                bp={bp}
                lang={lang}
                mapProvider={mapProvider}
                onItemClick={handleItemClick}
              />
        ) : (
          <div style={{ padding: `60px ${sm ? '16px' : '48px'}`, color: '#c4c4c0' }}>
            <div style={{ fontSize: '48px', marginBottom: '12px' }}>üó∫Ô∏è</div>
            <div style={{ fontWeight: '500', fontSize: '16px', color: '#9b9a97' }}>{trip?.name}</div>
            <div style={{ marginTop: '4px' }}>{L('coming_soon', lang)}</div>
          </div>
        )}

        {selectedItem && (
          <ItemDetailSidebar
            item={selectedItem.item}
            type={selectedItem.type}
            onClose={() => setSelectedItem(null)}
            bp={bp}
            lang={lang}
            mapProvider={mapProvider}
          />
        )}

        {selectedBudgetCat && (
          <BudgetDetailSidebar
            category={selectedBudgetCat.category}
            items={selectedBudgetCat.items}
            total={selectedBudgetCat.total}
            onClose={() => setSelectedBudgetCat(null)}
            bp={bp}
            lang={lang}
          />
        )}
      </div>
    </div>
  );
}


    // Render app
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<NotionTravelApp />);
  </script>
</body>
</html>