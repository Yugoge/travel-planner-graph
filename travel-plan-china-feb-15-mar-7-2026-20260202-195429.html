<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Travel Plan - china-feb-15-mar-7-2026-20260202-195429</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --color-primary: #F5F1E8;
      --color-secondary: #8B7355;
      --color-accent: #D4AF37;
      --color-dark: #4A3F35;
      --color-light: #FDFCFA;
      --color-neutral: #E8E3DA;
      --color-success: #8FAF7A;
      --color-warning: #D4A574;
      --color-danger: #B5695F;
      --space-xs: 8px;
      --space-sm: 16px;
      --space-md: 24px;
      --space-lg: 32px;
      --space-xl: 48px;
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 12px;
      --shadow-subtle: 0 1px 3px rgba(74, 63, 53, 0.08);
      --shadow-medium: 0 4px 6px rgba(74, 63, 53, 0.10);
      --shadow-large: 0 10px 20px rgba(74, 63, 53, 0.12);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: var(--color-primary);
      color: var(--color-dark);
      line-height: 1.6;
      min-height: 100vh;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: var(--space-md);
    }

    header {
      text-align: center;
      padding: var(--space-xl) 0;
      margin-bottom: var(--space-lg);
    }

    header h1 {
      font-size: 2.5rem;
      font-weight: 300;
      color: var(--color-dark);
      margin-bottom: var(--space-sm);
      letter-spacing: -0.5px;
    }

    header .subtitle {
      font-size: 1rem;
      color: var(--color-secondary);
    }

    .tabs {
      display: flex;
      gap: var(--space-sm);
      margin-bottom: var(--space-lg);
      border-bottom: 2px solid var(--color-neutral);
      overflow-x: auto;
      padding-bottom: var(--space-xs);
    }

    .tab {
      background: transparent;
      border: none;
      padding: var(--space-sm) var(--space-md);
      font-size: 1rem;
      color: var(--color-secondary);
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
      border-bottom: 3px solid transparent;
    }

    .tab:hover {
      color: var(--color-dark);
    }

    .tab.active {
      color: var(--color-accent);
      border-bottom-color: var(--color-accent);
      font-weight: 500;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--space-md);
      margin-bottom: var(--space-xl);
    }

    .stat-card {
      background: var(--color-light);
      padding: var(--space-md);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-subtle);
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .stat-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-medium);
    }

    .stat-icon {
      font-size: 1.5rem;
      color: var(--color-accent);
      margin-bottom: var(--space-xs);
    }

    .stat-value {
      font-size: 1.8rem;
      font-weight: 600;
      color: var(--color-dark);
    }

    .stat-label {
      font-size: 0.85rem;
      color: var(--color-secondary);
      margin-top: var(--space-xs);
    }

    .charts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: var(--space-md);
      margin-bottom: var(--space-xl);
    }

    .chart-card {
      background: var(--color-light);
      border-radius: var(--radius-lg);
      padding: var(--space-md);
      box-shadow: var(--shadow-subtle);
    }

    .chart-card.full-width {
      grid-column: 1 / -1;
    }

    .chart-title {
      font-size: 1.1rem;
      font-weight: 500;
      color: var(--color-dark);
      margin-bottom: var(--space-md);
      display: flex;
      align-items: center;
      gap: var(--space-xs);
    }

    .chart-container {
      position: relative;
      height: 300px;
    }

    .accordion {
      margin-bottom: var(--space-lg);
    }

    .accordion-item {
      background: var(--color-light);
      border-radius: var(--radius-md);
      margin-bottom: var(--space-sm);
      overflow: hidden;
      box-shadow: var(--shadow-subtle);
    }

    .accordion-header {
      padding: var(--space-md);
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background 0.3s;
    }

    .accordion-header:hover {
      background: var(--color-primary);
    }

    .accordion-header h3 {
      font-size: 1.1rem;
      font-weight: 500;
      color: var(--color-dark);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }

    .accordion-icon {
      color: var(--color-accent);
      transition: transform 0.3s;
    }

    .timeline-list {
      display: flex;
      flex-direction: column;
      gap: var(--space-md);
    }

    .timeline-city-card {
      background: var(--color-light);
      padding: var(--space-md);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-subtle);
    }

    .timeline-city-card h3 {
      margin-bottom: var(--space-sm);
    }

    .timeline-city-card p {
      margin-bottom: var(--space-xs);
      color: var(--color-secondary);
    }

    .accordion-item.active .accordion-icon {
      transform: rotate(180deg);
    }

    .accordion-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .accordion-item.active .accordion-content {
      max-height: 5000px;
    }

    .accordion-body {
      padding: var(--space-md);
      border-top: 1px solid var(--color-neutral);
    }

    .activity-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: var(--space-md);
      margin-top: var(--space-md);
    }

    .activity-card {
      background: var(--color-primary);
      padding: var(--space-md);
      border-radius: var(--radius-md);
      border-left: 4px solid var(--color-accent);
    }

    .activity-card h4 {
      font-size: 1rem;
      font-weight: 500;
      color: var(--color-dark);
      margin-bottom: var(--space-xs);
    }

    .activity-card p {
      font-size: 0.9rem;
      color: var(--color-secondary);
      margin-bottom: var(--space-xs);
    }

    .activity-card .cost {
      font-weight: 600;
      color: var(--color-accent);
    }

    .activity-card .type-badge {
      display: inline-block;
      padding: 4px var(--space-xs);
      background: var(--color-accent);
      color: white;
      border-radius: var(--radius-sm);
      font-size: 0.75rem;
      margin-top: var(--space-xs);
    }

    .booking-links {
      font-size: 0.85rem;
      margin-top: var(--space-sm);
    }

    .booking-link {
      color: var(--color-accent);
      text-decoration: none;
      font-weight: 500;
    }

    .booking-link:hover {
      text-decoration: underline;
    }

    .skill-icons {
      display: inline-flex;
      gap: 6px;
      margin-left: 8px;
      align-items: center;
    }

    .skill-icon-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: white;
      border: 1px solid var(--color-neutral);
      color: white;
      text-decoration: none;
      transition: transform 0.2s, box-shadow 0.2s;
      font-size: 0.7rem;
    }

    .skill-icon-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }

    .skill-icon-btn.google-maps {
      background: #4285F4;
    }

    .skill-icon-btn.gaode-maps {
      background: #00A862;
    }

    .skill-icon-btn.rednote {
      background: #FF2442;
    }

    .skill-icon-btn.airbnb {
      background: #FF5A5F;
    }

    footer {
      text-align: center;
      padding: var(--space-xl) 0;
      color: var(--color-secondary);
      font-size: 0.85rem;
    }

    @media (max-width: 768px) {
      .container {
        padding: var(--space-sm);
      }

      header h1 {
        font-size: 1.8rem;
      }

      .charts-grid {
        grid-template-columns: 1fr;
      }

      .chart-container {
        height: 250px;
      }

      .activity-grid {
        grid-template-columns: 1fr;
      }

      .tabs {
        gap: var(--space-xs);
      }

      .tab {
        padding: var(--space-xs) var(--space-sm);
        font-size: 0.9rem;
      }
    }

    @media (max-width: 320px) {
      header h1 {
        font-size: 1.5rem;
      }

      .stat-value {
        font-size: 1.5rem;
      }
    }

    .detail-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(74, 63, 53, 0.4);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
      z-index: 999;
    }

    .detail-overlay.open {
      opacity: 1;
      visibility: visible;
    }

    .detail-panel {
      position: fixed;
      top: 0;
      right: -500px;
      width: 500px;
      height: 100vh;
      background: var(--color-light);
      box-shadow: -4px 0 20px rgba(74, 63, 53, 0.2);
      transition: right 0.3s ease;
      z-index: 1000;
      overflow-y: auto;
    }

    .detail-panel.open {
      right: 0;
    }

    .detail-panel-header {
      position: sticky;
      top: 0;
      background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-secondary) 100%);
      color: white;
      padding: var(--space-md);
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: var(--shadow-medium);
    }

    .detail-panel-title {
      font-size: 1.2rem;
      font-weight: 500;
    }

    .detail-panel-close {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0.25rem 0.5rem;
      border-radius: var(--radius-sm);
      transition: background 0.2s;
    }

    .detail-panel-close:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .detail-panel-content {
      padding: var(--space-md);
    }

    @media (max-width: 768px) {
      .detail-panel {
        width: 100vw;
        right: -100vw;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1 id="trip-title">Loading...</h1>
      <div class="subtitle" id="trip-meta"></div>
    </header>

    <div class="tabs" id="tabs-container"></div>

    <div id="overview-tab" class="tab-content active">
      <div class="stats-grid" id="stats-container"></div>
      <div class="charts-grid" id="charts-container"></div>
    </div>

    <div id="cities-tab" class="tab-content">
      <div class="accordion" id="cities-accordion"></div>
    </div>

    <div id="budget-tab" class="tab-content">
      <div class="charts-grid" id="budget-charts"></div>
    </div>

    <div id="timeline-tab" class="tab-content">
      <div id="timeline-container"></div>
    </div>

    <footer>
      <p>Generated on 2026-02-02 20:28 | Travel Planner Dashboard</p>
    </footer>
  </div>

  <div class="detail-overlay" id="detail-overlay" onclick="closeDetailPanel()"></div>

  <div class="detail-panel" id="detail-panel">
    <div class="detail-panel-header">
      <div class="detail-panel-title" id="detail-panel-title">Details</div>
      <button class="detail-panel-close" onclick="closeDetailPanel()">&times;</button>
    </div>
    <div class="detail-panel-content" id="detail-panel-content">
    </div>
  </div>

  <script>
    const PLAN_DATA = {"trip_summary": {"dates": "2026-02-15 to 2026-03-07", "duration_days": 21, "travelers": "2 adults (couple)", "budget": "\u20ac1,000 total (excluding purchased flights and shopping)", "preferences": {"accommodation": "mix of hotels and family home stays", "dietary": "no restrictions", "pace": "moderate with family time, busy girlfriend schedule in Beijing", "special_notes": "Girlfriend Chinese level A1, historical/cultural interest low but open, loves cute things (\u6f6e\u73a9\u5e97), photography, cozy coffee shops, English bookstores"}}, "days": [{"day": 1, "date": "2026-02-15", "location": "Chongqing", "location_change": null, "user_requirements": ["Arrive 4:40am at Chongqing Jiangbei T3 (flight HU718 from Paris CDG T1)", "Check luggage at Raffles City InterContinental", "Visit Raffles City observation deck", "Have breakfast at Raffles City after observation deck", "Visit Huguang Guild Hall", "Lunch (no hotpot - saving for dinner)", "Afternoon: Xiayao Li + Longmenhao area (including \u71b9\u73a5\u76d2\u5b50 in Xiayao Li)", "Optional: Liziba or Hongyadong", "Evening: Hotpot at hillside restaurant with Chongqing night view (\u5357\u5c71\u534a\u5c71\u8170 - NOT riverside, must be elevated view)", "After dinner: Massage at fancy spa near hotel", "Check in to Raffles City InterContinental"], "breakfast": {"name": "Raffles City Mall Food Court", "location": "Raffles City Chongqing, Jiesheng Street 8", "cost": 15, "cuisine": "Mixed Chinese", "notes": "Breakfast after observation deck visit. Multiple options available in mall food court. Convenient location."}, "lunch": {"name": "Ju Fa Cai Chongqing Jianghu Cuisine", "location": "Daxi Lane 28, Yuzhong District (near Huguang Guild Hall)", "cost": 30, "cuisine": "Chongqing Jianghu", "notes": "NO HOTPOT (saving for dinner). Authentic Jianghu dishes near Huguang Guild Hall. Popular local restaurant."}, "dinner": {"name": "Qu Nanshan Yeqing Huoguo Gongyuan", "location": "Nanshan Street, Zhenwu Mountain 88, Nanshan", "cost": 50, "cuisine": "Chongqing Hotpot", "notes": "HILLSIDE HOTPOT WITH NIGHT VIEW (\u5357\u5c71\u534a\u5c71\u8170). Elevated location with panoramic Chongqing night view. Reservations recommended."}, "accommodation": {"name": "InterContinental Chongqing Raffles City", "location": "NO. 2 Yangtze River Binjiang Road, Yuzhong District, Chongqing, China, 400010", "coordinates": {"lat": 29.56469999999999, "lng": 106.5507}, "cost": 90, "type": "Hotel", "amenities": ["WiFi", "Breakfast buffet (CNY 228/adult)", "River views", "Luggage storage", "In-building observation deck", "Spa services"], "rating": 4.7, "check_in": "14:00", "check_out": "12:00", "notes": "Luxury 5-star hotel in Raffles City complex. Check luggage early morning (4:40am arrival). Visit observation deck before breakfast. Rate estimated at \u20ac80-100/night"}, "attractions": [{"name": "Raffles City Chongqing Observation Deck (\u6765\u798f\u58eb\u89c2\u666f\u53f0)", "location": "Raffles City InterContinental, Chaotianmen", "cost": 30, "duration_minutes": 60, "type": "Observation Deck", "notes": "Morning visit after luggage check-in. Panoramic views of Yangtze and Jialing rivers confluence. Breakfast at Raffles City after visit."}, {"name": "Huguang Guild Hall (\u6e56\u5e7f\u4f1a\u9986)", "location": "Changjiang Binjiang Road, Bajiaoyuan No.1", "cost": 30, "duration_minutes": 90, "type": "Historical Site", "notes": "Traditional Qing dynasty guild hall with ornate architecture. Located near river area, easy access from Raffles City."}, {"name": "Xiayao Li (\u4e0b\u6d69\u91cc) & Longmenhao Old Street (\u9f99\u95e8\u6d69\u8001\u8857)", "location": "Nanbin Road 105, near Shangxinjie Metro Station", "cost": 0, "duration_minutes": 120, "type": "Historical Street District", "notes": "Afternoon visit. Historic riverside neighborhood with cafes, bookstores, and \u71b9\u73a5\u76d2\u5b50. Free entry, great for photography and leisurely strolling. Adjacent areas within walking distance."}, {"name": "Liziba Station (\u674e\u5b50\u575d\u5355\u8f68\u7a7f\u697c) - Optional", "location": "Liziba Zheng Street 62, Liziba Metro Station Exit 1", "cost": 0, "duration_minutes": 30, "type": "Urban Landmark", "notes": "Optional if time permits. Famous monorail station where train passes through building. Viewing platform available. Free attraction."}, {"name": "Hongyadong (\u6d2a\u5d16\u6d1e\u6c11\u4fd7\u98ce\u8c8c\u533a) - Optional", "location": "Jialing River Binjiang Road 88", "cost": 0, "duration_minutes": 45, "type": "Scenic Area", "notes": "Optional evening visit before hotpot dinner. Best viewed at night when illuminated. Can be crowded. Free entry."}], "entertainment": [{"name": "Mu Qian Yang Sheng SPA (\u6155\u5aa4\u517b\u751fSPA)", "location": "Jiefangbei, Yuzhong District, Bayi Road 181, basement floor (below Mercure Hotel)", "cost": 400, "time": "22:00", "type": "Spa/Massage", "notes": "High-end spa near Raffles City for post-dinner relaxation. Book in advance. Session duration: 90-120 minutes. Walking distance from hotel."}, {"name": "KOH Thai Spa (\u66b9\u7f57\u4e4b\u5c7f\u6cf0\u5f0f\u6309\u6469\u8db3\u7597)", "location": "Jiefangbei, Yuzhong District, Bayi Road 238, Bayi Square F6", "cost": 350, "time": "22:00", "type": "Spa/Massage", "notes": "Alternative to Mu Qian. Thai massage specialty. Near Liberation Monument area. Book in advance for evening slots."}], "shopping": [], "free_time": [], "timeline": {"Flight arrival HU718": {"start_time": "04:40", "end_time": "05:40", "duration_minutes": 60}, "Airport to Raffles City InterContinental": {"start_time": "05:40", "end_time": "06:50", "duration_minutes": 70}, "Luggage check-in and rest": {"start_time": "06:50", "end_time": "08:00", "duration_minutes": 70}, "Raffles City Chongqing Observation Deck (\u6765\u798f\u58eb\u89c2\u666f\u53f0)": {"start_time": "08:00", "end_time": "09:00", "duration_minutes": 60}, "Raffles City Mall Food Court": {"start_time": "09:00", "end_time": "09:45", "duration_minutes": 45}, "Travel to Huguang Guild Hall": {"start_time": "09:45", "end_time": "10:15", "duration_minutes": 30}, "Huguang Guild Hall (\u6e56\u5e7f\u4f1a\u9986)": {"start_time": "10:15", "end_time": "11:45", "duration_minutes": 90}, "Travel to lunch location": {"start_time": "11:45", "end_time": "12:00", "duration_minutes": 15}, "Ju Fa Cai Chongqing Jianghu Cuisine": {"start_time": "12:00", "end_time": "13:30", "duration_minutes": 90}, "Travel to Xiayao Li": {"start_time": "13:30", "end_time": "14:00", "duration_minutes": 30}, "Xiayao Li (\u4e0b\u6d69\u91cc) & Longmenhao Old Street (\u9f99\u95e8\u6d69\u8001\u8857)": {"start_time": "14:00", "end_time": "16:00", "duration_minutes": 120}, "Liziba Station (\u674e\u5b50\u575d\u5355\u8f68\u7a7f\u697c) - Optional": {"start_time": "16:00", "end_time": "16:30", "duration_minutes": 30}, "Travel to Nanshan": {"start_time": "16:30", "end_time": "17:15", "duration_minutes": 45}, "Hongyadong (\u6d2a\u5d16\u6d1e\u6c11\u4fd7\u98ce\u8c8c\u533a) - Optional": {"start_time": "17:15", "end_time": "18:00", "duration_minutes": 45}, "Qu Nanshan Yeqing Huoguo Gongyuan": {"start_time": "18:30", "end_time": "20:30", "duration_minutes": 120}, "Travel to spa": {"start_time": "20:30", "end_time": "21:00", "duration_minutes": 30}, "Mu Qian Yang Sheng SPA (\u6155\u5aa4\u517b\u751fSPA)": {"start_time": "21:00", "end_time": "23:00", "duration_minutes": 120}, "Return to hotel and check-in": {"start_time": "23:00", "end_time": "23:30", "duration_minutes": 30}}, "budget": {"meals": 12.35, "accommodation": 90, "activities": 3.9, "shopping": 0, "transportation": 0, "total": 106.25}}, {"day": 2, "date": "2026-02-16", "location": "Bazhong", "location_change": {"from": "Chongqing", "to": "Bazhong", "from_location": "Raffles City InterContinental, Chongqing", "to_location": "Family home (\u534a\u5c71\u9038\u57ceA\u533a35\u5e621902), Bazhong", "transportation": "High-speed train (C-series or D-series)", "route_details": {"departure_station": "Chongqing North Station (\u91cd\u5e86\u5317\u7ad9)", "arrival_station": "Bazhong East Station (\u5df4\u4e2d\u4e1c\u7ad9) or Bazhong West Station (\u5df4\u4e2d\u897f\u7ad9)", "recommended_trains": [{"train_number": "C67", "departure_time": "Early morning departure (exact time TBD)", "arrival_time": "TBD", "duration_minutes": 200, "stops": "Via Hechuan, Wusheng, Nanchong North, Yilong", "cost_cny": 60, "cost_usd": 8.5, "seat_class": "Second class", "notes": "C67 typically departs from Chongqing Jiangbei Airport at 14:38, but early morning schedule needs verification"}, {"train_number": "D2247", "departure_time": "Early morning (exact time TBD)", "arrival_time": "TBD", "duration_minutes": 247, "stops": "Via Hechuan, Nanchong North", "cost_cny": 80, "cost_usd": 11, "seat_class": "Second class estimated", "notes": "D2247 is a long-distance train from Hangzhou East to Chongqing North; may pass through Bazhong area but requires verification"}]}, "departure_time": "07:00", "arrival_time": "10:07", "duration_minutes": 187, "cost": 11, "booking_required": true, "booking_urgency": "HIGH - Spring Festival travel period, book immediately via 12306", "data_source": "gaode_maps + websearch", "notes": "URGENT BOOKING REQUIRED. Spring Festival travel period (\u6625\u8fd0) means trains sell out quickly. User specified 7am departure. Must verify exact train schedule on 12306 for 2026-02-16. Distance: 269km. Alternative route via Chongqing Jiangbei Airport to Bazhong East. Consider K26 bus from Bazhong East Station to family home (17km, 48 mins). Allow 1 hour buffer at Chongqing North Station for luggage and boarding."}, "user_requirements": ["Early morning 7am high-speed train to Bazhong (train not booked yet)", "Afternoon: Spend time with family at home (\u534a\u5c71\u9038\u57ceA\u533a35\u5e621902)", "Evening: Chinese New Year celebration with family"], "breakfast": {"name": "Family Home", "location": "Banshan Yicheng A District, Building 35, Unit 1902", "cost": 0, "cuisine": "Homemade", "notes": "Breakfast with family at home. Chinese New Year Eve preparations."}, "lunch": {"name": "Family Home", "location": "Banshan Yicheng A District, Building 35, Unit 1902", "cost": 0, "cuisine": "Homemade", "notes": "Family lunch. Chinese New Year Eve gathering."}, "dinner": {"name": "Family Home - Chinese New Year Eve Dinner", "location": "Banshan Yicheng A District, Building 35, Unit 1902", "cost": 0, "cuisine": "Traditional Sichuan", "notes": "Chinese New Year Eve celebration dinner with family. Traditional reunion feast."}, "accommodation": {"name": "Family Home", "location": "\u534a\u5c71\u9038\u57ceA\u533a35\u5e621902, Bazhong, Sichuan Province", "cost": 0, "type": "Family Home", "amenities": ["Private residence", "Family hospitality", "Home-cooked meals"], "check_in": "Afternoon (after train arrival)", "check_out": "Morning Feb 17", "notes": "Chinese New Year celebration with family. No cost. Staying with family"}, "attractions": [], "entertainment": [], "shopping": [], "free_time": [], "timeline": {"Hotel check-out": {"start_time": "06:00", "end_time": "06:30", "duration_minutes": 30}, "Travel to Chongqing North Station": {"start_time": "06:30", "end_time": "07:00", "duration_minutes": 30}, "High-speed train (C-series or D-series)": {"start_time": "07:00", "end_time": "10:07", "duration_minutes": 187}, "Travel to family home": {"start_time": "10:07", "end_time": "11:00", "duration_minutes": 53}, "Family Home": {"start_time": "11:30", "end_time": "13:00", "duration_minutes": 90}, "Afternoon family time": {"start_time": "13:00", "end_time": "17:30", "duration_minutes": 270}, "Family Home - Chinese New Year Eve Dinner": {"start_time": "17:30", "end_time": "20:00", "duration_minutes": 150}, "Chinese New Year celebration with family": {"start_time": "20:00", "end_time": "23:00", "duration_minutes": 180}}, "budget": {"meals": 0, "accommodation": 0, "activities": 0, "shopping": 0, "transportation": 11, "total": 11}}, {"day": 3, "date": "2026-02-17", "location": "Chengdu", "location_change": {"from": "Bazhong", "to": "Chengdu", "from_location": "Family home (\u534a\u5c71\u9038\u57ceA\u533a35\u5e621902), Bazhong", "to_location": "Home stay (\u897f\u9526\u56fd\u9645\u4e8c\u671f\u56db\u5e62\u56db\u5355\u51431902 / \u82b1\u724c\u574a\u5317\u885799\u53f7), Chengdu", "transportation": "High-speed train (D-series or C-series)", "route_details": {"departure_station": "Bazhong East Station (\u5df4\u4e2d\u4e1c\u7ad9)", "arrival_station": "Chengdu East Station (\u6210\u90fd\u4e1c\u7ad9)", "recommended_trains": [{"train_number": "D5121", "departure_time": "12:26", "arrival_time": "~16:08", "duration_minutes": 222, "stops": "Via Bazhong West, Yilong, Nanchong North", "cost_cny": 113, "cost_usd": 16, "seat_class": "Second class", "notes": "Afternoon departure after lunch at \u8001\u4e03\u725b\u8089. Journey time ~3.5 hours. Fastest option."}, {"train_number": "C69", "departure_time": "19:09", "arrival_time": "22:36", "duration_minutes": 207, "stops": "Via Bazhong West, Ma'an, Yilong, Nanchong North, Suining", "cost_cny": 113, "cost_usd": 16, "seat_class": "Second class", "notes": "Evening departure. Too late for user's itinerary (need to stroll Taikoo Li in evening)"}, {"train_number": "C39", "departure_time": "Afternoon (exact time TBD)", "arrival_time": "TBD", "duration_minutes": 180, "stops": "TBD", "cost_cny": 113, "cost_usd": 16, "seat_class": "Second class", "notes": "Alternative afternoon option, verify schedule on 12306"}]}, "departure_time": "12:26", "arrival_time": "16:08", "duration_minutes": 222, "cost": 16, "booking_required": true, "booking_urgency": "HIGH - Spring Festival travel period, book immediately via 12306", "data_source": "gaode_maps + websearch", "notes": "URGENT BOOKING REQUIRED. Spring Festival travel period. User plans lunch at \u8001\u4e03\u725b\u8089 before departure. Recommended D5121 at 12:26 allows time for lunch and family goodbyes. Distance: 392km. Arrival at Chengdu East allows subway transfer (Line 7) to Taikoo Li area for evening stroll. Book K26 bus from family home to Bazhong East Station (depart ~10:45am for 12:26 train)."}, "user_requirements": ["Morning: Breakfast at \u8001\u4e94\u9171\u8089\u5305\u5b50 (most authentic Bazhong breakfast)", "Morning: Pack and say goodbye to family", "Noon: Lunch at \u8001\u4e03\u725b\u8089", "After lunch: High-speed train to Chengdu (train not booked yet)", "Evening: Arrive Chengdu, stroll Taikoo Li", "Stay at home (\u897f\u9526\u56fd\u9645\u4e8c\u671f\u56db\u5e62\u56db\u5355\u51431902 / \u82b1\u724c\u574a\u5317\u885799\u53f7)"], "breakfast": {"name": "Lao Wu Jiangrou Baozi", "location": "Bazhong City Center", "cost": 5, "cuisine": "Bazhong Specialty", "notes": "MUST-VISIT: Most authentic Bazhong breakfast. Famous sauce meat buns (\u9171\u8089\u5305\u5b50). User-specified restaurant."}, "lunch": {"name": "Lao Qi Niurou", "location": "Bazhong City Center", "cost": 20, "cuisine": "Sichuan Beef", "notes": "MUST-VISIT: Famous for Bazhong-style beef dishes. User-specified restaurant before train departure."}, "dinner": {"name": "Taolin Restaurant (Taikoo Li Tianxianqiao Store)", "location": "Dacisi Tianxianqiao North Road 3, SOHO Building 1F, Taikoo Li", "cost": 40, "cuisine": "Sichuan Fusion", "notes": "Evening arrival in Chengdu. Located in Taikoo Li area. Modern Sichuan cuisine. One of 3 required Chengdu restaurants."}, "accommodation": {"name": "Family Home", "location": "\u897f\u9526\u56fd\u9645\u4e8c\u671f\u56db\u5e62\u56db\u5355\u51431902 (alternate address: \u82b1\u724c\u574a\u5317\u885799\u53f7), Jinniu District, Chengdu, Sichuan Province", "coordinates": {"lat": 30.681863, "lng": 104.046613}, "cost": 0, "type": "Family Home", "amenities": ["Private residence", "Central location near Taikoo Li"], "check_in": "Evening (after train from Bazhong)", "check_out": "Morning Feb 18 (early for panda base visit)", "notes": "One night stay at family home in Chengdu. No cost. Convenient for early morning panda base visit"}, "attractions": [{"name": "Nankangpo (\u5357\u9f9b\u5761) OR Wangwangshan (\u671b\u738b\u5c71)", "location": "Bazhong city area", "cost": 0, "duration_minutes": 90, "type": "City Park / Viewpoint", "notes": "Morning visit before leaving Bazhong. Wangwangshan has Xianzong Observation Platform (\u671b\u738b\u5c71\u4ed9\u8e2a\u89c2\u666f\u53f0) with city views. Nankangpo is scenic hillside area. Both free. Choose based on weather and time availability."}, {"name": "Chengdu Taikoo Li (\u6210\u90fd\u592a\u53e4\u91cc)", "location": "Zhong Shamao Street 8, Chunxi Road area", "cost": 0, "duration_minutes": 90, "type": "Shopping District", "notes": "Evening stroll after arriving in Chengdu. Modern lifestyle district with boutiques, cafes, and restaurants. Perfect for orientation walk and dinner area exploration."}], "entertainment": [], "shopping": [{"name": "Chengdu Taikoo Li (\u6210\u90fd\u8fdc\u6d0b\u592a\u53e4\u91cc)", "location": "\u4e2d\u7eb1\u5e3d\u88578\u53f7, Jinjiang District, Chengdu", "cost": 150, "type": "Shopping Complex", "notes": "Evening stroll location. Mix of luxury brands and trendy boutiques. Open-air design, great atmosphere. Open until 10pm. Home to fashion retailers, lifestyle stores, and specialty shops."}], "free_time": [], "timeline": {"Lao Wu Jiangrou Baozi": {"start_time": "07:30", "end_time": "08:15", "duration_minutes": 45}, "Nankangpo (\u5357\u9f9b\u5761) OR Wangwangshan (\u671b\u738b\u5c71)": {"start_time": "08:15", "end_time": "09:45", "duration_minutes": 90}, "Return to family home and pack": {"start_time": "09:45", "end_time": "10:45", "duration_minutes": 60}, "Travel to restaurant": {"start_time": "10:45", "end_time": "11:00", "duration_minutes": 15}, "Lao Qi Niurou": {"start_time": "11:00", "end_time": "12:00", "duration_minutes": 60}, "Travel to Bazhong East Station": {"start_time": "12:00", "end_time": "12:26", "duration_minutes": 26}, "High-speed train (D-series or C-series)": {"start_time": "12:26", "end_time": "16:08", "duration_minutes": 222}, "Travel to family home in Chengdu": {"start_time": "16:08", "end_time": "17:00", "duration_minutes": 52}, "Rest at home": {"start_time": "17:00", "end_time": "18:00", "duration_minutes": 60}, "Taolin Restaurant (Taikoo Li Tianxianqiao Store)": {"start_time": "18:00", "end_time": "19:30", "duration_minutes": 90}, "Chengdu Taikoo Li (\u6210\u90fd\u592a\u53e4\u91cc)": {"start_time": "19:30", "end_time": "21:00", "duration_minutes": 90}, "Return to family home": {"start_time": "21:00", "end_time": "21:30", "duration_minutes": 30}}, "budget": {"meals": 8.45, "accommodation": 0, "activities": 0, "shopping": 19.5, "transportation": 16, "total": 43.95}}, {"day": 4, "date": "2026-02-18", "location": "Shanghai", "location_change": {"from": "Chengdu", "to": "Shanghai", "from_location": "Home stay (\u897f\u9526\u56fd\u9645\u4e8c\u671f\u56db\u5e62\u56db\u5355\u51431902), Chengdu", "to_location": "SK Luxury Hotel (\u5916\u6ee9SK\u7b80\u5962\u00b7\u9005\u7199\u9152\u5e97), Shanghai", "transportation": "Flight (ALREADY BOOKED)", "route_details": {"flight_number": "CA4509", "airline": "Air China", "departure_airport": "Chengdu Shuangliu International Airport (CTU)", "departure_terminal": "Terminal 2", "arrival_airport": "Shanghai Pudong International Airport (PVG)", "arrival_terminal": "Terminal 2"}, "departure_time": "14:35", "arrival_time": "17:20", "flight_duration_minutes": 165, "total_journey_minutes": 285, "cost": 0, "booking_required": false, "booking_status": "CONFIRMED - Flight already booked", "data_source": "user_provided", "notes": "Flight ALREADY BOOKED. Departure 14:35, arrival 17:20. Total journey ~4h 45min including airport transfers. Morning activities: Giant Panda Base (9:00-10:00), Jinli Ancient Street, Chengdu restaurants (\u660e\u5a77\u996d\u5e97, \u725b\u4e1e\u4e1e, \u9955\u6797). Must leave for airport by 12:00 to allow 2.5h buffer (recommended for domestic flights). Panda Base to Shuangliu Airport: ~1h by subway/taxi. Shanghai Pudong T2 to hotel: ~1.5h by metro (Line 2). Evening hotel check-in at SK Luxury Hotel."}, "user_requirements": ["9:00am: Arrive at Giant Panda Base", "10:00am: Leave panda base (1 hour visit)", "Visit Jinli Ancient Street", "Must cover all Chengdu restaurants: \u660e\u5a77\u996d\u5e97, \u725b\u4e1e\u4e1e (\u548c\u725b), \u9955\u6797", "Afternoon flight CA4509 from Chengdu Shuangliu 14:35 to Shanghai Pudong T2 17:20", "Evening: Check in to SK Luxury Hotel (\u5916\u6ee9SK\u7b80\u5962\u00b7\u9005\u7199\u9152\u5e97 Nanjing Road branch)"], "breakfast": {"name": "Mingting Restaurant", "location": "Wai Caojiaxiang 26, Unit 15, Chengdu (near Hongxingqiao Metro)", "cost": 25, "cuisine": "Sichuan Home-style", "notes": "MUST-VISIT (1/3): User-specified restaurant. Authentic Chengdu flavors. Popular local eatery. Visit before panda base."}, "lunch": {"name": "Niuchengcheng Wagyu Restaurant", "location": "Taikoo Li or Jinli Ancient Street area, Chengdu", "cost": 60, "cuisine": "Japanese Wagyu", "notes": "MUST-VISIT (2/3): User-specified restaurant. High-quality wagyu beef. Visit after panda base, before flight."}, "dinner": {"name": "Taolin Restaurant (multiple branches available)", "location": "Near SK Luxury Hotel, Shanghai Nanjing Road", "cost": 45, "cuisine": "Sichuan Fusion", "notes": "MUST-VISIT (3/3): Final required Chengdu restaurant visit. Late arrival in Shanghai (17:20 flight), dinner near hotel."}, "accommodation": {"name": "Shanghai SK Lusso Hotel (SK\u7b80\u5962\u00b7\u9005\u7199\u9152\u5e97)", "location": "Zone G, Shanghai Keji Jingcheng, No. 668 Beijing East Road, Huangpu District, Shanghai (\u5357\u4eac\u8def\u6b65\u884c\u8857\u5e97)", "cost": 75, "type": "Hotel", "amenities": ["WiFi", "Breakfast included", "Near Nanjing Road Pedestrian Street", "Walking distance to The Bund", "Luggage storage", "Wake-up service"], "rating": 4.5, "check_in": "14:00", "check_out": "12:00", "notes": "Boutique mid-range hotel. Excellent location for Shanghai city center exploration. Recent reviews praise comfortable beds and helpful staff. Rate estimated at \u20ac65-85/night"}, "attractions": [{"name": "Chengdu Giant Panda Breeding Research Base (\u6210\u90fd\u5927\u718a\u732b\u7e41\u80b2\u7814\u7a76\u57fa\u5730)", "location": "Xiongmao Avenue 1375, North Third Ring Road", "cost": 55, "duration_minutes": 60, "type": "Wildlife Park", "notes": "Arrive 9:00am, leave by 10:00am as planned. Early morning is best time to see pandas active. Book tickets online in advance. Take Metro Line 3 to Xiongmao Avenue Station. Limited 1-hour visit due to afternoon flight."}, {"name": "Jinli Ancient Street (\u9526\u91cc\u53e4\u8857)", "location": "Wuhou Temple Street 231, Wuhou District", "cost": 0, "duration_minutes": 60, "type": "Historical Street", "notes": "Quick visit before flight. Traditional Qing dynasty style street with snacks and crafts. Free entry. Close to city center, easy access before heading to airport."}], "entertainment": [], "shopping": [], "free_time": [], "timeline": {"Mingting Restaurant": {"start_time": "07:00", "end_time": "08:00", "duration_minutes": 60}, "Travel to Giant Panda Base": {"start_time": "08:00", "end_time": "09:00", "duration_minutes": 60}, "Chengdu Giant Panda Breeding Research Base (\u6210\u90fd\u5927\u718a\u732b\u7e41\u80b2\u7814\u7a76\u57fa\u5730)": {"start_time": "09:00", "end_time": "10:00", "duration_minutes": 60}, "Travel to Jinli Ancient Street": {"start_time": "10:00", "end_time": "10:30", "duration_minutes": 30}, "Jinli Ancient Street (\u9526\u91cc\u53e4\u8857)": {"start_time": "10:30", "end_time": "11:30", "duration_minutes": 60}, "Niuchengcheng Wagyu Restaurant": {"start_time": "11:30", "end_time": "12:30", "duration_minutes": 60}, "Travel to airport": {"start_time": "12:30", "end_time": "13:30", "duration_minutes": 60}, "Airport check-in and security": {"start_time": "13:30", "end_time": "14:35", "duration_minutes": 65}, "Flight (ALREADY BOOKED)": {"start_time": "14:35", "end_time": "17:20", "duration_minutes": 165}, "Travel to SK Luxury Hotel": {"start_time": "17:20", "end_time": "18:50", "duration_minutes": 90}, "Hotel check-in and rest": {"start_time": "18:50", "end_time": "19:30", "duration_minutes": 40}, "Taolin Restaurant (multiple branches available)": {"start_time": "19:30", "end_time": "21:00", "duration_minutes": 90}, "Return to hotel": {"start_time": "21:00", "end_time": "21:30", "duration_minutes": 30}}, "budget": {"meals": 16.9, "accommodation": 75, "activities": 7.15, "shopping": 0, "transportation": 0, "total": 99.05}}, {"day": 5, "date": "2026-02-19", "location": "Shanghai", "location_change": null, "user_requirements": ["Explore Shanghai city center", "Pass by People's Square (brief stop)", "Visit the Bund", "Consider Pudong Art Museum", "Explore niche fancy INFJ-friendly spots", "Dining: One Michelin restaurant, \u4eba\u548c\u9986 (Michelin-recommended local cuisine), or Ajiya (Japanese yakiniku)"], "breakfast": {"name": "Hotel Breakfast or Local Cafe", "location": "Near SK Luxury Hotel, Nanjing Road", "cost": 20, "cuisine": "Western/Chinese", "notes": "Breakfast near hotel before exploring city center. Nanjing Road has many options."}, "lunch": {"name": "Renheguan (Zaojiabang Road Branch)", "location": "Zaojiabang Road 407, Xuhui District (near Jiash\u0430\u043d\u044c Road Metro)", "cost": 35, "cuisine": "Shanghai Benbang", "notes": "MICHELIN-RECOMMENDED: Authentic Shanghai local cuisine (\u672c\u5e2e\u83dc). Famous for classic dishes. Near People's Square."}, "dinner": {"name": "AJIYA Charcoal Grill (Jing'an Branch)", "location": "Jiangning Road 445, Shimei Building 402, Jing'an District", "cost": 80, "cuisine": "Japanese Yakiniku", "notes": "USER-SPECIFIED: Premium Japanese yakiniku. High-quality grilled meats. Reservations strongly recommended."}, "accommodation": {"name": "Shanghai SK Lusso Hotel (SK\u7b80\u5962\u00b7\u9005\u7199\u9152\u5e97)", "location": "Zone G, Shanghai Keji Jingcheng, No. 668 Beijing East Road, Huangpu District, Shanghai (\u5357\u4eac\u8def\u6b65\u884c\u8857\u5e97)", "cost": 75, "type": "Hotel", "amenities": ["WiFi", "Breakfast included", "Near Nanjing Road Pedestrian Street", "Walking distance to The Bund", "Luggage storage", "Wake-up service"], "rating": 4.5, "check_in": "Previous day", "check_out": "12:00", "notes": "Second night at same hotel. No check-in required"}, "attractions": [{"name": "The Bund (\u5916\u6ee9)", "location": "Zhongshan East Road No.1, Huangpu District", "cost": 0, "duration_minutes": 120, "type": "Waterfront Promenade", "notes": "Iconic Shanghai skyline views across Huangpu River. Historic colonial buildings on west side, Pudong skyscrapers on east. Best in morning or evening. Walking promenade with observation decks. Free entry."}, {"name": "People's Square (\u4eba\u6c11\u5e7f\u573a) - Brief Stop", "location": "Renmin Avenue 185, Huangpu District", "cost": 0, "duration_minutes": 30, "type": "City Square", "notes": "Brief stop as requested. Central location with fountain. Good for orientation. Near Shanghai Museum if interested. Free."}, {"name": "Pudong Art Museum (\u6d66\u4e1c\u7f8e\u672f\u9986)", "location": "Binjiang Avenue 2777, Pudong District", "cost": 60, "duration_minutes": 120, "type": "Art Museum", "notes": "Consider if interested in contemporary art. Waterfront location near Lujiazui. Rotating exhibitions. Quiet, INFJ-friendly atmosphere. Book tickets online."}, {"name": "Niche INFJ-Friendly Spots", "location": "Various locations in French Concession and Jing'an areas", "cost": 0, "duration_minutes": 180, "type": "Lifestyle Exploration", "notes": "Explore quiet cafes, boutique bookstores, and art galleries in former French Concession area. Ferguson Lane, Anfu Road, and Xintiandi are good areas. More recommendations in meals and shopping agents."}], "entertainment": [{"name": "Caf\u00e9 del Volc\u00e1n", "location": "Xuhui District (specific address requires verification)", "cost": 40, "time": "14:00", "type": "Coffee Shop", "notes": "Specialty coffee spot with French-inspired exterior. Known for freshly roasted beans and finest coffee in Shanghai. Pairs well with Xuhui area exploration."}, {"name": "Seesaw Coffee", "location": "Jing'an District (multiple locations)", "cost": 35, "time": "15:00", "type": "Coffee Shop", "notes": "Pioneer of specialty coffee in China. Sources beans from Yunnan. Modern atmosphere suitable for INFJ preferences."}, {"name": "Single Origin Roasters", "location": "Address requires verification", "cost": 30, "time": "16:00", "type": "Coffee Shop", "notes": "Specializes in single-origin Ethiopian beans. Self-roasted. Lattes around 27 RMB. Intimate setting."}], "shopping": [], "free_time": [], "timeline": {"Hotel Breakfast or Local Cafe": {"start_time": "08:00", "end_time": "09:00", "duration_minutes": 60}, "Travel to People's Square": {"start_time": "09:00", "end_time": "09:30", "duration_minutes": 30}, "People's Square (\u4eba\u6c11\u5e7f\u573a) - Brief Stop": {"start_time": "09:30", "end_time": "10:00", "duration_minutes": 30}, "Travel to The Bund": {"start_time": "10:00", "end_time": "10:30", "duration_minutes": 30}, "The Bund (\u5916\u6ee9)": {"start_time": "10:30", "end_time": "12:30", "duration_minutes": 120}, "Renheguan (Zaojiabang Road Branch)": {"start_time": "12:30", "end_time": "14:00", "duration_minutes": 90}, "Caf\u00e9 del Volc\u00e1n": {"start_time": "14:00", "end_time": "15:00", "duration_minutes": 60}, "Travel to Pudong Art Museum": {"start_time": "15:00", "end_time": "15:30", "duration_minutes": 30}, "Pudong Art Museum (\u6d66\u4e1c\u7f8e\u672f\u9986)": {"start_time": "15:30", "end_time": "17:30", "duration_minutes": 120}, "Travel to dinner location": {"start_time": "17:30", "end_time": "18:00", "duration_minutes": 30}, "AJIYA Charcoal Grill (Jing'an Branch)": {"start_time": "18:00", "end_time": "20:00", "duration_minutes": 120}, "Return to hotel": {"start_time": "20:00", "end_time": "20:30", "duration_minutes": 30}}, "budget": {"meals": 17.55, "accommodation": 75, "activities": 7.8, "shopping": 0, "transportation": 0, "total": 100.35}}, {"day": 6, "date": "2026-02-20", "location": "Shanghai", "location_change": null, "user_requirements": ["Shanghai Disneyland full day"], "breakfast": {"name": "Hotel Breakfast", "location": "SK Luxury Hotel", "cost": 15, "cuisine": "Western/Chinese", "notes": "Early breakfast before Shanghai Disneyland full day. Quick and convenient."}, "lunch": {"name": "Shanghai Disneyland In-Park Dining", "location": "Shanghai Disneyland Resort", "cost": 40, "cuisine": "International", "notes": "Lunch inside Disneyland. Multiple themed restaurants available. Budget for park food prices."}, "dinner": {"name": "Shanghai Disneyland In-Park or Disneytown", "location": "Shanghai Disneyland Resort / Disneytown", "cost": 50, "cuisine": "International", "notes": "Dinner at Disneyland or nearby Disneytown. Many options after park closes."}, "accommodation": {"name": "Shanghai SK Lusso Hotel (SK\u7b80\u5962\u00b7\u9005\u7199\u9152\u5e97)", "location": "Zone G, Shanghai Keji Jingcheng, No. 668 Beijing East Road, Huangpu District, Shanghai (\u5357\u4eac\u8def\u6b65\u884c\u8857\u5e97)", "cost": 75, "type": "Hotel", "amenities": ["WiFi", "Breakfast included", "Near Nanjing Road Pedestrian Street", "Walking distance to The Bund", "Luggage storage", "Wake-up service"], "rating": 4.5, "check_in": "Previous day", "check_out": "12:00", "notes": "Third night at same hotel. Convenient for Disneyland day trip"}, "attractions": [{"name": "Shanghai Disneyland (\u4e0a\u6d77\u8fea\u58eb\u5c3c\u4e50\u56ed)", "location": "Shendixi Road 753, Chuansha Town, Pudong", "cost": 499, "duration_minutes": 600, "type": "Theme Park", "notes": "Full day visit. Book tickets online in advance (official app or website). Arrive early for rope drop. FastPass+ system available via app. Take Metro Line 11 to Disney Resort Station. Ticket price is standard weekday rate (varies by season). Park hours typically 9am-9pm. Popular attractions: TRON, Pirates of Caribbean, Enchanted Storybook Castle."}], "entertainment": [], "shopping": [], "free_time": [], "timeline": {"Hotel Breakfast": {"start_time": "07:30", "end_time": "08:15", "duration_minutes": 45}, "Travel to Shanghai Disneyland": {"start_time": "08:15", "end_time": "09:30", "duration_minutes": 75}, "Shanghai Disneyland (\u4e0a\u6d77\u8fea\u58eb\u5c3c\u4e50\u56ed)": {"start_time": "09:30", "end_time": "19:30", "duration_minutes": 600}, "Shanghai Disneyland In-Park Dining": {"start_time": "12:00", "end_time": "13:00", "duration_minutes": 60}, "Shanghai Disneyland In-Park or Disneytown": {"start_time": "18:00", "end_time": "19:30", "duration_minutes": 90}, "Travel to hotel": {"start_time": "19:30", "end_time": "21:00", "duration_minutes": 90}}, "budget": {"meals": 13.65, "accommodation": 75, "activities": 64.87, "shopping": 0, "transportation": 0, "total": 153.52}}, {"day": 7, "date": "2026-02-21", "location": "Shanghai", "location_change": null, "user_requirements": ["Niche coffee shops, cute toy shops (like Popmart alternatives)", "Shopping for fashion items if desired", "English bookstores"], "breakfast": {"name": "Specialty Coffee Shop", "location": "French Concession or Tianzifang area", "cost": 25, "cuisine": "Western/Cafe", "notes": "Cozy coffee shop matching girlfriend's interests. INFJ-friendly atmosphere. Good for photography."}, "lunch": {"name": "Trendy Restaurant in Tianzifang", "location": "Tianzifang Art District, Taikang Road", "cost": 35, "cuisine": "Fusion/International", "notes": "Lunch in artsy Tianzifang area. Many cute shops and cafes nearby. Instagram-worthy."}, "dinner": {"name": "Bairong New Shandong Cuisine", "location": "BFC Bund Financial Center, Zhongshan East 2nd Road 558", "cost": 90, "cuisine": "Shandong (MICHELIN)", "notes": "MICHELIN GUIDE restaurant. High-end dining experience. Seafood specialties. Reservations required."}, "accommodation": {"name": "Shanghai SK Lusso Hotel (SK\u7b80\u5962\u00b7\u9005\u7199\u9152\u5e97)", "location": "Zone G, Shanghai Keji Jingcheng, No. 668 Beijing East Road, Huangpu District, Shanghai (\u5357\u4eac\u8def\u6b65\u884c\u8857\u5e97)", "cost": 75, "type": "Hotel", "amenities": ["WiFi", "Breakfast included", "Near Nanjing Road Pedestrian Street", "Walking distance to The Bund", "Luggage storage", "Wake-up service"], "rating": 4.5, "check_in": "Previous day", "check_out": "Next morning for flight", "notes": "Fourth and final night in Shanghai. Check out Feb 22 morning for 9:05am flight to Beijing"}, "attractions": [{"name": "Cute Toy Shops & Popmart Alternatives", "location": "Various locations - Jing'an, Xujiahui, Tianzifang", "cost": 0, "duration_minutes": 120, "type": "Shopping", "notes": "Explore designer toy stores and lifestyle boutiques. TOP TOY (similar to Popmart) has multiple locations. Tianzifang arts district has indie toy shops. See shopping agent for detailed store list."}, {"name": "English Bookstores", "location": "Various locations", "cost": 0, "duration_minutes": 90, "type": "Cultural", "notes": "Options: (1) Garden Books (Xinle Road) - cozy English bookstore/cafe in French Concession. (2) Eslite Bookstore (Huaihai Road) - Taiwanese chain with English section. Both INFJ-friendly quiet spaces. See shopping agent for more details."}, {"name": "Niche Coffee Shops", "location": "French Concession and Jing'an areas", "cost": 0, "duration_minutes": 120, "type": "Lifestyle", "notes": "Specialty coffee scene in Shanghai. Recommendations in meals agent. Good areas: Anfu Road, Yongfu Road, Julu Road. Many quiet, aesthetic spaces perfect for INFJ personality."}], "entertainment": [{"name": "TOP TOY (Nanjing East Road Flagship)", "location": "Nanjing East Road Pedestrian Street (3 floors)", "cost": 150, "time": "11:00", "type": "Toy Store", "notes": "Popmart alternative with collectible toys, plushies, blind boxes. Features Sanrio, Disney, Line Friends. Has caf\u00e9 on 3rd floor. Budget is estimated for purchases."}, {"name": "Garden Books", "location": "325 Changle Road", "cost": 100, "time": "14:00", "type": "English Bookstore", "notes": "Widest selection of English-language books in Shanghai. Ground floor has ice-cream parlor/caf\u00e9 for browsing. Budget for book purchases."}, {"name": "Shanghai Foreign Language Bookstore", "location": "390 Fuzhou Lu, near Fujian Lu", "cost": 80, "time": "15:30", "type": "English Bookstore", "notes": "Nine-floor establishment, biggest foreign bookstore. Ground floor has cheap Signet, Collins, Bantam Classics, Penguin Classics, recent releases."}, {"name": "Caf\u00e9 on Air", "location": "Address requires verification", "cost": 35, "time": "16:30", "type": "Coffee Shop", "notes": "Described as perhaps Shanghai's best coffee shop overall. Beautifully made coffee. Hidden gem atmosphere."}], "shopping": [{"name": "POP MART Nanjing Road Store", "location": "Nanjing East Road Pedestrian Street, Huangpu District, Shanghai", "cost": 80, "type": "Toy Store", "notes": "Flagship store for blind box collectibles and designer toys. Wide selection of series including Molly, Dimoo, Labubu. Great for cute collectibles. Multiple locations on Nanjing Road."}, {"name": "TOP TOY (\u6f6e\u73a9\u96c6\u5408\u5e97)", "location": "Various locations in People's Square and Nanjing Road area", "cost": 60, "type": "Toy Store", "notes": "Alternative to Popmart. Designer toys and collectibles. More affordable than Popmart. Multiple series and collaborations. Check WeChat for exact locations."}, {"name": "X11 Shopping Center (\u5174\u4e1a\u592a\u53e4\u6c47)", "location": "No.789 South Nanjing Road, Huangpu District, Shanghai", "cost": 200, "type": "Shopping Mall", "notes": "Upscale mall near Nanjing Road. Fashion brands, niche boutiques. Less crowded than main Nanjing Road. Good mix of international and local brands. Open 10am-10pm."}, {"name": "Taikoo Li Qiantan (\u524d\u6ee9\u592a\u53e4\u91cc)", "location": "Pudong District, Shanghai", "cost": 150, "type": "Shopping Complex", "notes": "Newer upscale shopping complex. Fashion retailers and lifestyle stores. More modern than Nanjing Road. Less touristy. Metro accessible. Open until 10pm."}, {"name": "Anken Green (\u5b89\u57a6)", "location": "Various locations, Jing'an District", "cost": 100, "type": "Boutique Store", "notes": "Niche lifestyle boutique. Fashion accessories, stationery, home goods. Instagram-worthy. Popular with young locals. Verify location via Dianping or WeChat."}], "free_time": [], "timeline": {"Specialty Coffee Shop": {"start_time": "08:30", "end_time": "10:00", "duration_minutes": 90}, "TOP TOY (Nanjing East Road Flagship)": {"start_time": "10:00", "end_time": "12:00", "duration_minutes": 120}, "Trendy Restaurant in Tianzifang": {"start_time": "12:00", "end_time": "13:30", "duration_minutes": 90}, "Cute Toy Shops & Popmart Alternatives": {"start_time": "13:30", "end_time": "15:00", "duration_minutes": 90}, "Garden Books": {"start_time": "15:00", "end_time": "16:30", "duration_minutes": 90}, "Caf\u00e9 on Air": {"start_time": "16:30", "end_time": "17:30", "duration_minutes": 60}, "Travel to dinner location": {"start_time": "17:30", "end_time": "18:00", "duration_minutes": 30}, "Bairong New Shandong Cuisine": {"start_time": "18:00", "end_time": "20:00", "duration_minutes": 120}, "Return to hotel": {"start_time": "20:00", "end_time": "20:30", "duration_minutes": 30}}, "budget": {"meals": 19.5, "accommodation": 75, "activities": 0, "shopping": 51.35, "transportation": 0, "total": 145.85}}, {"day": 8, "date": "2026-02-22", "location": "Beijing", "location_change": {"from": "Shanghai", "to": "Beijing", "from_location": "SK Luxury Hotel (\u5916\u6ee9SK\u7b80\u5962\u00b7\u9005\u7199\u9152\u5e97), Shanghai", "to_location": "Orange Hotel (\u6854\u5b50\u9152\u5e97\u4e2d\u5173\u6751\u5b66\u9662\u6865\u5e97), Beijing", "transportation": "Flight (ALREADY BOOKED)", "route_details": {"flight_number": "MU5129", "airline": "China Eastern Airlines", "departure_airport": "Shanghai Pudong International Airport (PVG)", "departure_terminal": "Terminal 1", "arrival_airport": "Beijing Daxing International Airport (PKX)", "arrival_terminal": "Main Terminal"}, "departure_time": "09:05", "arrival_time": "11:25", "flight_duration_minutes": 140, "total_journey_minutes": 270, "cost": 0, "booking_required": false, "booking_status": "CONFIRMED - Flight already booked", "data_source": "user_provided", "notes": "Flight ALREADY BOOKED. Departure 09:05 from PVG T1, arrival 11:25 at Beijing Daxing. Total journey ~4.5h including airport transfers. Must leave hotel by 06:30 to allow 2.5h buffer. Hotel to Pudong T1: ~1.5h by metro (Line 2). Beijing Daxing to Orange Hotel (\u4e2d\u5173\u6751): ~2h by Daxing Airport Express + subway Line 4 + Line 10. Afternoon university registration, evening dance drama '\u53ea\u6b64\u9752\u7eff'. Tight schedule requires efficient airport transfers."}, "user_requirements": ["Morning flight MU5129 Shanghai Pudong T1 9:05 to Beijing Daxing 11:25", "Afternoon: University registration", "Evening: Watch dance drama '\u53ea\u6b64\u9752\u7eff' (Only This Green)", "Check in to Orange Hotel (\u6854\u5b50\u9152\u5e97\u4e2d\u5173\u6751\u5b66\u9662\u6865\u5e97) for 1 night"], "breakfast": {"name": "Airport Quick Service", "location": "Shanghai Pudong Airport T1", "cost": 15, "cuisine": "Chinese Fast Food", "notes": "Early morning flight (9:05). Quick breakfast at airport before boarding."}, "lunch": {"name": "Restaurant near University", "location": "Haidian District, near Tsinghua/Peking University", "cost": 25, "cuisine": "Chinese", "notes": "Lunch after arrival (11:25) and before university registration. Near Haidian area."}, "dinner": {"name": "Pre-Theater Quick Meal", "location": "Near theater for 'Only This Green' dance drama", "cost": 30, "cuisine": "Chinese", "notes": "Quick dinner before evening dance drama performance. Light meal recommended."}, "accommodation": {"name": "Orange Hotel Beijing Zhongguancun Xueyuanqiao (\u6854\u5b50\u9152\u5e97\u4e2d\u5173\u6751\u5b66\u9662\u6865\u5e97)", "location": "Haidian District, Beijing (near Zhongguancun/Academy Bridge area)", "cost": 40, "type": "Hotel", "amenities": ["WiFi", "Basic breakfast", "Budget-friendly", "Near universities"], "rating": 4.0, "check_in": "After university registration", "check_out": "12:00 next day", "notes": "Budget hotel chain (Orange Hotels). One night only. Convenient for university area. Rate estimated at \u20ac35-45/night. Book through Trip.com or Ctrip"}, "attractions": [], "entertainment": [{"name": "Dance Drama '\u53ea\u6b64\u9752\u7eff' (A Panorama of Rivers and Mountains)", "location": "National Centre for the Performing Arts, No. 2 West Chang'an Street, Xicheng District", "cost": 580, "time": "19:00", "type": "Theater/Performance", "notes": "CRITICAL: Must verify February 2026 schedule - not yet confirmed. Typical ticket prices: 180-980 RMB. Book via National Centre official website, WeChat 'guojiadadjuyuanzhihuiguanjia', or hotline 66550000. Book 1-2 months in advance. Performance duration ~90 minutes. Plan dinner before 18:00 to arrive on time."}], "shopping": [], "free_time": [], "timeline": {"Hotel check-out and travel to airport": {"start_time": "06:30", "end_time": "08:00", "duration_minutes": 90}, "Airport Quick Service": {"start_time": "08:00", "end_time": "08:30", "duration_minutes": 30}, "Airport check-in and security": {"start_time": "08:30", "end_time": "09:05", "duration_minutes": 35}, "Flight (ALREADY BOOKED)": {"start_time": "09:05", "end_time": "11:25", "duration_minutes": 140}, "Travel from Beijing Daxing to university area": {"start_time": "11:25", "end_time": "13:30", "duration_minutes": 125}, "Restaurant near University": {"start_time": "13:30", "end_time": "14:30", "duration_minutes": 60}, "University registration": {"start_time": "14:30", "end_time": "16:30", "duration_minutes": 120}, "Pre-Theater Quick Meal": {"start_time": "17:00", "end_time": "18:00", "duration_minutes": 60}, "Travel to theater": {"start_time": "18:00", "end_time": "18:30", "duration_minutes": 30}, "Dance Drama '\u53ea\u6b64\u9752\u7eff' (A Panorama of Rivers and Mountains)": {"start_time": "19:00", "end_time": "20:30", "duration_minutes": 90}, "Travel to Orange Hotel": {"start_time": "20:30", "end_time": "21:15", "duration_minutes": 45}, "Hotel check-in": {"start_time": "21:15", "end_time": "21:30", "duration_minutes": 15}}, "budget": {"meals": 9.1, "accommodation": 40, "activities": 75.4, "shopping": 0, "transportation": 0, "total": 124.5}}, {"day": 9, "date": "2026-02-23", "location": "Beijing", "location_change": null, "user_requirements": ["Girlfriend's orientation (daytime)", "Move to rental apartment (address TBD)", "Help establish comfort zone: Tour Tsinghua/Peking University campuses, find nearby restaurants and life support facilities"], "breakfast": {"name": "Orange Hotel Breakfast", "location": "Orange Hotel (Zhongguancun Xueyuanqiao Branch)", "cost": 10, "cuisine": "Chinese", "notes": "Hotel breakfast before girlfriend's orientation. Check-out and move to rental apartment."}, "lunch": {"name": "Tsinghua University Canteen (Qingfen Garden)", "location": "Shuangqing Road, Tsinghua University South Area Building 7", "cost": 10, "cuisine": "Chinese Canteen", "notes": "University canteen experience. Authentic student dining. Affordable and convenient during campus tour."}, "dinner": {"name": "Local Restaurant near Rental Apartment", "location": "Near rental apartment (address TBD)", "cost": 30, "cuisine": "Chinese", "notes": "First dinner at new rental. Establish nearby dining options for girlfriend's comfort zone."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "total_for_stay": 455, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "After checkout from Orange Hotel", "check_out": "March 7, 2026", "notes": "13 nights total (Feb 23 - Mar 7). Estimated 4,000-6,000 RMB/month (\u20ac500-750/month). Daily rate calculated at ~\u20ac35/night for mid-range apartment. Location TBD but should be near Tsinghua/Peking University for girlfriend's classes. Book through Ziroom app (English interface available) or Airbnb China"}, "attractions": [{"name": "Tsinghua University Campus (\u6e05\u534e\u5927\u5b66)", "location": "Haidian District, North Beijing", "cost": 0, "duration_minutes": 120, "type": "University Campus", "notes": "Help girlfriend establish comfort zone. Campus tour to familiarize with area. Beautiful traditional Chinese architecture mixed with modern buildings. ID required for entry (passport). May need advance registration online. Large campus, focus on main areas near student services."}, {"name": "Peking University Campus (\u5317\u4eac\u5927\u5b66)", "location": "Haidian District, adjacent to Tsinghua", "cost": 0, "duration_minutes": 120, "type": "University Campus", "notes": "Alternative or additional campus visit. Historic Weiming Lake (\u672a\u540d\u6e56) is iconic. Similar entry requirements as Tsinghua. Both universities close to each other. Explore nearby restaurants and facilities for girlfriend's daily life support."}, {"name": "Nearby Life Support Facilities", "location": "Wudaokou and university neighborhood", "cost": 0, "duration_minutes": 120, "type": "Neighborhood Exploration", "notes": "After campus tours, explore Wudaokou area (\u4e94\u9053\u53e3) - student district with restaurants, cafes, supermarkets, and international food. Help girlfriend identify daily necessities locations: grocery stores, pharmacies, banks, metro stations."}], "entertainment": [], "shopping": [], "free_time": [], "timeline": {"Orange Hotel Breakfast": {"start_time": "07:30", "end_time": "08:15", "duration_minutes": 45}, "Hotel check-out": {"start_time": "08:15", "end_time": "08:45", "duration_minutes": 30}, "Girlfriend's orientation (daytime)": {"start_time": "09:00", "end_time": "12:00", "duration_minutes": 180}, "Tsinghua University Canteen (Qingfen Garden)": {"start_time": "12:00", "end_time": "13:00", "duration_minutes": 60}, "Tsinghua University Campus (\u6e05\u534e\u5927\u5b66)": {"start_time": "13:00", "end_time": "15:00", "duration_minutes": 120}, "Peking University Campus (\u5317\u4eac\u5927\u5b66)": {"start_time": "15:00", "end_time": "17:00", "duration_minutes": 120}, "Travel to rental apartment": {"start_time": "17:00", "end_time": "17:30", "duration_minutes": 30}, "Move to rental apartment and settle": {"start_time": "17:30", "end_time": "18:30", "duration_minutes": 60}, "Local Restaurant near Rental Apartment": {"start_time": "18:30", "end_time": "20:00", "duration_minutes": 90}, "Nearby Life Support Facilities": {"start_time": "20:00", "end_time": "21:30", "duration_minutes": 90}}, "budget": {"meals": 6.5, "accommodation": 35, "activities": 0, "shopping": 0, "transportation": 0, "total": 41.5}}, {"day": 10, "date": "2026-02-24", "location": "Beijing", "location_change": null, "user_requirements": ["Register girlfriend at dance studio (must support foreigners)", "Explore university neighborhood", "Evening activities possible (girlfriend free after class)"], "breakfast": {"name": "Local Breakfast near Apartment", "location": "Near rental apartment", "cost": 8, "cuisine": "Beijing Breakfast", "notes": "Local breakfast spot. Baozi, jianbing, or doujiang options."}, "lunch": {"name": "University Area Restaurant", "location": "Wudaokou or Zhongguancun area", "cost": 20, "cuisine": "Chinese", "notes": "Lunch in university neighborhood. Many student-friendly options. After dance studio registration."}, "dinner": {"name": "Korean Restaurant in Wudaokou", "location": "Wudaokou area (Korea Town)", "cost": 35, "cuisine": "Korean", "notes": "Wudaokou has excellent Korean food. Popular with students. Evening after girlfriend finishes class."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "Previous day", "check_out": "March 7, 2026", "notes": "Continuing stay in rental apartment"}, "attractions": [{"name": "University Neighborhood Exploration", "location": "Haidian District around rental apartment", "cost": 0, "duration_minutes": 180, "type": "Lifestyle Setup", "notes": "Continue establishing girlfriend's comfort zone. After dance studio registration, explore more local amenities. Evening activities possible after class."}], "entertainment": [{"name": "Beijing Dance Academy (\u5317\u4eac\u821e\u8e48\u5b66\u9662) - Registration/Tour", "location": "Haidian District, north of Zizhuyuan Park", "cost": 0, "time": "10:00", "type": "Dance Studio", "notes": "Official academy accepting international students since 1955. Nearly 100 professional dance classrooms. Visit international student office for registration. Website: https://international.bda.edu.cn. This is for registration/tour, not a dance class. Actual class registration and fees TBD."}, {"name": "Bridge Coffee (\u6865\u5496\u5561)", "location": "Wudaokou, Chengfu Road Huaqing Jiayuan 12-8", "cost": 30, "time": "15:00", "type": "Coffee Shop", "notes": "Popular with international students. Has rooftop open-air caf\u00e9. Near Wudaokou subway. Great for university neighborhood exploration."}], "shopping": [], "free_time": [], "timeline": {"Local Breakfast near Apartment": {"start_time": "07:30", "end_time": "08:15", "duration_minutes": 45}, "Travel to Beijing Dance Academy": {"start_time": "08:15", "end_time": "09:00", "duration_minutes": 45}, "Beijing Dance Academy (\u5317\u4eac\u821e\u8e48\u5b66\u9662) - Registration/Tour": {"start_time": "09:00", "end_time": "11:00", "duration_minutes": 120}, "Travel to university area": {"start_time": "11:00", "end_time": "11:30", "duration_minutes": 30}, "University Area Restaurant": {"start_time": "11:30", "end_time": "12:45", "duration_minutes": 75}, "University Neighborhood Exploration": {"start_time": "12:45", "end_time": "15:45", "duration_minutes": 180}, "Bridge Coffee (\u6865\u5496\u5561)": {"start_time": "15:00", "end_time": "16:00", "duration_minutes": 60}, "Continue neighborhood exploration": {"start_time": "16:00", "end_time": "18:00", "duration_minutes": 120}, "Korean Restaurant in Wudaokou": {"start_time": "18:00", "end_time": "19:30", "duration_minutes": 90}, "Return to apartment": {"start_time": "19:30", "end_time": "20:00", "duration_minutes": 30}}, "budget": {"meals": 8.19, "accommodation": 35, "activities": 0, "shopping": 0, "transportation": 0, "total": 43.19}}, {"day": 11, "date": "2026-02-25", "location": "Beijing", "location_change": null, "user_requirements": ["\u26a0\ufe0f Girlfriend has class (Wednesday) - no far trips during day", "Evening activities possible"], "breakfast": {"name": "Local Breakfast near Apartment", "location": "Near rental apartment", "cost": 8, "cuisine": "Beijing Breakfast", "notes": "Wednesday - girlfriend has class. Quick breakfast near apartment."}, "lunch": {"name": "Lunch near Apartment", "location": "Near rental apartment (no far trips)", "cost": 15, "cuisine": "Chinese", "notes": "NO FAR TRIPS (girlfriend has class). Stay near apartment during day."}, "dinner": {"name": "University Area Restaurant", "location": "Wudaokou or Zhongguancun", "cost": 30, "cuisine": "Chinese/International", "notes": "Evening activities possible after girlfriend's class. Casual dinner together."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "Previous day", "check_out": "March 7, 2026", "notes": "Continuing stay in rental apartment"}, "attractions": [], "entertainment": [{"name": "June Garden Coffee (\u516d\u6708\u82b1\u56ed\u5496\u5561\u9986)", "location": "Wudaokou Longhu Tangning One ground floor", "cost": 40, "time": "17:00", "type": "Coffee Shop", "notes": "11-year establishment. Underground space in 'Secret Garden' fairy tale style. Over 30 varieties of specialty hand-brewed coffee. Professional bar area. Cozy atmosphere perfect for evening after girlfriend's class."}], "shopping": [{"name": "Wudaokou Shopping District", "location": "Wudaokou, Haidian District (near universities)", "cost": 80, "type": "Shopping District", "notes": "University area shopping. Youth fashion, affordable clothing. Close to Tsinghua/Peking University. Ideal for evening after girlfriend's class. Open late."}], "free_time": [], "timeline": {"Local Breakfast near Apartment": {"start_time": "07:30", "end_time": "08:15", "duration_minutes": 45}, "Girlfriend has class (no far trips)": {"start_time": "08:30", "end_time": "16:30", "duration_minutes": 480}, "Lunch near Apartment": {"start_time": "11:30", "end_time": "12:30", "duration_minutes": 60}, "June Garden Coffee (\u516d\u6708\u82b1\u56ed\u5496\u5561\u9986)": {"start_time": "17:00", "end_time": "18:00", "duration_minutes": 60}, "University Area Restaurant": {"start_time": "18:00", "end_time": "19:30", "duration_minutes": 90}, "Return to apartment": {"start_time": "19:30", "end_time": "20:00", "duration_minutes": 30}}, "budget": {"meals": 6.89, "accommodation": 35, "activities": 0, "shopping": 10.4, "transportation": 0, "total": 52.29}}, {"day": 12, "date": "2026-02-26", "location": "Beijing", "location_change": null, "user_requirements": ["\u26a0\ufe0f Girlfriend has class (Thursday) - no far trips during day", "Evening activities possible"], "breakfast": {"name": "Local Breakfast near Apartment", "location": "Near rental apartment", "cost": 8, "cuisine": "Beijing Breakfast", "notes": "Thursday - girlfriend has class. Local breakfast."}, "lunch": {"name": "Lunch near Apartment", "location": "Near rental apartment (no far trips)", "cost": 15, "cuisine": "Chinese", "notes": "NO FAR TRIPS (girlfriend has class). Stay near apartment during day."}, "dinner": {"name": "Hotpot Restaurant", "location": "Haidian District", "cost": 40, "cuisine": "Beijing Hotpot", "notes": "Evening activities possible. Copper pot hotpot (\u94dc\u9505\u6dae\u8089) is Beijing specialty."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "Previous day", "check_out": "March 7, 2026", "notes": "Continuing stay in rental apartment"}, "attractions": [], "entertainment": [{"name": "Metalhands Coffee", "location": "Wudaoying or Jiaodaokou area (multiple locations)", "cost": 35, "time": "17:30", "type": "Coffee Shop", "notes": "Beautiful spaces and quality coffee. Quiet, orderly atmosphere. Good for post-class relaxation."}], "shopping": [{"name": "Wudaokou Shopping District", "location": "Wudaokou, Haidian District (near universities)", "cost": 80, "type": "Shopping District", "notes": "University area shopping. Youth fashion, affordable clothing. Close to Tsinghua/Peking University. Ideal for evening after girlfriend's class. Open late."}], "free_time": [], "timeline": {"Local Breakfast near Apartment": {"start_time": "07:30", "end_time": "08:15", "duration_minutes": 45}, "Girlfriend has class (no far trips)": {"start_time": "08:30", "end_time": "16:30", "duration_minutes": 480}, "Lunch near Apartment": {"start_time": "11:30", "end_time": "12:30", "duration_minutes": 60}, "Metalhands Coffee": {"start_time": "17:30", "end_time": "18:30", "duration_minutes": 60}, "Hotpot Restaurant": {"start_time": "18:30", "end_time": "20:30", "duration_minutes": 120}, "Return to apartment": {"start_time": "20:30", "end_time": "21:00", "duration_minutes": 30}}, "budget": {"meals": 8.19, "accommodation": 35, "activities": 0, "shopping": 10.4, "transportation": 0, "total": 53.59}}, {"day": 13, "date": "2026-02-27", "location": "Beijing", "location_change": null, "user_requirements": ["Explore Beijing (full day available)", "Visit Forbidden City", "Consider Nanluoguxiang or 798 Art District", "Indoor couple photography session (avoid Tue/Wed/Thu)"], "breakfast": {"name": "Breakfast near Apartment", "location": "Near rental apartment", "cost": 10, "cuisine": "Chinese", "notes": "Friday - full day available. Breakfast before Forbidden City visit."}, "lunch": {"name": "Fangzhuanchang 69 Zhajiangmian (Nanluoguxiang Branch)", "location": "Nanluoguxiang 117", "cost": 20, "cuisine": "Beijing Noodles", "notes": "Famous Beijing zhajiangmian (fried sauce noodles). Near Nanluoguxiang area. Authentic local food."}, "dinner": {"name": "Beimen Shuanrou (Shichahai Branch)", "location": "Mao'er Hutong Yi 43 (near Shichahai Metro)", "cost": 45, "cuisine": "Beijing Copper Pot Hotpot", "notes": "Authentic Beijing copper pot lamb hotpot (\u94dc\u9505\u6dae\u8089). Traditional dining experience. Near 798 or Nanluoguxiang area."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "Previous day", "check_out": "March 7, 2026", "notes": "Continuing stay in rental apartment"}, "attractions": [{"name": "Forbidden City (\u6545\u5bab\u535a\u7269\u9662)", "location": "Jingshan Front Street 4, Dongcheng District", "cost": 60, "duration_minutes": 240, "type": "Historical Palace Complex", "notes": "Full day available. Book tickets online in advance (mandatory, through official website). Enter from Meridian Gate (\u5348\u95e8), exit from Gate of Divine Prowess (\u795e\u6b66\u95e8). Audio guide recommended. Allow 3-4 hours minimum. Avoid Tuesdays (closed). Popular palaces: Hall of Supreme Harmony, Imperial Garden, Palace of Gathered Elegance, Clock Museum."}, {"name": "Nanluoguxiang (\u5357\u9523\u9f13\u5df7) OR 798 Art District (798\u827a\u672f\u533a)", "location": "Nanluoguxiang: Dongcheng District (Metro Line 6/8). 798: Jiuxianqiao Road 4, Chaoyang District", "cost": 0, "duration_minutes": 120, "type": "Cultural District", "notes": "Choose based on interest: (1) Nanluoguxiang - historic hutong alley with cafes, boutiques, traditional architecture. Touristy but charming. Closer to Forbidden City. (2) 798 Art District - contemporary art galleries in former factory complex. Less crowded, more INFJ-friendly. Modern art scene. Both free entry. 798 requires taxi/Didi from city center."}], "entertainment": [{"name": "Indoor Couple Photography Session", "location": "TBD - requires booking with specific studio", "cost": 600, "time": "14:00", "type": "Photography", "notes": "BOOKING REQUIRED: Options include Wave Soda (WAVESODA\u6444\u5f71\u5de5\u4f5c\u5ba4) at Jingyuan Art Centre (~2,388 RMB for 2 costumes, 2 sets, 12 photos) or Himo Studio (\u6d77\u9a6c\u4f53\u7167\u76f8\u9986, 600 locations nationwide). Book 2-3 weeks in advance. Session duration: 2-3 hours. Scheduled on Friday to avoid Tue/Wed/Thu class days."}], "shopping": [{"name": "798 Art District Shops", "location": "798 Art Zone, Jiuxianqiao Road, Chaoyang District", "cost": 120, "type": "Art District Shopping", "notes": "Art galleries with boutique shops. Unique fashion items, accessories, designer goods. Creative atmosphere. Great for photography. Open 10am-6pm typically."}], "free_time": [], "timeline": {"Breakfast near Apartment": {"start_time": "07:30", "end_time": "08:30", "duration_minutes": 60}, "Travel to Forbidden City": {"start_time": "08:30", "end_time": "09:30", "duration_minutes": 60}, "Forbidden City (\u6545\u5bab\u535a\u7269\u9662)": {"start_time": "09:30", "end_time": "13:30", "duration_minutes": 240}, "Indoor Couple Photography Session": {"start_time": "14:00", "end_time": "17:00", "duration_minutes": 180}, "Travel to Nanluoguxiang": {"start_time": "17:00", "end_time": "17:30", "duration_minutes": 30}, "Fangzhuanchang 69 Zhajiangmian (Nanluoguxiang Branch)": {"start_time": "17:30", "end_time": "18:30", "duration_minutes": 60}, "Nanluoguxiang (\u5357\u9523\u9f13\u5df7) OR 798 Art District (798\u827a\u672f\u533a)": {"start_time": "18:30", "end_time": "20:30", "duration_minutes": 120}, "Beimen Shuanrou (Shichahai Branch)": {"start_time": "20:30", "end_time": "22:00", "duration_minutes": 90}, "Return to apartment": {"start_time": "22:00", "end_time": "22:30", "duration_minutes": 30}}, "budget": {"meals": 9.75, "accommodation": 35, "activities": 85.8, "shopping": 15.6, "transportation": 0, "total": 146.15}}, {"day": 14, "date": "2026-02-28", "location": "Beijing", "location_change": null, "user_requirements": ["Continue Beijing exploration", "Coffee shops, cute shops", "Shopping for fashion items if desired"], "breakfast": {"name": "Specialty Coffee Shop", "location": "798 Art District or Sanlitun", "cost": 25, "cuisine": "Western/Cafe", "notes": "Cozy coffee shop day. INFJ-friendly atmosphere. Good for girlfriend's photography interest."}, "lunch": {"name": "Trendy Restaurant in Sanlitun", "location": "Sanlitun area", "cost": 35, "cuisine": "Fusion/International", "notes": "Lunch in Sanlitun shopping area. Many cute shops nearby. Fashion shopping opportunities."}, "dinner": {"name": "Restaurant in 798 Art District", "location": "798 Art District, Dashanzi", "cost": 40, "cuisine": "International/Fusion", "notes": "Dinner in artistic 798 area. Many creative restaurants. Matches girlfriend's interests."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "Previous day", "check_out": "March 7, 2026", "notes": "Continuing stay in rental apartment"}, "attractions": [{"name": "Coffee Shops & Cute Shops", "location": "Various neighborhoods - Sanlitun, Gulou, Wudaokou", "cost": 0, "duration_minutes": 180, "type": "Lifestyle Exploration", "notes": "Explore Beijing's specialty coffee scene and designer toy shops. Sanlitun area has many lifestyle boutiques. See meals and shopping agents for specific recommendations."}, {"name": "Shopping for Fashion Items", "location": "Sanlitun Taikoo Li, Xidan, or Wangfujing", "cost": 0, "duration_minutes": 120, "type": "Shopping", "notes": "If desired. Major shopping districts: Sanlitun Taikoo Li (high-end, similar to Chengdu Taikoo Li), Xidan (mid-range Chinese brands), Wangfujing (department stores). See shopping agent for details."}], "entertainment": [{"name": "TOP TOY (Wangfujing apm)", "location": "2nd floor, Beijing apm, No. 138 Wangfujing Street, Dongcheng District", "cost": 150, "time": "11:00", "type": "Toy Store", "notes": "Over 1000 art toys, 9 categories including Blind Boxes, Garage Kits, Gundam Models, Lego. Popularizes designer toys. Budget for purchases."}, {"name": "FAO Schwarz or Hamleys", "location": "FAO: Guomao CBD (2,600 sqm) | Hamleys: Wangfujing (3 floors)", "cost": 200, "time": "13:00", "type": "Toy Store", "notes": "Upscale international toy retailers. FAO is Asia's first flagship. Hamleys is one of largest single-building toy stores. Budget for cute toys and souvenirs."}, {"name": "Page One Bookstore", "location": "7th Floor Wangfujing Bookstore, 218 Wangfujing Dajie, OR 77 Meishuguan Houjie, Dongcheng", "cost": 100, "time": "15:00", "type": "English Bookstore", "notes": "International chain with wide range of English books. Fiction, non-fiction, bestsellers, classics. Budget for book purchases."}], "shopping": [{"name": "POP MART Beijing Sanlitun Store", "location": "Sanlitun Shopping District, Chaoyang District", "cost": 80, "type": "Toy Store", "notes": "Flagship store in trendy Sanlitun area. Same blind box collectibles as Shanghai. Wide selection. Good for cute collectibles. Open 10am-10pm."}, {"name": "Sanlitun Village (\u4e09\u91cc\u5c6f\u592a\u53e4\u91cc)", "location": "No.11 Sanlitun Road, Chaoyang District", "cost": 200, "type": "Shopping Complex", "notes": "Beijing's trendiest shopping area. Fashion brands, lifestyle stores. Great for fashion shopping. Mix of luxury and mid-range. Open-air design. Open until 10pm."}, {"name": "Solana Lifestyle Shopping Park", "location": "No.6 Chaoyang Park Road, Chaoyang District", "cost": 150, "type": "Shopping Mall", "notes": "Upscale lifestyle mall. Fashion, accessories, specialty stores. Less crowded than Sanlitun. Good atmosphere. Near Chaoyang Park. Open 10am-10pm."}, {"name": "Nanluoguxiang Side Streets", "location": "Nanluoguxiang area, Dongcheng District", "cost": 100, "type": "Boutique Shopping", "notes": "Small boutiques and craft shops in historic hutongs. Unique fashion items, accessories. Affordable. Authentic local shopping. Avoid main tourist alley, explore side streets."}], "free_time": [], "timeline": {"Specialty Coffee Shop": {"start_time": "08:30", "end_time": "10:00", "duration_minutes": 90}, "Travel to Wangfujing": {"start_time": "10:00", "end_time": "10:30", "duration_minutes": 30}, "TOP TOY (Wangfujing apm)": {"start_time": "10:30", "end_time": "12:00", "duration_minutes": 90}, "Trendy Restaurant in Sanlitun": {"start_time": "12:00", "end_time": "13:30", "duration_minutes": 90}, "FAO Schwarz or Hamleys": {"start_time": "13:30", "end_time": "15:00", "duration_minutes": 90}, "Page One Bookstore": {"start_time": "15:00", "end_time": "16:30", "duration_minutes": 90}, "Coffee Shops & Cute Shops": {"start_time": "16:30", "end_time": "18:00", "duration_minutes": 90}, "Restaurant in 798 Art District": {"start_time": "18:00", "end_time": "20:00", "duration_minutes": 120}, "Return to apartment": {"start_time": "20:00", "end_time": "21:00", "duration_minutes": 60}}, "budget": {"meals": 13, "accommodation": 35, "activities": 0, "shopping": 69.2, "transportation": 0, "total": 117.2}}, {"day": 15, "date": "2026-03-01", "location": "Beijing", "location_change": null, "user_requirements": ["Free day - plan based on preferences"], "breakfast": {"name": "Local Breakfast near Apartment", "location": "Near rental apartment", "cost": 8, "cuisine": "Beijing Breakfast", "notes": "Saturday - free day. Flexible breakfast timing."}, "lunch": {"name": "Beijing Roast Duck Restaurant", "location": "Haidian or Dongcheng District", "cost": 50, "cuisine": "Beijing Duck", "notes": "Must-try Beijing roast duck (\u5317\u4eac\u70e4\u9e2d). Recommend Quanjude or Da Dong. Make reservations."}, "dinner": {"name": "University Area Restaurant", "location": "Wudaokou or Zhongguancun", "cost": 30, "cuisine": "Chinese/International", "notes": "Casual dinner near apartment. Free day schedule."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "Previous day", "check_out": "March 7, 2026", "notes": "Continuing stay in rental apartment"}, "attractions": [{"name": "Free Day - Flexible Planning", "location": "Various options", "cost": 0, "duration_minutes": 480, "type": "Flexible", "notes": "Options: (1) Temple of Heaven Park (\u5929\u575b) - historic temple complex with beautiful architecture. (2) Summer Palace (\u9890\u548c\u56ed) - imperial garden with Kunming Lake. (3) Jingshan Park (\u666f\u5c71\u516c\u56ed) - hill park behind Forbidden City with panoramic city views. (4) More hutong exploration. (5) Museums: National Museum, Capital Museum. Plan based on weather and mood."}], "entertainment": [{"name": "Foreign Languages Bookstore", "location": "235 Wangfujing Dajie, Dongcheng District", "cost": 80, "time": "11:00", "type": "English Bookstore", "notes": "Iconic destination for international readers. Extensive collection of foreign-language books, particularly English."}, {"name": "Sanlian Taofen Bookstore", "location": "Address requires verification", "cost": 60, "time": "14:00", "type": "Bookstore/Cafe", "notes": "Second floor has large range of English-language editions and small cafe. Good for browsing and relaxing."}], "shopping": [], "free_time": [], "timeline": {"Local Breakfast near Apartment": {"start_time": "08:00", "end_time": "09:00", "duration_minutes": 60}, "Travel to attraction": {"start_time": "09:00", "end_time": "10:00", "duration_minutes": 60}, "Free Day - Flexible Planning": {"start_time": "10:00", "end_time": "12:00", "duration_minutes": 120}, "Beijing Roast Duck Restaurant": {"start_time": "12:00", "end_time": "14:00", "duration_minutes": 120}, "Foreign Languages Bookstore": {"start_time": "14:00", "end_time": "16:00", "duration_minutes": 120}, "Sanlian Taofen Bookstore": {"start_time": "16:00", "end_time": "18:00", "duration_minutes": 120}, "University Area Restaurant": {"start_time": "18:00", "end_time": "19:30", "duration_minutes": 90}, "Return to apartment": {"start_time": "19:30", "end_time": "20:00", "duration_minutes": 30}}, "budget": {"meals": 11.44, "accommodation": 35, "activities": 0, "shopping": 0, "transportation": 0, "total": 46.44}}, {"day": 16, "date": "2026-03-02", "location": "Beijing", "location_change": null, "user_requirements": ["Free day - consider day trip to Tianjin"], "breakfast": {"name": "Breakfast near Apartment or Train Station", "location": "Beijing or Tianjin", "cost": 10, "cuisine": "Chinese", "notes": "If Tianjin day trip: early breakfast before train. Otherwise local breakfast."}, "lunch": {"name": "Tianjin Specialty Restaurant (if day trip)", "location": "Tianjin Ancient Culture Street area", "cost": 30, "cuisine": "Tianjin Cuisine", "notes": "IF TIANJIN TRIP: Try goubuli baozi (\u72d7\u4e0d\u7406\u5305\u5b50), erduoyan zhagao (\u8033\u6735\u773c\u70b8\u7cd5). Otherwise lunch in Beijing."}, "dinner": {"name": "Return to Beijing - Local Restaurant", "location": "Near rental apartment, Beijing", "cost": 30, "cuisine": "Chinese", "notes": "Return from Tianjin or Beijing dinner. Relaxed evening meal."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "Previous day", "check_out": "March 7, 2026", "notes": "Continuing stay in rental apartment"}, "attractions": [{"name": "Tianjin Day Trip - Optional", "location": "Tianjin city, 30-min high-speed train from Beijing", "cost": 54, "duration_minutes": 480, "type": "Day Trip", "notes": "If desired, day trip to Tianjin. High-speed train 30 minutes from Beijing South Station to Tianjin. Attractions: (1) Italian Style Street (\u610f\u5927\u5229\u98ce\u60c5\u8857) - European architecture. (2) Ancient Culture Street (\u53e4\u6587\u5316\u8857) - traditional shops and temples. (3) Haihe River waterfront. (4) Five Great Avenues (\u4e94\u5927\u9053) - colonial-era mansions, good for photography. (5) Porcelain House (\u74f7\u623f\u5b50) - unique museum. Train cost ~54 RMB one-way."}, {"name": "Alternative: Beijing Free Day", "location": "Beijing", "cost": 0, "duration_minutes": 480, "type": "Flexible", "notes": "If not going to Tianjin, more Beijing exploration. Options same as Day 15. Or relaxed day at cafes and local neighborhoods."}], "entertainment": [], "shopping": [], "free_time": [], "timeline": {"Breakfast near Apartment or Train Station": {"start_time": "07:30", "end_time": "08:30", "duration_minutes": 60}, "Travel to Beijing South Station (if Tianjin trip)": {"start_time": "08:30", "end_time": "09:30", "duration_minutes": 60}, "Tianjin Day Trip - Optional": {"start_time": "10:00", "end_time": "18:00", "duration_minutes": 480}, "Tianjin Specialty Restaurant (if day trip)": {"start_time": "12:00", "end_time": "13:30", "duration_minutes": 90}, "Return to Beijing - Local Restaurant": {"start_time": "18:00", "end_time": "19:30", "duration_minutes": 90}, "Travel back to apartment": {"start_time": "19:30", "end_time": "20:30", "duration_minutes": 60}}, "budget": {"meals": 7.8, "accommodation": 35, "activities": 7.02, "shopping": 0, "transportation": 0, "total": 49.82}}, {"day": 17, "date": "2026-03-03", "location": "Beijing", "location_change": null, "user_requirements": ["\u26a0\ufe0f Girlfriend has class (Tuesday) - no far trips during day", "Evening activities possible"], "breakfast": {"name": "Local Breakfast near Apartment", "location": "Near rental apartment", "cost": 8, "cuisine": "Beijing Breakfast", "notes": "Tuesday - girlfriend has class. Local breakfast."}, "lunch": {"name": "Lunch near Apartment", "location": "Near rental apartment (no far trips)", "cost": 15, "cuisine": "Chinese", "notes": "NO FAR TRIPS (girlfriend has class). Stay near apartment during day."}, "dinner": {"name": "Japanese Restaurant in Wudaokou", "location": "Wudaokou area", "cost": 40, "cuisine": "Japanese", "notes": "Evening activities possible after class. Wudaokou has good Japanese restaurants."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "Previous day", "check_out": "March 7, 2026", "notes": "Continuing stay in rental apartment"}, "attractions": [], "entertainment": [{"name": "University Area Coffee Crawl", "location": "Wudaokou area", "cost": 50, "time": "17:00", "type": "Coffee Shop", "notes": "Evening exploration of niche coffee shops after girlfriend's class. Visit 2-3 shops discovered earlier in trip."}], "shopping": [{"name": "University Area Shopping", "location": "Near Tsinghua/Peking University, Haidian District", "cost": 60, "type": "Local Shopping", "notes": "Evening shopping after girlfriend's class. Local shops, youth fashion. Affordable clothing and accessories. Good for comfort zone exploration."}], "free_time": [], "timeline": {"Local Breakfast near Apartment": {"start_time": "07:30", "end_time": "08:15", "duration_minutes": 45}, "Girlfriend has class (no far trips)": {"start_time": "08:30", "end_time": "16:30", "duration_minutes": 480}, "Lunch near Apartment": {"start_time": "11:30", "end_time": "12:30", "duration_minutes": 60}, "University Area Coffee Crawl": {"start_time": "17:00", "end_time": "18:00", "duration_minutes": 60}, "Japanese Restaurant in Wudaokou": {"start_time": "18:00", "end_time": "19:30", "duration_minutes": 90}, "Return to apartment": {"start_time": "19:30", "end_time": "20:00", "duration_minutes": 30}}, "budget": {"meals": 8.19, "accommodation": 35, "activities": 0, "shopping": 7.8, "transportation": 0, "total": 50.99}}, {"day": 18, "date": "2026-03-04", "location": "Beijing", "location_change": null, "user_requirements": ["\u26a0\ufe0f Girlfriend has class (Wednesday) - no far trips during day", "Evening activities possible"], "breakfast": {"name": "Local Breakfast near Apartment", "location": "Near rental apartment", "cost": 8, "cuisine": "Beijing Breakfast", "notes": "Wednesday - girlfriend has class. Local breakfast."}, "lunch": {"name": "Lunch near Apartment", "location": "Near rental apartment (no far trips)", "cost": 15, "cuisine": "Chinese", "notes": "NO FAR TRIPS (girlfriend has class). Stay near apartment during day."}, "dinner": {"name": "Sichuan Restaurant", "location": "Haidian District", "cost": 35, "cuisine": "Sichuan", "notes": "Evening activities possible. Spicy Sichuan food. Many options in university area."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "Previous day", "check_out": "March 7, 2026", "notes": "Continuing stay in rental apartment"}, "attractions": [], "entertainment": [], "shopping": [{"name": "University Area Shopping", "location": "Near Tsinghua/Peking University, Haidian District", "cost": 60, "type": "Local Shopping", "notes": "Evening shopping after girlfriend's class. Local shops, youth fashion. Affordable clothing and accessories. Good for comfort zone exploration."}], "free_time": [], "timeline": {"Local Breakfast near Apartment": {"start_time": "07:30", "end_time": "08:15", "duration_minutes": 45}, "Girlfriend has class (no far trips)": {"start_time": "08:30", "end_time": "16:30", "duration_minutes": 480}, "Lunch near Apartment": {"start_time": "11:30", "end_time": "12:30", "duration_minutes": 60}, "Local activities near apartment": {"start_time": "13:00", "end_time": "17:30", "duration_minutes": 270}, "Sichuan Restaurant": {"start_time": "18:00", "end_time": "19:30", "duration_minutes": 90}, "Return to apartment": {"start_time": "19:30", "end_time": "20:00", "duration_minutes": 30}}, "budget": {"meals": 7.59, "accommodation": 35, "activities": 0, "shopping": 7.8, "transportation": 0, "total": 50.39}}, {"day": 19, "date": "2026-03-05", "location": "Beijing", "location_change": null, "user_requirements": ["\u26a0\ufe0f Girlfriend has class (Thursday) - no far trips during day", "Evening activities possible"], "breakfast": {"name": "Local Breakfast near Apartment", "location": "Near rental apartment", "cost": 8, "cuisine": "Beijing Breakfast", "notes": "Thursday - girlfriend has class. Local breakfast."}, "lunch": {"name": "Lunch near Apartment", "location": "Near rental apartment (no far trips)", "cost": 15, "cuisine": "Chinese", "notes": "NO FAR TRIPS (girlfriend has class). Stay near apartment during day."}, "dinner": {"name": "Western Restaurant", "location": "Wudaokou or Zhongguancun", "cost": 45, "cuisine": "Western", "notes": "Evening activities possible. Change of pace with Western food. Pizza or pasta options."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "Previous day", "check_out": "March 7, 2026", "notes": "Continuing stay in rental apartment"}, "attractions": [], "entertainment": [], "shopping": [{"name": "University Area Shopping", "location": "Near Tsinghua/Peking University, Haidian District", "cost": 60, "type": "Local Shopping", "notes": "Evening shopping after girlfriend's class. Local shops, youth fashion. Affordable clothing and accessories. Good for comfort zone exploration."}], "free_time": [], "timeline": {"Local Breakfast near Apartment": {"start_time": "07:30", "end_time": "08:15", "duration_minutes": 45}, "Girlfriend has class (no far trips)": {"start_time": "08:30", "end_time": "16:30", "duration_minutes": 480}, "Lunch near Apartment": {"start_time": "11:30", "end_time": "12:30", "duration_minutes": 60}, "Local activities near apartment": {"start_time": "13:00", "end_time": "17:30", "duration_minutes": 270}, "Western Restaurant": {"start_time": "18:00", "end_time": "20:00", "duration_minutes": 120}, "Return to apartment": {"start_time": "20:00", "end_time": "20:30", "duration_minutes": 30}}, "budget": {"meals": 8.89, "accommodation": 35, "activities": 0, "shopping": 7.8, "transportation": 0, "total": 51.69}}, {"day": 20, "date": "2026-03-06", "location": "Beijing", "location_change": null, "user_requirements": ["Final day together activities", "Shopping, memorable experiences"], "breakfast": {"name": "Special Breakfast Spot", "location": "Trendy area in Beijing", "cost": 20, "cuisine": "Western/Brunch", "notes": "Final day together. Special brunch experience. Make it memorable."}, "lunch": {"name": "Shopping Mall Restaurant", "location": "Sanlitun or Wangfujing", "cost": 35, "cuisine": "International", "notes": "Lunch during final shopping trip. Mall dining convenient."}, "dinner": {"name": "Special Farewell Dinner", "location": "Upscale restaurant in Beijing", "cost": 80, "cuisine": "Fine Dining", "notes": "FINAL DINNER TOGETHER. Memorable and romantic. Choose nice restaurant with good ambiance. Make reservations."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "Previous day", "check_out": "March 7, 2026", "notes": "Continuing stay in rental apartment"}, "attractions": [{"name": "Final Day Activities - Shopping & Memorable Experiences", "location": "Various", "cost": 0, "duration_minutes": 480, "type": "Flexible", "notes": "Last full day together. Options: (1) Revisit favorite spots from trip. (2) Final shopping for gifts/souvenirs. (3) Lama Temple (\u96cd\u548c\u5bab) - beautiful Tibetan Buddhist temple. (4) National Centre for Performing Arts if special show available. (5) Romantic dinner at special restaurant (see meals agent). (6) Photography at scenic spots. Make it memorable."}], "entertainment": [{"name": "Final Shopping Day - Cute Toys and Souvenirs", "location": "Wangfujing or Guomao area", "cost": 200, "time": "11:00", "type": "Shopping/Entertainment", "notes": "Last chance for cute toy purchases and memorable souvenirs. Visit favorite spots from earlier days. Budget for final purchases."}], "shopping": [{"name": "SKP Beijing (\u534e\u8d38\u5929\u5730)", "location": "No.87 Jianguo Road, Chaoyang District", "cost": 300, "type": "Luxury Mall", "notes": "High-end luxury shopping for final day. International designer brands. Premium shopping experience. Good for memorable purchases. Open 10am-10pm."}, {"name": "Galeries Lafayette Beijing", "location": "Xidan area, Xicheng District", "cost": 250, "type": "Department Store", "notes": "French department store with fashion and accessories. Good for final shopping. Quality items. Less crowded than SKP. Open 10am-10pm."}, {"name": "Local Tea Shops (\u8336\u53f6\u5e97)", "location": "Various locations, Dongcheng District", "cost": 100, "type": "Specialty Store", "notes": "Purchase Chinese tea as gifts/souvenirs. Authentic local products. Good for memorable items. Ask for packaging suitable for air travel. Quality varies by shop."}], "free_time": [], "timeline": {"Special Breakfast Spot": {"start_time": "08:30", "end_time": "10:00", "duration_minutes": 90}, "Travel to shopping area": {"start_time": "10:00", "end_time": "10:30", "duration_minutes": 30}, "Final Shopping Day - Cute Toys and Souvenirs": {"start_time": "10:30", "end_time": "12:30", "duration_minutes": 120}, "Shopping Mall Restaurant": {"start_time": "12:30", "end_time": "14:00", "duration_minutes": 90}, "Shopping for Fashion Items": {"start_time": "14:00", "end_time": "17:00", "duration_minutes": 180}, "Final Day Activities - Shopping & Memorable Experiences": {"start_time": "17:00", "end_time": "18:30", "duration_minutes": 90}, "Travel to dinner location": {"start_time": "18:30", "end_time": "19:00", "duration_minutes": 30}, "Special Farewell Dinner": {"start_time": "19:00", "end_time": "21:30", "duration_minutes": 150}, "Return to apartment": {"start_time": "21:30", "end_time": "22:00", "duration_minutes": 30}}, "budget": {"meals": 17.55, "accommodation": 35, "activities": 0, "shopping": 84.5, "transportation": 0, "total": 137.05}}, {"day": 21, "date": "2026-03-07", "location": "Beijing", "location_change": null, "user_requirements": ["Departure day preparations", "Final goodbyes"], "breakfast": {"name": "Breakfast near Apartment", "location": "Near rental apartment", "cost": 10, "cuisine": "Chinese", "notes": "Departure day. Light breakfast. Time for final goodbyes."}, "lunch": {"name": "Airport or Near Apartment", "location": "Beijing Capital Airport or near apartment", "cost": 20, "cuisine": "Chinese/Airport Food", "notes": "Depends on departure time. Airport meal or final lunch together before goodbye."}, "dinner": {"name": "N/A - Departure Day", "location": "N/A", "cost": 0, "cuisine": "N/A", "notes": "Departure day. Likely no dinner or in-flight meal."}, "accommodation": {"name": "Short-term Rental Apartment (TBD)", "location": "Near Tsinghua University/Peking University, Haidian District, Beijing", "cost": 35, "type": "Vacation Rental / Short-term Apartment", "amenities": ["Full kitchen", "WiFi", "Washing machine", "Living space", "Bedroom(s)"], "check_in": "Previous day", "check_out": "Morning (departure day)", "notes": "Final night in rental apartment. Check out for departure"}, "attractions": [], "entertainment": [], "shopping": [], "free_time": [], "timeline": {"Breakfast near Apartment": {"start_time": "08:00", "end_time": "09:00", "duration_minutes": 60}, "Final packing and preparations": {"start_time": "09:00", "end_time": "11:00", "duration_minutes": 120}, "Airport or Near Apartment": {"start_time": "11:00", "end_time": "12:00", "duration_minutes": 60}, "Departure day preparations": {"start_time": "12:00", "end_time": "15:00", "duration_minutes": 180}, "Final goodbyes": {"start_time": "15:00", "end_time": "16:00", "duration_minutes": 60}}, "budget": {"meals": 3.9, "accommodation": 35, "activities": 0, "shopping": 0, "transportation": 0, "total": 38.9}}], "emergency_info": {"hospitals": [], "police_stations": [], "embassy": null}};
    const PROJECT_TYPE = "itinerary";

    const WARM_COLORS = [
      '#D4AF37', '#8B7355', '#D4A574', '#B5695F', '#8FAF7A',
      '#C9A86A', '#A67B5B', '#E8C5A5', '#9B7357', '#B8956A'
    ];

    const SKILL_ICON_MAPPING = {
      'google-maps': { icon: 'fa-map-marked-alt', class: 'google-maps' },
      'gaode-maps': { icon: 'fa-map-pin', class: 'gaode-maps' },
      'rednote': { icon: 'fa-book-open', class: 'rednote' },
      'airbnb': { icon: 'fa-home', class: 'airbnb' }
    };

    function renderSkillIcons(searchResults) {
      if (!searchResults || !Array.isArray(searchResults) || searchResults.length === 0) {
        return '';
      }

      const uniqueUrls = new Map();
      searchResults.forEach(result => {
        if (result.url && !uniqueUrls.has(result.url)) {
          uniqueUrls.set(result.url, result);
        }
      });

      if (uniqueUrls.size === 0) return '';

      let html = '<span class="skill-icons">';
      uniqueUrls.forEach(result => {
        const mapping = SKILL_ICON_MAPPING[result.skill];
        if (mapping) {
          html += `<a href="${result.url}" target="_blank" class="skill-icon-btn ${mapping.class}" title="${result.display_text || result.skill}">`;
          html += `<i class="fas ${mapping.icon}"></i>`;
          html += '</a>';
        }
      });
      html += '</span>';

      return html;
    }

    const CATEGORY_MAPPINGS = {
      attraction_types: {
        'historical_site': 'Historical Site',
        'museum': 'Museum',
        'temple': 'Temple',
        'natural_scenery': 'Natural Scenery',
        'park': 'Park',
        'cultural_experience': 'Cultural Experience',
        'ancient_architecture': 'Ancient Architecture',
        'modern_landmark': 'Modern Landmark',
        'unesco_heritage': 'UNESCO Heritage',
        'scenic_spot': 'Scenic Spot',
        'night_view': 'Night View',
        'street_food': 'Street Food Area',
        'shopping_district': 'Shopping District'
      },
      hotel_categories: {
        'budget': 'Budget Hotel',
        'mid-range': 'Mid-Range Hotel',
        'high-end': 'High-End Hotel',
        'luxury': 'Luxury Hotel',
        'boutique': 'Boutique Hotel',
        'hostel': 'Hostel',
        'guesthouse': 'Guesthouse'
      },
      restaurant_categories: {
        'local': 'Local Cuisine',
        'street_food': 'Street Food',
        'fine_dining': 'Fine Dining',
        'casual': 'Casual Dining',
        'fast_food': 'Fast Food',
        'vegetarian': 'Vegetarian',
        'halal': 'Halal',
        'international': 'International',
        'cafe': 'Caf',
        'teahouse': 'Teahouse'
      },
      entertainment_types: {
        'show': 'Show',
        'nightlife': 'Nightlife',
        'bar': 'Bar',
        'club': 'Club',
        'karaoke': 'Karaoke',
        'theater': 'Theater',
        'cinema': 'Cinema',
        'live_music': 'Live Music'
      }
    };

    function formatCategoryLabel(code, type) {
      if (!code) return '';

      let mapping;
      if (type === 'attraction') {
        mapping = CATEGORY_MAPPINGS.attraction_types;
      } else if (type === 'hotel') {
        mapping = CATEGORY_MAPPINGS.hotel_categories;
      } else if (type === 'restaurant') {
        mapping = CATEGORY_MAPPINGS.restaurant_categories;
      } else if (type === 'entertainment') {
        mapping = CATEGORY_MAPPINGS.entertainment_types;
      } else {
        return code;
      }

      return mapping[code] || code;
    }

    function formatAddress(address) {
      if (!address || address === null || address === 'null' || address.trim() === '') {
        return 'Address not available';
      }
      return address;
    }

    function showDetailPanel(title, content) {
      document.getElementById('detail-panel-title').textContent = title;
      document.getElementById('detail-panel-content').innerHTML = content;
      document.getElementById('detail-panel').classList.add('open');
      document.getElementById('detail-overlay').classList.add('open');
    }

    function closeDetailPanel() {
      document.getElementById('detail-panel').classList.remove('open');
      document.getElementById('detail-overlay').classList.remove('open');
    }

    function showCityDetailPanel(cityIndex) {
      if (PROJECT_TYPE === "bucket-list" && PLAN_DATA.cities) {
        const city = PLAN_DATA.cities[cityIndex];
        if (city) {
          const content = renderCityContent(city);
          showDetailPanel(city.city, content);
        }
      }
    }

    function init() {
      renderHeader();
      renderTabs();
      renderStats();
      renderCharts();
      renderCities();
      renderBudgetCharts();
      renderTimeline();
    }

    function renderHeader() {
      if (PROJECT_TYPE === "itinerary" && PLAN_DATA.days) {
        const firstDay = PLAN_DATA.days[0];
        const lastDay = PLAN_DATA.days[PLAN_DATA.days.length - 1];
        document.getElementById('trip-title').textContent = `${firstDay.location} Travel Plan`;
        document.getElementById('trip-meta').textContent =
          `${firstDay.date} to ${lastDay.date}  ${PLAN_DATA.days.length} days`;
      } else if (PROJECT_TYPE === "bucket-list" && PLAN_DATA.cities) {
        document.getElementById('trip-title').textContent = PLAN_DATA.title || "Travel Bucket List";
        document.getElementById('trip-meta').textContent = `${PLAN_DATA.cities.length} cities to explore`;
      }
    }

    function renderTabs() {
      const tabsHtml = `
        <button class="tab active" onclick="switchTab('overview')">
          <i class="fas fa-chart-pie"></i> Overview
        </button>
        <button class="tab" onclick="switchTab('cities')">
          <i class="fas fa-city"></i> Cities
        </button>
        <button class="tab" onclick="switchTab('budget')">
          <i class="fas fa-money-bill-wave"></i> Budget
        </button>
        <button class="tab" onclick="switchTab('timeline')">
          <i class="fas fa-calendar-days"></i> Timeline
        </button>
      `;
      document.getElementById('tabs-container').innerHTML = tabsHtml;
    }

    function switchTab(tabName) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

      event.target.closest('.tab').classList.add('active');
      document.getElementById(`${tabName}-tab`).classList.add('active');
    }

    function renderStats() {
      let stats = [];
      if (PROJECT_TYPE === "itinerary" && PLAN_DATA.days) {
        const totalBudget = PLAN_DATA.days.reduce((sum, day) => sum + (day.budget && day.budget.total || 0), 0);
        const totalAttractions = PLAN_DATA.days.reduce((sum, day) => sum + (day.attractions && day.attractions.length || 0), 0);
        const uniqueCities = new Set(PLAN_DATA.days.map(d => d.location)).size;
        stats = [
          { icon: 'fa-calendar-days', label: 'Days', value: PLAN_DATA.days.length },
          { icon: 'fa-money-bill-wave', label: 'Total Budget', value: `${totalBudget.toFixed(2)}` },
          { icon: 'fa-landmark', label: 'Attractions', value: totalAttractions },
          { icon: 'fa-city', label: 'Cities', value: uniqueCities }
        ];
      } else if (PROJECT_TYPE === "bucket-list" && PLAN_DATA.cities) {
        const totalAttractions = PLAN_DATA.cities.reduce((sum, city) => sum + (city.attractions && city.attractions.length || 0), 0);
        stats = [
          { icon: 'fa-city', label: 'Cities', value: PLAN_DATA.cities.length },
          { icon: 'fa-landmark', label: 'Attractions', value: totalAttractions },
          { icon: 'fa-hotel', label: 'Hotels', value: PLAN_DATA.cities.reduce((sum, c) => sum + (c.hotels && c.hotels.length || 0), 0) },
          { icon: 'fa-utensils', label: 'Restaurants', value: PLAN_DATA.cities.reduce((sum, c) => sum + (c.restaurants && c.restaurants.length || 0), 0) }
        ];
      }

      document.getElementById('stats-container').innerHTML = stats.map(s => `
        <div class="stat-card">
          <i class="fas ${s.icon} stat-icon"></i>
          <div class="stat-value">${s.value}</div>
          <div class="stat-label">${s.label}</div>
        </div>
      `).join('');
    }

    function renderCharts() {
      if (PROJECT_TYPE === "itinerary" && PLAN_DATA.days) {
        renderItineraryCharts();
      } else if (PROJECT_TYPE === "bucket-list" && PLAN_DATA.cities) {
        renderBucketListCharts();
      }
    }

    function renderItineraryCharts() {
      const budgetByCity = {};
      const attractionTypes = {};

      PLAN_DATA.days.forEach(day => {
        const city = day.location;
        budgetByCity[city] = (budgetByCity[city] || 0) + (day.budget && day.budget.total || 0);

        if (day.attractions) {
          day.attractions.forEach(attr => {
            const type = attr.type || 'general';
            attractionTypes[type] = (attractionTypes[type] || 0) + 1;
          });
        }
      });

      const chartsHtml = `
        <div class="chart-card">
          <div class="chart-title">
            <i class="fas fa-chart-bar"></i> Budget by City
          </div>
          <div class="chart-container">
            <canvas id="budgetByCityChart"></canvas>
          </div>
        </div>
        <div class="chart-card">
          <div class="chart-title">
            <i class="fas fa-chart-pie"></i> Attraction Types
          </div>
          <div class="chart-container">
            <canvas id="attractionTypesChart"></canvas>
          </div>
        </div>
      `;
      document.getElementById('charts-container').innerHTML = chartsHtml;

      new Chart(document.getElementById('budgetByCityChart'), {
        type: 'bar',
        data: {
          labels: Object.keys(budgetByCity),
          datasets: [{
            label: 'Budget (EUR)',
            data: Object.values(budgetByCity),
            backgroundColor: WARM_COLORS[0],
            borderRadius: 4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: { beginAtZero: true }
          }
        }
      });

      new Chart(document.getElementById('attractionTypesChart'), {
        type: 'doughnut',
        data: {
          labels: Object.keys(attractionTypes).map(type => formatCategoryLabel(type, 'attraction')),
          datasets: [{
            data: Object.values(attractionTypes),
            backgroundColor: WARM_COLORS,
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'right',
              labels: {
                usePointStyle: true,
                padding: 15
              }
            }
          }
        }
      });
    }

    function renderBucketListCharts() {
      const attractionsByCity = {};
      const attractionTypes = {};

      PLAN_DATA.cities.forEach(city => {
        attractionsByCity[city.city] = city.attractions && city.attractions.length || 0;

        if (city.attractions) {
          city.attractions.forEach(attr => {
            const type = attr.type || 'general';
            attractionTypes[type] = (attractionTypes[type] || 0) + 1;
          });
        }
      });

      const chartsHtml = `
        <div class="chart-card">
          <div class="chart-title">
            <i class="fas fa-chart-bar"></i> Attractions by City
          </div>
          <div class="chart-container">
            <canvas id="attractionsByCityChart"></canvas>
          </div>
        </div>
        <div class="chart-card">
          <div class="chart-title">
            <i class="fas fa-chart-pie"></i> Attraction Types
          </div>
          <div class="chart-container">
            <canvas id="attractionTypesChart"></canvas>
          </div>
        </div>
      `;
      document.getElementById('charts-container').innerHTML = chartsHtml;

      new Chart(document.getElementById('attractionsByCityChart'), {
        type: 'bar',
        data: {
          labels: Object.keys(attractionsByCity),
          datasets: [{
            label: 'Attractions',
            data: Object.values(attractionsByCity),
            backgroundColor: WARM_COLORS[0],
            borderRadius: 4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'y',
          onClick: (event, elements) => {
            if (elements.length > 0) {
              const index = elements[0].index;
              const cityName = Object.keys(attractionsByCity)[index];
              const city = PLAN_DATA.cities.find(c => c.city === cityName);
              if (city) {
                const content = renderCityContent(city);
                showDetailPanel(cityName, content);
              }
            }
          },
          plugins: {
            legend: { display: false }
          },
          scales: {
            x: { beginAtZero: true }
          }
        }
      });

      new Chart(document.getElementById('attractionTypesChart'), {
        type: 'doughnut',
        data: {
          labels: Object.keys(attractionTypes).map(type => formatCategoryLabel(type, 'attraction')),
          datasets: [{
            data: Object.values(attractionTypes),
            backgroundColor: WARM_COLORS,
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          onClick: (event, elements) => {
            if (elements.length > 0) {
              const index = elements[0].index;
              const typeCode = Object.keys(attractionTypes)[index];
              const typeLabel = formatCategoryLabel(typeCode, 'attraction');
              let content = '<div class="activity-grid">';
              PLAN_DATA.cities.forEach(city => {
                if (city.attractions) {
                  city.attractions.forEach(attr => {
                    if (attr.type === typeCode) {
                      const formattedAddress = attr.location || attr.address || attr.how_to_get_there;
                      const skillIcons = renderSkillIcons(attr.search_results);
                      content += '<div class="activity-card"><h4>' + attr.name + skillIcons + '</h4>';
                      content += '<p style="color: var(--color-secondary);"><i class="fas fa-city"></i> ' + city.city + '</p>';
                      if (formattedAddress) content += '<p><i class="fas fa-map-marker-alt"></i> ' + formattedAddress + '</p>';
                      if (attr.description) content += '<p>' + attr.description + '</p>';
                      if (attr.ticket_price_eur) content += '<p class="cost"><i class="fas fa-ticket-alt"></i> ' + attr.ticket_price_eur + '</p>';
                      content += '</div>';
                    }
                  });
                }
              });
              content += '</div>';
              showDetailPanel(typeLabel + ' Attractions', content);
            }
          },
          plugins: {
            legend: {
              position: 'right',
              labels: {
                usePointStyle: true,
                padding: 15
              }
            }
          }
        }
      });
    }

    function renderCities() {
      let citiesHtml = '';

      if (PROJECT_TYPE === "itinerary" && PLAN_DATA.days) {
        citiesHtml = PLAN_DATA.days.map((day, idx) => `
          <div class="accordion-item" id="city-${idx}">
            <div class="accordion-header" onclick="toggleAccordion(${idx})">
              <h3>
                <i class="fas fa-map-marker-alt"></i>
                Day ${day.day}: ${day.location} - ${day.date}
              </h3>
              <i class="fas fa-chevron-down accordion-icon"></i>
            </div>
            <div class="accordion-content">
              <div class="accordion-body">
                ${renderDayContent(day)}
              </div>
            </div>
          </div>
        `).join('');
      } else if (PROJECT_TYPE === "bucket-list" && PLAN_DATA.cities) {
        citiesHtml = PLAN_DATA.cities.map((city, idx) => `
          <div class="accordion-item" id="city-${idx}">
            <div class="accordion-header" onclick="toggleAccordion(${idx}); event.stopPropagation();">
              <h3 onclick="event.stopPropagation(); showCityDetailPanel(${idx});" style="cursor: pointer;">
                <i class="fas fa-city"></i>
                ${city.city}${city.province ? ', ' + city.province : ''}
              </h3>
              <i class="fas fa-chevron-down accordion-icon"></i>
            </div>
            <div class="accordion-content">
              <div class="accordion-body">
                ${renderCityContent(city)}
              </div>
            </div>
          </div>
        `).join('');
      }

      document.getElementById('cities-accordion').innerHTML = citiesHtml;
    }

    function toggleAccordion(idx) {
      const item = document.getElementById(`city-${idx}`);
      item.classList.toggle('active');
    }

    function renderDayContent(day) {
      let html = '';

      if (day.attractions && day.attractions.length > 0) {
        html += '<h4 style="color: var(--color-accent); margin-bottom: 1rem;"><i class="fas fa-landmark"></i> Attractions</h4>';
        html += '<div class="activity-grid">';
        day.attractions.forEach(attr => {
          const formattedAddress = formatAddress(attr.location || attr.address);
          const formattedType = formatCategoryLabel(attr.type, 'attraction');
          const skillIcons = renderSkillIcons(attr.search_results);
          html += `<div class="activity-card">
            <h4>${attr.name}${skillIcons}</h4>
            <p><i class="fas fa-map-marker-alt"></i> ${formattedAddress}</p>
            <p class="cost"><i class="fas fa-euro-sign"></i> ${attr.cost_eur || attr.cost || 0}</p>
            ${formattedType ? `<span class="type-badge">${formattedType}</span>` : ''}
          </div>`;
        });
        html += '</div>';
      }

      if (day.hotels && day.hotels.length > 0 || day.accommodation && day.accommodation.name) {
        html += '<h4 style="color: var(--color-accent); margin: 1.5rem 0 1rem;"><i class="fas fa-hotel"></i> Accommodation</h4>';
        html += '<div class="activity-grid">';
        if (day.accommodation && day.accommodation.name) {
          const formattedAddress = formatAddress(day.accommodation.location || day.accommodation.address);
          const formattedCategory = formatCategoryLabel(day.accommodation.category, 'hotel');
          const skillIcons = renderSkillIcons(day.accommodation.search_results);
          html += `<div class="activity-card">
            <h4>${day.accommodation.name}${skillIcons}</h4>
            <p><i class="fas fa-map-marker-alt"></i> ${formattedAddress}</p>
            ${formattedCategory ? `<p><i class="fas fa-star"></i> ${formattedCategory}</p>` : ''}
            <p class="cost"><i class="fas fa-euro-sign"></i> ${day.accommodation.cost_eur || 0}</p>
          </div>`;
        }
        html += '</div>';
      }

      if (day.restaurants && day.restaurants.length > 0 || day.breakfast && day.breakfast.name || day.lunch && day.lunch.name || day.dinner && day.dinner.name) {
        html += '<h4 style="color: var(--color-accent); margin: 1.5rem 0 1rem;"><i class="fas fa-utensils"></i> Dining</h4>';
        html += '<div class="activity-grid">';
        ['breakfast', 'lunch', 'dinner'].forEach(meal => {
          if (day[meal] && day[meal].name) {
            const formattedAddress = formatAddress(day[meal].location || day[meal].address);
            const formattedCategory = formatCategoryLabel(day[meal].category || day[meal].type, 'restaurant');
            const skillIcons = renderSkillIcons(day[meal].search_results);
            html += `<div class="activity-card">
              <h4>${meal.charAt(0).toUpperCase() + meal.slice(1)}: ${day[meal].name}${skillIcons}</h4>
              <p><i class="fas fa-map-marker-alt"></i> ${formattedAddress}</p>
              ${formattedCategory ? `<p><i class="fas fa-tag"></i> ${formattedCategory}</p>` : ''}
              <p class="cost"><i class="fas fa-euro-sign"></i> ${day[meal].cost_eur || day[meal].cost || 0}</p>
            </div>`;
          }
        });
        html += '</div>';
      }

      if (day.entertainment && day.entertainment.length > 0) {
        html += '<h4 style="color: var(--color-accent); margin: 1.5rem 0 1rem;"><i class="fas fa-masks-theater"></i> Entertainment</h4>';
        html += '<div class="activity-grid">';
        day.entertainment.forEach(ent => {
          const formattedAddress = formatAddress(ent.location || ent.address);
          const formattedType = formatCategoryLabel(ent.type, 'entertainment');
          const skillIcons = renderSkillIcons(ent.search_results);
          html += `<div class="activity-card">
            <h4>${ent.name}${skillIcons}</h4>
            <p><i class="fas fa-map-marker-alt"></i> ${formattedAddress}</p>
            ${ent.description ? `<p>${ent.description}</p>` : ''}
            ${formattedType ? `<span class="type-badge">${formattedType}</span>` : ''}
          </div>`;
        });
        html += '</div>';
      }

      if (day.shopping && day.shopping.length > 0) {
        html += '<h4 style="color: var(--color-accent); margin: 1.5rem 0 1rem;"><i class="fas fa-shopping-bag"></i> Shopping</h4>';
        html += '<div class="activity-grid">';
        day.shopping.forEach(shop => {
          const formattedAddress = formatAddress(shop.location || shop.address);
          const skillIcons = renderSkillIcons(shop.search_results);
          html += `<div class="activity-card">
            <h4>${shop.name}${skillIcons}</h4>
            <p><i class="fas fa-map-marker-alt"></i> ${formattedAddress}</p>
            ${shop.description ? `<p>${shop.description}</p>` : ''}
            ${shop.type ? `<span class="type-badge">${shop.type}</span>` : ''}
          </div>`;
        });
        html += '</div>';
      }

      return html || '<p style="color: var(--color-secondary);">No details available</p>';
    }

    function renderCityContent(city) {
      let html = '';

      if (city.attractions && city.attractions.length > 0) {
        html += '<h4 style="color: var(--color-accent); margin-bottom: 1rem;"><i class="fas fa-landmark"></i> Attractions</h4>';
        html += '<div class="activity-grid">';
        city.attractions.forEach(attr => {
          const formattedAddress = attr.location || attr.address || attr.how_to_get_there;
          const formattedType = formatCategoryLabel(attr.type, 'attraction');
          const skillIcons = renderSkillIcons(attr.search_results);
          html += `<div class="activity-card">
            <h4>${attr.name}${skillIcons}</h4>
            ${formattedAddress ? `<p><i class="fas fa-map-marker-alt"></i> ${formattedAddress}</p>` : ''}
            ${attr.description ? `<p>${attr.description}</p>` : ''}
            ${attr.ticket_price_eur ? `<p class="cost"><i class="fas fa-ticket-alt"></i> ${attr.ticket_price_eur}</p>` : ''}
            ${formattedType ? `<span class="type-badge">${formattedType}</span>` : ''}
          </div>`;
        });
        html += '</div>';
      }

      if (city.hotels && city.hotels.length > 0) {
        html += '<h4 style="color: var(--color-accent); margin: 1.5rem 0 1rem;"><i class="fas fa-hotel"></i> Hotels</h4>';
        html += '<div class="activity-grid">';
        city.hotels.forEach(hotel => {
          const formattedAddress = hotel.location || hotel.address;
          const formattedCategory = formatCategoryLabel(hotel.category, 'hotel');
          const skillIcons = renderSkillIcons(hotel.search_results);
          html += '<div class="activity-card">';
          html += '<h4>' + hotel.name + skillIcons + '</h4>';
          if (formattedAddress) html += '<p><i class="fas fa-map-marker-alt"></i> ' + formattedAddress + '</p>';
          if (formattedCategory) html += '<p><i class="fas fa-star"></i> ' + formattedCategory + '</p>';
          if (hotel.price_per_night_eur) html += '<p class="cost"><i class="fas fa-euro-sign"></i> ' + hotel.price_per_night_eur + '/night</p>';
          if (hotel.booking_platforms && hotel.booking_platforms.length > 0) {
            html += '<p class="booking-links"><i class="fas fa-external-link-alt"></i> ';
            hotel.booking_platforms.forEach((platform, idx) => {
              if (idx > 0) html += '  ';
              html += '<a href="https://www.google.com/search?q=' + encodeURIComponent(hotel.name + ' ' + platform) + '" target="_blank" class="booking-link">' + platform + '</a>';
            });
            html += '</p>';
          }
          html += '</div>';
        });
        html += '</div>';
      }

      if (city.restaurants && city.restaurants.length > 0) {
        html += '<h4 style="color: var(--color-accent); margin: 1.5rem 0 1rem;"><i class="fas fa-utensils"></i> Restaurants</h4>';
        html += '<div class="activity-grid">';
        city.restaurants.forEach(rest => {
          const formattedAddress = rest.location || rest.address;
          const formattedCategory = formatCategoryLabel(rest.category || rest.type, 'restaurant');
          const skillIcons = renderSkillIcons(rest.search_results);
          html += `<div class="activity-card">
            <h4>${rest.name}${skillIcons}</h4>
            ${rest.cuisine ? `<p><i class="fas fa-bowl-food"></i> ${rest.cuisine}</p>` : ''}
            ${formattedCategory ? `<p><i class="fas fa-tag"></i> ${formattedCategory}</p>` : ''}
            <p><i class="fas fa-map-marker-alt"></i> ${formattedAddress}</p>
          </div>`;
        });
        html += '</div>';
      }

      if (city.entertainment && city.entertainment.length > 0) {
        html += '<h4 style="color: var(--color-accent); margin: 1.5rem 0 1rem;"><i class="fas fa-masks-theater"></i> Entertainment</h4>';
        html += '<div class="activity-grid">';
        city.entertainment.forEach(ent => {
          const formattedAddress = formatAddress(ent.address || ent.location);
          const formattedType = formatCategoryLabel(ent.type, 'entertainment');
          const skillIcons = renderSkillIcons(ent.search_results);
          html += `<div class="activity-card">
            <h4>${ent.name}${skillIcons}</h4>
            <p><i class="fas fa-map-marker-alt"></i> ${formattedAddress}</p>
            ${ent.description ? `<p>${ent.description}</p>` : ''}
            ${formattedType ? `<span class="type-badge">${formattedType}</span>` : ''}
          </div>`;
        });
        html += '</div>';
      }

      if (city.shopping && city.shopping.length > 0) {
        html += '<h4 style="color: var(--color-accent); margin: 1.5rem 0 1rem;"><i class="fas fa-shopping-bag"></i> Shopping</h4>';
        html += '<div class="activity-grid">';
        city.shopping.forEach(shop => {
          const formattedAddress = formatAddress(shop.address || shop.location);
          const skillIcons = renderSkillIcons(shop.search_results);
          html += `<div class="activity-card">
            <h4>${shop.name}${skillIcons}</h4>
            <p><i class="fas fa-map-marker-alt"></i> ${formattedAddress}</p>
            ${shop.description ? `<p>${shop.description}</p>` : ''}
            ${shop.type ? `<span class="type-badge">${shop.type}</span>` : ''}
          </div>`;
        });
        html += '</div>';
      }

      return html || '<p style="color: var(--color-secondary);">No details available</p>';
    }

    function renderBudgetCharts() {
      if (PROJECT_TYPE === "itinerary" && PLAN_DATA.days) {
        const categories = { meals: 0, accommodation: 0, activities: 0, shopping: 0, transportation: 0 };
        const dailyBudget = [];

        PLAN_DATA.days.forEach(day => {
          if (day.budget) {
            Object.keys(categories).forEach(cat => {
              categories[cat] += day.budget[cat] || 0;
            });
            dailyBudget.push({
              day: `Day ${day.day}`,
              total: day.budget.total || 0
            });
          }
        });

        const budgetHtml = `
          <div class="chart-card">
            <div class="chart-title">
              <i class="fas fa-chart-pie"></i> Budget by Category
            </div>
            <div class="chart-container">
              <canvas id="budgetCategoryChart"></canvas>
            </div>
          </div>
          <div class="chart-card">
            <div class="chart-title">
              <i class="fas fa-chart-line"></i> Daily Budget Trend
            </div>
            <div class="chart-container">
              <canvas id="dailyBudgetChart"></canvas>
            </div>
          </div>
        `;
        document.getElementById('budget-charts').innerHTML = budgetHtml;

        new Chart(document.getElementById('budgetCategoryChart'), {
          type: 'doughnut',
          data: {
            labels: Object.keys(categories).map(k => k.charAt(0).toUpperCase() + k.slice(1)),
            datasets: [{
              data: Object.values(categories),
              backgroundColor: WARM_COLORS,
              borderWidth: 0
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: 'right',
                labels: {
                  usePointStyle: true,
                  padding: 15
                }
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    return context.label + ': ' + context.raw.toFixed(2);
                  }
                }
              }
            }
          }
        });

        new Chart(document.getElementById('dailyBudgetChart'), {
          type: 'line',
          data: {
            labels: dailyBudget.map(d => d.day),
            datasets: [{
              label: 'Budget (EUR)',
              data: dailyBudget.map(d => d.total),
              borderColor: WARM_COLORS[0],
              backgroundColor: 'rgba(212, 175, 55, 0.1)',
              fill: true,
              tension: 0.3,
              pointRadius: 4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false }
            },
            scales: {
              y: { beginAtZero: true }
            }
          }
        });
      } else if (PROJECT_TYPE === "bucket-list" && PLAN_DATA.cities) {
        // Bucket list budget: aggregate estimated budget by city
        const budgetHtml = `
          <div class="chart-card">
            <div class="chart-title">
              <i class="fas fa-chart-bar"></i> Estimated Budget by City
            </div>
            <div class="chart-container">
              <canvas id="cityBudgetChart"></canvas>
            </div>
          </div>
          <div class="budget-summary">
            <h3 style="color: var(--color-accent); margin-bottom: 1rem;">Budget Overview</h3>
            <div class="activity-grid">
              ${PLAN_DATA.cities.map(city => `
                <div class="activity-card">
                  <h4>${city.city}</h4>
                  <p><i class="fas fa-calendar"></i> ${city.recommended_duration}</p>
                  <p class="cost"><i class="fas fa-euro-sign"></i> ${city.estimated_budget_eur} estimated</p>
                </div>
              `).join('')}
            </div>
          </div>
        `;

        document.getElementById('budget-charts').innerHTML = budgetHtml;

        // Create city budget chart
        new Chart(document.getElementById('cityBudgetChart'), {
          type: 'bar',
          data: {
            labels: PLAN_DATA.cities.map(c => c.city),
            datasets: [{
              label: 'Budget (EUR)',
              data: PLAN_DATA.cities.map(c => c.estimated_budget_eur || 0),
              backgroundColor: WARM_COLORS[0],
              borderWidth: 0
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            onClick: (event, elements) => {
              if (elements.length > 0) {
                const index = elements[0].index;
                const city = PLAN_DATA.cities[index];
                if (city) {
                  const content = renderCityContent(city);
                  showDetailPanel(city.city + ' - Budget Details', content);
                }
              }
            },
            plugins: {
              legend: { display: false },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    return 'Budget: ' + context.raw;
                  }
                }
              }
            },
            scales: {
              y: { beginAtZero: true }
            }
          }
        });
      }
    }

    function renderTimeline() {
      let timelineHtml = '';

      if (PROJECT_TYPE === "itinerary" && PLAN_DATA.days) {
        timelineHtml = '<div class="accordion">' + PLAN_DATA.days.map((day, idx) => {
          let dayEvents = [];

          if (day.breakfast && day.breakfast.name) dayEvents.push({ time: '08:00', icon: 'fa-coffee', label: `Breakfast: ${day.breakfast.name}` });
          if (day.lunch && day.lunch.name) dayEvents.push({ time: '12:00', icon: 'fa-utensils', label: `Lunch: ${day.lunch.name}` });
          if (day.dinner && day.dinner.name) dayEvents.push({ time: '19:00', icon: 'fa-utensils', label: `Dinner: ${day.dinner.name}` });
          if (day.attractions && day.attractions.length > 0) {
            day.attractions.forEach(attr => {
              dayEvents.push({ time: '10:00', icon: 'fa-landmark', label: attr.name });
            });
          }

          const eventsHtml = dayEvents.length > 0 ? dayEvents.map(e => `
            <div style="padding: 0.5rem 0; border-left: 3px solid var(--color-accent); padding-left: 1rem; margin-left: 1rem; margin-bottom: 0.5rem;">
              <div style="color: var(--color-accent); font-weight: 600;">
                <i class="fas ${e.icon}"></i> ${e.time}
              </div>
              <div style="color: var(--color-dark);">${e.label}</div>
            </div>
          `).join('') : '<p style="color: var(--color-secondary); padding-left: 2rem;">No scheduled events</p>';

          return `
            <div class="accordion-item" id="timeline-${idx}">
              <div class="accordion-header" onclick="toggleTimelineAccordion(${idx})">
                <h3>
                  <i class="fas fa-calendar-day"></i>
                  Day ${day.day}: ${day.location} - ${day.date}
                </h3>
                <i class="fas fa-chevron-down accordion-icon"></i>
              </div>
              <div class="accordion-content">
                <div class="accordion-body">
                  ${eventsHtml}
                </div>
              </div>
            </div>
          `;
        }).join('') + '</div>';
      } else if (PROJECT_TYPE === "bucket-list" && PLAN_DATA.cities) {
        timelineHtml = '<div class="timeline-list">' + PLAN_DATA.cities.map((city, idx) => `
          <div class="timeline-city-card">
            <h3 style="color: var(--color-accent);"><i class="fas fa-city"></i> ${city.city}</h3>
            <p><i class="fas fa-calendar"></i> <strong>Recommended Duration:</strong> ${city.recommended_duration}</p>
            <p><i class="fas fa-sun"></i> <strong>Best Months:</strong> ${city.best_months.join(', ')}</p>
            ${city.estimated_budget_eur ? `<p><i class="fas fa-euro-sign"></i> <strong>Budget:</strong> ${city.estimated_budget_eur}</p>` : ''}
          </div>
        `).join('') + '</div>';
      } else {
        timelineHtml = '<p style="text-align: center; color: var(--color-secondary); padding: 2rem;">Timeline not available</p>';
      }

      document.getElementById('timeline-container').innerHTML = timelineHtml;
    }

    function toggleTimelineAccordion(idx) {
      const item = document.getElementById(`timeline-${idx}`);
      item.classList.toggle('active');
    }

    init();
  </script>
</body>
</html>