{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "transportation.schema.json",
  "title": "Transportation Agent Output",
  "description": "Schema for the transportation agent output. Each entry represents a day with location changes (inter-city) or intra-city routes. Uses from_base/to_base bilingual naming convention.",
  "type": "object",
  "properties": {
    "agent": {
      "type": "string",
      "const": "transportation"
    },
    "status": {
      "type": "string",
      "enum": ["complete"]
    },
    "data": {
      "type": "object",
      "properties": {
        "days": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/day_entry"
          }
        }
      },
      "required": ["days"],
      "additionalProperties": true
    },
    "notes": {
      "type": "string"
    }
  },
  "required": ["agent", "status", "data"],
  "additionalProperties": true,

  "$defs": {
    "location_change": {
      "type": "object",
      "description": "A location change (inter-city transportation). Uses from_base/to_base bilingual naming convention.",
      "properties": {
        "from_base": {
          "type": "string",
          "description": "Origin city/location in base language."
        },
        "from_local": {
          "type": "string",
          "description": "Origin city/location in local script."
        },
        "to_base": {
          "type": "string",
          "description": "Destination city/location in base language."
        },
        "to_local": {
          "type": "string",
          "description": "Destination city/location in local script."
        },
        "from_location": {
          "type": "string",
          "description": "Detailed origin address."
        },
        "to_location": {
          "type": "string",
          "description": "Detailed destination address."
        },
        "name_base": {
          "type": "string",
          "description": "Display name in base language e.g. 'Chongqing to Chengdu'."
        },
        "name_local": {
          "type": "string",
          "description": "Display name in local language e.g. '重庆 → 成都'."
        },
        "type_base": {
          "type": "string",
          "description": "Mode of transportation in base language (e.g., 'High-speed train', 'Flight')."
        },
        "type_local": {
          "type": "string",
          "description": "Mode of transportation in local language (e.g., '高铁', '航班')."
        },
        "departure_time": {
          "type": "string",
          "pattern": "^[0-2][0-9]:[0-5][0-9]$",
          "description": "Departure time in HH:MM format."
        },
        "arrival_time": {
          "type": "string",
          "pattern": "^[0-2][0-9]:[0-5][0-9]$",
          "description": "Arrival time in HH:MM format."
        },
        "duration_minutes": {
          "type": "number",
          "minimum": 0,
          "description": "Travel duration in minutes."
        },
        "flight_duration_minutes": {
          "type": "number",
          "minimum": 0,
          "description": "Flight duration in minutes (flights only)."
        },
        "total_journey_minutes": {
          "type": "number",
          "minimum": 0,
          "description": "Total journey time including transfers (flights only)."
        },
        "cost": {
          "$ref": "poi-common.schema.json#/$defs/cost_field"
        },
        "cost_local": {
          "type": "number",
          "description": "Raw cost in local currency."
        },
        "currency": {
          "$ref": "poi-common.schema.json#/$defs/currency_code"
        },
        "cost_type_base": {
          "type": "string",
          "description": "Cost type description in base language (e.g., 'Second class seat')."
        },
        "cost_type_local": {
          "type": "string",
          "description": "Cost type description in local language (e.g., '二等座')."
        },
        "company_base": {
          "type": "string",
          "description": "Transport company in base language."
        },
        "company_local": {
          "type": "string",
          "description": "Transport company in local language."
        },
        "route_number": {
          "type": "string",
          "description": "Route/flight/train number (e.g., 'G8601', 'CA1234')."
        },
        "departure_point_base": {
          "type": "string",
          "description": "Departure station/airport in base language."
        },
        "departure_point_local": {
          "type": "string",
          "description": "Departure station/airport in local language."
        },
        "arrival_point_base": {
          "type": "string",
          "description": "Arrival station/airport in base language."
        },
        "arrival_point_local": {
          "type": "string",
          "description": "Arrival station/airport in local language."
        },
        "status_base": {
          "type": "string",
          "description": "Booking/confirmation status in base language."
        },
        "status_local": {
          "type": "string",
          "description": "Booking/confirmation status in local language."
        },
        "notes_base": {
          "type": "string",
          "description": "Free-form notes in base language."
        },
        "notes_local": {
          "type": "string",
          "description": "Free-form notes in local language."
        },
        "route_details": {
          "type": "object",
          "description": "Detailed route information (freeform structure varies by transport type).",
          "additionalProperties": true
        },
        "booking_required": {
          "type": "boolean",
          "description": "Whether advance booking is needed."
        },
        "data_source": {
          "type": "string",
          "description": "Source of transportation data (e.g., 'user_verified_12306', 'user_provided')."
        }
      },
      "required": ["from_base", "to_base", "type_base", "departure_time", "arrival_time", "cost"],
      "additionalProperties": true
    },

    "day_entry": {
      "type": "object",
      "properties": {
        "day": {
          "type": "integer",
          "minimum": 1,
          "description": "Day number in the trip (1-indexed)."
        },
        "date": {
          "type": "string",
          "description": "Date in YYYY-MM-DD format."
        },
        "location": {
          "type": "string",
          "description": "City or location for this day."
        },
        "location_change": {
          "$ref": "#/$defs/location_change"
        },
        "intra_city_routes": {
          "type": "object",
          "description": "Intra-city route details for days without location changes. Freeform structure with route_N keys.",
          "additionalProperties": true
        }
      },
      "required": ["day"],
      "additionalProperties": true
    }
  }
}
