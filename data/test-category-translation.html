<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Test Category Translation</title>
</head>
<body>
    <div id="output"></div>
    <script>
const CATEGORY_MAPPINGS = {
      attraction_types: {
        // Root cause fix: commit 41f1017 incomplete localization mapping
        // Comprehensive Chinese translations for all attraction types
        'historical_site': '历史遗址',
        'historic_site': '历史遗址',
        'historic site': '历史遗址',
        'museum': '博物馆',
        'temple': '寺庙',
        'natural_scenery': '自然景观',
        'park': '公园',
        'cultural_experience': '文化体验',
        'cultural experience': '文化体验',
        'ancient_architecture': '古建筑',
        'ancient architecture': '古建筑',
        'modern_landmark': '现代地标',
        'unesco_heritage': '世界遗产',
        'unesco world heritage': '世界遗产',
        'scenic_spot': '风景名胜',
        'night_view': '夜景',
        'street_food': '美食街区',
        'food street': '美食街',
        'shopping_district': '购物区',
        'shopping district': '购物区',
        'mountain': '山岳',
        'observation deck': '观景台',
        'tourist attraction': '旅游景点',
        'observation_deck': '观景台',
        'tourist_attraction': '旅游景点',
        'palace': '宫殿',
        'garden': '园林',
        'lake': '湖泊',
        'river': '河流',
        'beach': '海滩',
        'forest': '森林',
        'cave': '洞穴',
        'waterfall': '瀑布',
        'bridge': '桥梁',
        'tower': '塔楼',
        'monument': '纪念碑',
        'square': '广场',
        'street': '街道',
        'market': '市场',
        'zoo': '动物园',
        'aquarium': '水族馆',
        'botanical_garden': '植物园',
        'theme_park': '主题公园',
        'general': '综合景点',
        'other': '其他',
        // Additional mappings for compound categories
        'church': '教堂',
        'historic_building': '历史建筑',
        'historic building': '历史建筑',
        'historic_architecture': '历史建筑',
        'historic architecture': '历史建筑',
        'pedestrian_area': '步行区',
        'pedestrian area': '步行区',
        'pedestrian_street': '步行街',
        'pedestrian street': '步行街',
        'historic_street': '历史街区',
        'historic street': '历史街区',
        'walking_tour': '徒步游览',
        'walking tour': '徒步游览',
        'nightlife': '夜生活',
        'shopping': '购物',
        'buddhist_temple': '佛教寺庙',
        'buddhist temple': '佛教寺庙',
        'buddhist_pagoda': '佛塔',
        'buddhist pagoda': '佛塔',
        'buddhist_statue': '佛像',
        'buddhist statue': '佛像',
        'ancestral_hall': '祠堂',
        'ancestral hall': '祠堂',
        'cable_car': '缆车',
        'cable car': '缆车',
        'scenic_transport': '观光交通',
        'scenic transport': '观光交通',
        'fortification': '防御工事',
        'city_wall': '城墙',
        'city wall': '城墙',
        'colonial_architecture': '殖民建筑',
        'colonial architecture': '殖民建筑',
        'historic_ruins': '历史遗址',
        'historic ruins': '历史遗址',
        'cultural_landmark': '文化地标',
        'cultural landmark': '文化地标',
        'imperial_palace': '皇宫',
        'imperial palace': '皇宫',
        'hot_springs': '温泉',
        'hot springs': '温泉',
        'island': '岛屿',
        'nature': '自然',
        'tourist_area': '旅游区',
        'tourist area': '旅游区',
        'scenic_area': '景区',
        'scenic area': '景区',
        'hiking': '徒步',
        'viewpoint': '观景点',
        'viewpoints': '观景点',
        'archaeological_site': '考古遗址',
        'archaeological site': '考古遗址',
        'national_park': '国家公园',
        'national park': '国家公园',
        'night_market': '夜市',
        'night market': '夜市',
        'street_market': '街市',
        'street market': '街市',
        'observation_tower': '观景塔',
        'observation tower': '观景塔',
        'landmark': '地标',
        'outdoor_performance': '户外演出',
        'outdoor performance': '户外演出',
        'cultural_show': '文化演出',
        'cultural show': '文化演出',
        'cultural_theme_park': '文化主题公园',
        'cultural theme park': '文化主题公园',
        'river_cruise': '游船',
        'river cruise': '游船',
        'scenic_cruise': '观光游船',
        'scenic cruise': '观光游船',
        'river_rafting': '漂流',
        'river rafting': '漂流',
        'scenic_activity': '观光活动',
        'scenic activity': '观光活动',
        'wetland': '湿地',
        'waterfront': '滨水区',
        'stream_valley': '溪谷',
        'stream valley': '溪谷',
        'hiking_trail': '徒步路线',
        'hiking trail': '徒步路线',
        'tea_plantation': '茶园',
        'tea plantation': '茶园',
        'tea_plantation_village': '茶园村',
        'tea plantation village': '茶园村',
        'wetland_park': '湿地公园',
        'wetland park': '湿地公园',
        'nature_reserve': '自然保护区',
        'nature reserve': '自然保护区',
        'wildlife_park': '野生动物园',
        'wildlife park': '野生动物园',
        'tiger_sanctuary': '老虎保护区',
        'tiger sanctuary': '老虎保护区',
        'winter_theme_park': '冬季主题公园',
        'winter theme park': '冬季主题公园',
        'ice_sculpture_park': '冰雕公园',
        'ice sculpture park': '冰雕公园',
        'arts_district': '艺术区',
        'arts district': '艺术区',
        'creative_park': '创意园区',
        'creative park': '创意园区',
        'casino_resort': '赌场度假村',
        'casino resort': '赌场度假村',
        'shopping_mall': '购物中心',
        'shopping mall': '购物中心',
        'entertainment': '娱乐',
        'classical_chinese_garden': '古典园林',
        'classical chinese garden': '古典园林',
        'historic_quarter': '历史街区',
        'historic quarter': '历史街区',
        'historic_district': '历史街区',
        'historic district': '历史街区',
        'historic_canal_street': '历史运河街',
        'historic canal street': '历史运河街',
        'ferris_wheel': '摩天轮',
        'ferris wheel': '摩天轮',
        'observation': '观景',
        'historic_towers': '历史塔楼',
        'historic towers': '历史塔楼',
        'mountain_scenic_area': '山景区',
        'mountain scenic area': '山景区'
      },
      hotel_categories: {
        'budget': '经济型酒店',
        'mid-range': '中档酒店',
        'high-end': '高端酒店',
        'luxury': '豪华酒店',
        'boutique': '精品酒店',
        'hostel': '青年旅舍',
        'guesthouse': '民宿'
      },
      restaurant_categories: {
        'local': '本地美食',
        'street_food': '街边小吃',
        'fine_dining': '高档餐厅',
        'casual': '休闲餐厅',
        'fast_food': '快餐',
        'vegetarian': '素食',
        'halal': '清真',
        'international': '国际美食',
        'cafe': '咖啡厅',
        'teahouse': '茶馆'
      },
      entertainment_types: {
        'show': '演出',
        'nightlife': '夜生活',
        'bar': '酒吧',
        'club': '夜店',
        'karaoke': 'KTV',
        'theater': '剧院',
        'cinema': '电影院',
        'live_music': '现场音乐'
      }
    };

function formatCategoryLabel(code, type) {
      if (!code) return '';

      let mapping;
      if (type === 'attraction') {
        mapping = CATEGORY_MAPPINGS.attraction_types;
      } else if (type === 'hotel') {
        mapping = CATEGORY_MAPPINGS.hotel_categories;
      } else if (type === 'restaurant') {
        mapping = CATEGORY_MAPPINGS.restaurant_categories;
      } else if (type === 'entertainment') {
        mapping = CATEGORY_MAPPINGS.entertainment_types;
      } else {
        return code;
      }

      // Handle compound categories with slashes
      if (code.toString().includes('/')) {
        const parts = code.toString().split('/');
        const translatedParts = [];
        for (const part of parts) {
          const trimmed = part.trim();
          const normalized = trimmed.toLowerCase().replace(/\\s+/g, '_');
          const translated = mapping[normalized] || mapping[trimmed.toLowerCase()] || mapping[trimmed] || trimmed;
          translatedParts.push(translated);
        }
        return translatedParts.join(' / ');
      }

      // Single category: Normalize the code for mapping lookup
      const normalizedCode = code.toString().trim().toLowerCase().replace(/\\s+/g, '_');

      // Try normalized code first, then original code with space normalization
      return mapping[normalizedCode] || mapping[code.toString().trim().toLowerCase()] || mapping[code] || code;
}

// Test cases
const testCases = [
    'Church / Museum / Historic Building',
    'Mountain / Observation Deck / Tourist Attraction',
    'Buddhist Temple / Historic Site',
    'Winter Theme Park / Ice Sculpture Park',
    'Historic Street / Pedestrian Area',
    'museum'
];

let output = 'Compound Category Translation Test Results:\n';
output += '===========================================\n\n';

testCases.forEach(test => {
    const result = formatCategoryLabel(test, 'attraction');
    output += 'Input:  ' + test + '\n';
    output += 'Output: ' + result + '\n';
    output += 'Status: ' + (result !== test && result.includes('/') ? '✓ TRANSLATED' : (result !== test ? '✓ TRANSLATED' : '✗ NOT TRANSLATED')) + '\n\n';
});

console.log(output);
document.getElementById('output').innerHTML = '<pre>' + output + '</pre>';
    </script>
</body>
</html>
