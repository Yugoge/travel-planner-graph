<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>City Guides - 10 cities</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      overflow-x: hidden;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    // Embedded PLAN_DATA
    const PLAN_DATA = {
  "trip_summary": {
    "trip_type": "bucket_list",
    "description": "City Guides - 10 cities",
    "base_location": "Beijing",
    "period": "",
    "travelers": "1 adult",
    "budget_per_trip": "€500",
    "preferences": ""
  },
  "trips": [
    {
      "name": "Xi'an",
      "days_label": "1 day",
      "cover": "https://images.unsplash.com/photo-1583259916581-e2cc0d0e0d66?w=1200&h=400&fit=crop",
      "days": [
        {
          "day": 1,
          "date": "City 1",
          "location": "Xi'an",
          "cover": "https://images.unsplash.com/photo-1583259916581-e2cc0d0e0d66?w=1200&h=400&fit=crop",
          "user_plans": [
            "6 attractions available"
          ],
          "meals": {
            "breakfast": {
              "name": "De Fa Chang Dumpling Restaurant",
              "name_en": "德发长饺子馆",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "lunch": {
              "name": "Lao Sun Jia Restaurant",
              "name_en": "老孙家饭庄",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "dinner": {
              "name": "Xi'an Restaurant",
              "name_en": "西安饭庄",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            }
          },
          "attractions": [
            {
              "name": "Terracotta Army Museum",
              "name_en": "秦始皇兵马俑博物馆",
              "location": "",
              "type": "historical_site",
              "cost": 16,
              "cost_eur": 16,
              "opening_hours": "08:30-18:00 (Mar-Nov), 08:30-17:30 (Dec-Feb)",
              "recommended_duration": "3h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Book tickets online in advance via official website or WeChat mini-program",
                "Hire an audio guide (30 RMB) or English-speaking guide (300-500 RMB) for context",
                "Visit Pit 1 first (most impressive), then Pits 2 and 3"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Xi'an City Wall",
              "name_en": "西安城墙",
              "location": "",
              "type": "historical_site",
              "cost": 7,
              "cost_eur": 7,
              "opening_hours": "08:00-22:00 (summer), 08:00-19:00 (winter)",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Rent a bicycle (45 RMB for 100 minutes) to circle the entire wall (2-3 hours)",
                "South Gate is the most impressive entry point with traditional gate tower",
                "Night performance at South Gate (Tang Dynasty ceremony) - check schedule"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Muslim Quarter",
              "name_en": "回民街",
              "location": "",
              "type": "cultural_district",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (food stalls peak 10:00-22:00)",
              "recommended_duration": "2.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Try classic dishes: roujiamo (肉夹馍), yangrou paomo (羊肉泡馍), liangpi (凉皮)",
                "Visit Great Mosque (化觉巷清真大寺) - 3 EUR entry, blend of Chinese and Islamic architecture",
                "Bargain at markets - start at 50% of asking price"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Big Wild Goose Pagoda",
              "name_en": "大雁塔",
              "location": "",
              "type": "religious_site",
              "cost": 5.5,
              "cost_eur": 5.5,
              "opening_hours": "08:00-17:30 (last entry 17:00)",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Separate ticket to climb pagoda (4 EUR) - 7 floors with city views",
                "Musical fountain show in North Square: 12:00, 16:00, 19:00, 21:00 (summer)",
                "Combine with nearby Tang Paradise theme park if interested"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Shaanxi History Museum",
              "name_en": "陕西历史博物馆",
              "location": "",
              "type": "museum",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "09:00-17:30 (closed Mondays), last entry 16:00",
              "recommended_duration": "2.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "FREE basic admission but MUST book online via official WeChat account or website",
                "Premium tickets for special Tang Dynasty mural hall (40 RMB) - highly recommended",
                "Download audio guide app or rent device (30 RMB)"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Mount Huashan",
              "name_en": "华山",
              "location": "",
              "type": "natural_landscape",
              "cost": 21,
              "cost_eur": 21,
              "opening_hours": "24/7 (cable cars operate 07:00-19:00)",
              "recommended_duration": "8h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Cable car options: North Peak (13 EUR one-way) or West Peak (19 EUR) - saves 3-4 hours hiking",
                "Plank Walk (长空栈道) requires harness rental (4 EUR) - not for those with fear of heights",
                "Bring gloves for chain climbing, water, snacks, and layers (temperature drops at peak)"
              ],
              "time": null,
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": null,
          "budget": {
            "meals": 0,
            "attractions": 49.5,
            "entertainment": 0,
            "accommodation": 0,
            "total": 49.5
          }
        }
      ]
    },
    {
      "name": "Tianjin",
      "days_label": "1 day",
      "cover": "https://images.unsplash.com/photo-1470004914212-05527e49370b?w=1200&h=400&fit=crop",
      "days": [
        {
          "day": 2,
          "date": "City 2",
          "location": "Tianjin",
          "cover": "https://images.unsplash.com/photo-1470004914212-05527e49370b?w=1200&h=400&fit=crop",
          "user_plans": [
            "5 attractions available"
          ],
          "meals": {
            "breakfast": {
              "name": "Shilin Baozi Shop",
              "name_en": "石林包子铺",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "lunch": {
              "name": "Goubuli Baozi (Main Branch)",
              "name_en": "狗不理包子总店",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "dinner": {
              "name": "Qishilin Western Restaurant",
              "name_en": "起士林西餐厅",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            }
          },
          "attractions": [
            {
              "name": "Italian Style Street",
              "name_en": "意大利风情街",
              "location": "",
              "type": "cultural_district",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (shops and cafes typically 10:00-22:00)",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Visit Marco Polo Square (马可波罗广场) - central plaza with fountain",
                "Former residences of Italian celebrities now museums/cafes",
                "Try Italian-Chinese fusion restaurants"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Tianjin Eye",
              "name_en": "天津之眼",
              "location": "",
              "type": "modern_attraction",
              "cost": 9,
              "cost_eur": 9,
              "opening_hours": "09:30-21:30 (weekdays), 09:30-22:00 (weekends)",
              "recommended_duration": "1h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "One rotation takes 28-30 minutes",
                "Book tickets online to skip queue",
                "Capsules hold up to 8 people - may share with others during peak times"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Ancient Culture Street",
              "name_en": "古文化街",
              "location": "",
              "type": "cultural_district",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "09:00-22:00 (shops vary)",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Tianhou Temple (天后宫) at center - small entry fee (2 EUR), dedicated to sea goddess Mazu",
                "Famous for Tianjin clay figurines (泥人张) - traditional folk art",
                "Try local snacks: goubuli baozi (狗不理包子), guifaxiang mahua (桂发祥麻花 - fried dough twists)"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Five Great Avenues",
              "name_en": "五大道",
              "location": "",
              "type": "architectural_district",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (museums within have specific hours)",
              "recommended_duration": "2.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Rent a bicycle or e-bike (15-25 RMB/hour) to cover more ground",
                "Key streets: Machang Dao, Munan Dao, Dali Dao, Chongqing Dao, Chengdu Dao",
                "Some villas open as museums (former residences of celebrities) - 5-10 EUR each"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Porcelain House",
              "name_en": "瓷房子",
              "location": "",
              "type": "museum",
              "cost": 7,
              "cost_eur": 7,
              "opening_hours": "09:00-18:00",
              "recommended_duration": "1h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Located on Chifeng Road in Five Great Avenues area - combine visits",
                "Photography allowed - Instagram-worthy location",
                "Controversial use of antique ceramics but impressive craftsmanship"
              ],
              "time": null,
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": null,
          "budget": {
            "meals": 0,
            "attractions": 16,
            "entertainment": 0,
            "accommodation": 0,
            "total": 16
          }
        }
      ]
    },
    {
      "name": "Suzhou",
      "days_label": "1 day",
      "cover": "https://images.unsplash.com/photo-1609766856923-7e0a23024e9c?w=1200&h=400&fit=crop",
      "days": [
        {
          "day": 3,
          "date": "City 3",
          "location": "Suzhou",
          "cover": "https://images.unsplash.com/photo-1609766856923-7e0a23024e9c?w=1200&h=400&fit=crop",
          "user_plans": [
            "6 attractions available"
          ],
          "meals": {
            "breakfast": {
              "name": "Songhelou Restaurant",
              "name_en": "松鹤楼",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "lunch": {
              "name": "Deyuelou Restaurant",
              "name_en": "得月楼",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "dinner": {
              "name": "Zhuhongxing Noodle Restaurant",
              "name_en": "朱鸿兴面馆",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            }
          },
          "attractions": [
            {
              "name": "Humble Administrator's Garden",
              "name_en": "拙政园",
              "location": "",
              "type": "classical_garden",
              "cost": 11,
              "cost_eur": 11,
              "opening_hours": "07:30-17:30 (Mar-May), 07:30-17:00 (Nov-Feb)",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Book tickets online 1 day in advance via official WeChat or website",
                "Audio guide rental (20 RMB) or English-speaking guide (150-200 RMB) recommended",
                "Visit in sequence: eastern, central, and western gardens for proper flow"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Lingering Garden",
              "name_en": "留园",
              "location": "",
              "type": "classical_garden",
              "cost": 7.5,
              "cost_eur": 7.5,
              "opening_hours": "07:30-17:00",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Famous for covered corridors - 700m of walkways connecting all areas",
                "Guanyun Peak is tallest garden rock in Suzhou - photo highlight",
                "Less crowded than Humble Administrator's Garden"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Pingjiang Road Historic District",
              "name_en": "平江路历史街区",
              "location": "",
              "type": "cultural_district",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (shops 10:00-22:00)",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Walk the full 1.6km length - less touristy at northern end",
                "Try local snacks: Suzhou-style moon cakes, osmanthus cake, chicken feet soup",
                "Hand-embroidery shops - Suzhou embroidery is UNESCO intangible heritage"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Tiger Hill",
              "name_en": "虎丘",
              "location": "",
              "type": "historical_site",
              "cost": 11,
              "cost_eur": 11,
              "opening_hours": "07:30-17:30 (summer), 07:30-17:00 (winter)",
              "recommended_duration": "2.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Climb to pagoda viewpoint (can't enter pagoda itself - structurally unsafe)",
                "Sword Pool legend: King's tomb with 3,000 swords buried with him",
                "Cultural performances in Wanjing Villa theater (check schedule)"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Zhouzhuang Water Town",
              "name_en": "周庄古镇",
              "location": "",
              "type": "water_town",
              "cost": 13.5,
              "cost_eur": 13.5,
              "opening_hours": "08:00-21:00 (day ticket), overnight stay available",
              "recommended_duration": "4h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Buy combo ticket including boat ride (additional 15 RMB)",
                "Key sights: Twin Bridges (双桥), Shen House (沈厅), Zhang House (张厅)",
                "Avoid holidays and weekends - can be overwhelmingly crowded"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Suzhou Museum",
              "name_en": "苏州博物馆",
              "location": "",
              "type": "museum",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "09:00-17:00 (closed Mondays), last entry 16:00",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "FREE but MUST book online via official WeChat or website - tickets released 3 days ahead",
                "Perfect combination with Humble Administrator's Garden (adjacent, same Metro station)",
                "I.M. Pei's tribute to his hometown - notice Suzhou elements in modern design"
              ],
              "time": null,
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": null,
          "budget": {
            "meals": 0,
            "attractions": 43.0,
            "entertainment": 0,
            "accommodation": 0,
            "total": 43.0
          }
        }
      ]
    },
    {
      "name": "Hangzhou",
      "days_label": "1 day",
      "cover": "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=400&fit=crop",
      "days": [
        {
          "day": 4,
          "date": "City 4",
          "location": "Hangzhou",
          "cover": "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=400&fit=crop",
          "user_plans": [
            "6 attractions available"
          ],
          "meals": {
            "breakfast": {
              "name": "Louwailou Restaurant",
              "name_en": "楼外楼",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "lunch": {
              "name": "Zhiweiguan",
              "name_en": "知味观",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "dinner": {
              "name": "Green Tea Restaurant",
              "name_en": "绿茶餐厅",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            }
          },
          "attractions": [
            {
              "name": "West Lake",
              "name_en": "西湖",
              "location": "",
              "type": "natural_landscape",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (temples and attractions have individual hours)",
              "recommended_duration": "4h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Rent a bicycle (15-30 RMB/hour) to circle the lake (15km loop, 2-3 hours)",
                "Key spots: Broken Bridge (断桥残雪), Su Causeway (苏堤春晓), Three Pools Mirroring the Moon (三潭印月)",
                "Boat rides: small boats 55 RMB per person to Three Pools island, or hire private boat (150 RMB)"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Lingyin Temple",
              "name_en": "灵隐寺",
              "location": "",
              "type": "religious_site",
              "cost": 6,
              "cost_eur": 6,
              "opening_hours": "07:00-17:30 (temple), 07:00-18:00 (Feilai Feng scenic area)",
              "recommended_duration": "2.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Two tickets needed: Feilai Feng scenic area (6 EUR) + temple interior (4 EUR)",
                "Feilai Feng grottoes are must-see - allow 1 hour to explore cave carvings",
                "Temple is active worship site - respectful behavior required"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Longjing Tea Plantations",
              "name_en": "龙井茶园",
              "location": "",
              "type": "cultural_experience",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (tea houses typically 08:00-18:00)",
              "recommended_duration": "3h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Visit Longjing Village (more authentic) or Meijiawu (梅家坞, larger, more touristy)",
                "Free plantation walks - many families welcome visitors to their fields",
                "Tea tasting is free but expect soft sell - pre-Qingming tea (明前茶) is most prized"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Xixi National Wetland Park",
              "name_en": "西溪国家湿地公园",
              "location": "",
              "type": "natural_landscape",
              "cost": 11,
              "cost_eur": 11,
              "opening_hours": "08:00-17:30 (Apr-Oct), 08:30-17:00 (Nov-Mar)",
              "recommended_duration": "3h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Electric boat tour (15 EUR) highly recommended - 1.5 hour circuit",
                "East Gate entrance less crowded than South/West gates",
                "Famous for persimmon trees - harvest festival in autumn (October-November)"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Leifeng Pagoda",
              "name_en": "雷峰塔",
              "location": "",
              "type": "historical_site",
              "cost": 5.5,
              "cost_eur": 5.5,
              "opening_hours": "08:00-19:00 (summer), 08:00-17:30 (winter)",
              "recommended_duration": "1h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Elevator inside - no need to climb stairs unless you want to",
                "Top floor offers 360-degree views of West Lake and surrounding hills",
                "Original pagoda ruins preserved beneath glass floor in base"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Hefang Street",
              "name_en": "河坊街",
              "location": "",
              "type": "cultural_district",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (shops 09:00-22:00)",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Try local snacks: beggar's chicken (叫花鸡), West Lake vinegar fish (西湖醋鱼), Hangzhou xiaolongbao",
                "Visit Huqingyu Hall Museum of Traditional Chinese Medicine (胡庆余堂中药博物馆) - 2 EUR",
                "Traditional crafts: silk fans, chopsticks, jade, tea sets"
              ],
              "time": null,
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": null,
          "budget": {
            "meals": 0,
            "attractions": 22.5,
            "entertainment": 0,
            "accommodation": 0,
            "total": 22.5
          }
        }
      ]
    },
    {
      "name": "Guangzhou",
      "days_label": "1 day",
      "cover": "https://images.unsplash.com/photo-1470004914212-05527e49370b?w=1200&h=400&fit=crop",
      "days": [
        {
          "day": 5,
          "date": "City 5",
          "location": "Guangzhou",
          "cover": "https://images.unsplash.com/photo-1470004914212-05527e49370b?w=1200&h=400&fit=crop",
          "user_plans": [
            "7 attractions available"
          ],
          "meals": {
            "breakfast": {
              "name": "Guangzhou Restaurant",
              "name_en": "广州酒家",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "lunch": {
              "name": "Taotaoju",
              "name_en": "陶陶居",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "dinner": {
              "name": "Panxi Restaurant",
              "name_en": "泮溪酒家",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            }
          },
          "attractions": [
            {
              "name": "Canton Tower",
              "name_en": "广州塔",
              "location": "",
              "type": "modern_attraction",
              "cost": 21,
              "cost_eur": 21,
              "opening_hours": "09:30-22:30",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Multiple ticket options: base (108m deck), mid-level (433m), top (488m) - recommend mid-level",
                "Outdoor observation deck (454m) + skywalk available (additional 35 EUR)",
                "Bubble tram Ferris wheel at 450m (world's highest) - additional ticket"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Shamian Island",
              "name_en": "沙面岛",
              "location": "",
              "type": "cultural_district",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Completely pedestrianized - bring comfortable shoes for exploring",
                "Key buildings: Our Lady of Lourdes Chapel (露德圣母堂), former British/French consulates",
                "Charming cafes and Western restaurants - good for breakfast/brunch"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Chen Clan Ancestral Hall",
              "name_en": "陈家祠",
              "location": "",
              "type": "historical_site",
              "cost": 1.4,
              "cost_eur": 1.4,
              "opening_hours": "08:30-17:30 (last entry 17:00)",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Audio guide rental (20 RMB) recommended - explains symbolism of carvings",
                "Famous for 'three carvings, three sculptures, one casting': wood, stone, brick, pottery, plaster, iron",
                "Look up - roof decorations are ceramic figurines depicting opera scenes"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Baiyun Mountain",
              "name_en": "白云山",
              "location": "",
              "type": "natural_landscape",
              "cost": 0.7,
              "cost_eur": 0.7,
              "opening_hours": "06:00-21:00",
              "recommended_duration": "3h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Multiple entrances: South Gate (main entrance), West Gate (Meihua Valley)",
                "Cable car available (35 RMB one-way) to Moxing Ridge summit - saves 1.5 hours hiking",
                "Most popular trail: South Gate to Moxing Ridge peak (2-3 hours round trip)"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Sacred Heart Cathedral",
              "name_en": "石室圣心大教堂",
              "location": "",
              "type": "religious_site",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "08:30-11:30, 14:30-17:30 (closed during services)",
              "recommended_duration": "1h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Free entry but donations welcome",
                "Active church - respectful behavior and dress required (cover shoulders/knees)",
                "Sunday mass in Cantonese at 9:30am - visitors welcome to observe"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Yuexiu Park & Five Rams Statue",
              "name_en": "越秀公园 & 五羊雕像",
              "location": "",
              "type": "park",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "06:00-21:00 (park), 09:00-17:30 (museum)",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Five Rams Statue is must-see photo op - symbol of Guangzhou's founding legend",
                "Zhenhai Tower (Guangzhou Museum) - small fee (1.4 EUR), 5-story tower with city history",
                "Remnants of Ming Dynasty city wall within park"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Beijing Road Pedestrian Street",
              "name_en": "北京路步行街",
              "location": "",
              "type": "shopping_district",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (shops 10:00-22:00)",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Glass-covered archaeological site at center - shows roads from Qin to Qing dynasties",
                "Mix of international brands and local shops",
                "Numerous food courts and restaurants - good for trying Cantonese food"
              ],
              "time": null,
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": null,
          "budget": {
            "meals": 0,
            "attractions": 23.099999999999998,
            "entertainment": 0,
            "accommodation": 0,
            "total": 23.099999999999998
          }
        }
      ]
    },
    {
      "name": "Xiamen",
      "days_label": "1 day",
      "cover": "https://images.unsplash.com/photo-1609766856923-7e0a23024e9c?w=1200&h=400&fit=crop",
      "days": [
        {
          "day": 6,
          "date": "City 6",
          "location": "Xiamen",
          "cover": "https://images.unsplash.com/photo-1609766856923-7e0a23024e9c?w=1200&h=400&fit=crop",
          "user_plans": [
            "7 attractions available"
          ],
          "meals": {
            "breakfast": {
              "name": "Wu Zai Tian Shacha Noodles",
              "name_en": "乌糖沙茶面",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "lunch": {
              "name": "Huang Zehe Peanut Soup",
              "name_en": "黄则和花生汤",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "dinner": {
              "name": "Lujiang Hotel Restaurant",
              "name_en": "鹭江宾馆餐厅",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            }
          },
          "attractions": [
            {
              "name": "Gulangyu Island",
              "name_en": "鼓浪屿",
              "location": "",
              "type": "island",
              "cost": 5,
              "cost_eur": 5,
              "opening_hours": "24/7 (ferry schedule: 07:00-18:30)",
              "recommended_duration": "5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "MUST book ferry tickets 2-5 days in advance online - strict visitor limits (50,000/day)",
                "Overnight stay highly recommended - day-trippers leave by 18:00, island becomes peaceful",
                "Key attractions: Sunlight Rock (日光岩, highest point, 9 EUR), Shuzhuang Garden (菽庄花园), Piano Museum"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Xiamen University",
              "name_en": "厦门大学",
              "location": "",
              "type": "campus",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "12:00-14:00, 17:30-24:00 (visitor access restricted to certain hours)",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "MUST book free entry permit online via WeChat (厦门大学访客预约系统) - released 3 days in advance",
                "Visitor limits and restricted hours due to teaching activities - plan accordingly",
                "Key spots: Furong Lake (芙蓉湖), Furong Tunnel (涂鸦隧道 - graffiti tunnel), Upper Xianyue Road"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Zengcuoan Village",
              "name_en": "曾厝垵",
              "location": "",
              "type": "cultural_district",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (shops/restaurants 10:00-23:00)",
              "recommended_duration": "2.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Try fresh seafood at beachfront restaurants - go early evening for best selection",
                "Famous for beach culture and sunset views",
                "Street food specialties: oyster omelette (海蛎煎), barbecued squid, mango ice"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Nanputuo Temple",
              "name_en": "南普陀寺",
              "location": "",
              "type": "religious_site",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "04:00-18:00 (summer), 04:00-17:00 (winter)",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "FREE entry but ID required for registration",
                "Famous vegetarian restaurant inside - buffet style (8-12 EUR per person), very popular",
                "Hike to Wulao Peak behind temple (1 hour climb) for city views - free access"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Hulishan Fortress",
              "name_en": "胡里山炮台",
              "location": "",
              "type": "historical_site",
              "cost": 3.4,
              "cost_eur": 3.4,
              "opening_hours": "08:00-18:00",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Cannon firing demonstration several times daily - check schedule",
                "Small military museum inside with exhibits on coastal defense",
                "Beautiful coastal scenery - rocky shoreline and Taiwan Strait views"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Zhongshan Road Pedestrian Street",
              "name_en": "中山路步行街",
              "location": "",
              "type": "shopping_district",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (shops 10:00-22:00)",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Arcade architecture (qilou) - covered walkways unique to South China treaty ports",
                "Mix of traditional snack shops and modern brands",
                "Try local specialties: peanut soup (花生汤), satay noodles (沙茶面), spring rolls"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Wanshi Botanical Garden",
              "name_en": "万石植物园",
              "location": "",
              "type": "botanical_garden",
              "cost": 5.5,
              "cost_eur": 5.5,
              "opening_hours": "06:30-18:00",
              "recommended_duration": "3h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "West Gate entrance most popular (closest to rainforest and succulent garden)",
                "Succulent Garden extremely popular for photography - go early to avoid crowds",
                "Rainforest section has elevated walkways through tropical plants"
              ],
              "time": null,
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": null,
          "budget": {
            "meals": 0,
            "attractions": 13.9,
            "entertainment": 0,
            "accommodation": 0,
            "total": 13.9
          }
        }
      ]
    },
    {
      "name": "Guilin",
      "days_label": "1 day",
      "cover": "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=400&fit=crop",
      "days": [
        {
          "day": 7,
          "date": "City 7",
          "location": "Guilin",
          "cover": "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=400&fit=crop",
          "user_plans": [
            "6 attractions available"
          ],
          "meals": {
            "breakfast": {
              "name": "Small Rice Noodle Shop",
              "name_en": "崇善米粉店 (any local shop)",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "lunch": {
              "name": "Yin'gezui Restaurant",
              "name_en": "银子岩餐厅",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "dinner": {
              "name": "Yangshuo West Street Restaurants",
              "name_en": "阳朔西街餐厅",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            }
          },
          "attractions": [
            {
              "name": "Li River Cruise",
              "name_en": "漓江游船",
              "location": "",
              "type": "natural_landscape",
              "cost": 34,
              "cost_eur": 34,
              "opening_hours": "Departures 09:00-10:00 (season dependent)",
              "recommended_duration": "4.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Book 3-5 days in advance online (trip.com, Klook, official website) - sells out quickly",
                "4-hour cruise from Guilin to Yangshuo (one-way) - arrange Yangshuo accommodation in advance",
                "Seat classes: VIP (air-con, top deck, 55 EUR), First Class (34 EUR), Second Class (28 EUR)"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Yangshuo Countryside & West Street",
              "name_en": "阳朔乡村 & 西街",
              "location": "",
              "type": "natural_landscape",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7",
              "recommended_duration": "6h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Rent e-bike or regular bicycle (4-8 EUR per day) to explore countryside",
                "Recommended route: Yangshuo → Yulong River → Ten Mile Gallery (十里画廊) → villages",
                "Yulong River bamboo rafting (遇龙河竹筏) - 17 EUR, more peaceful than Li River"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Reed Flute Cave",
              "name_en": "芦笛岩",
              "location": "",
              "type": "natural_landscape",
              "cost": 16,
              "cost_eur": 16,
              "opening_hours": "08:00-17:30 (summer), 08:30-17:00 (winter)",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Guided tour mandatory (included in ticket, Chinese only) - English audio guides available (4 EUR)",
                "Tour lasts about 60 minutes through 500m route",
                "Temperature inside constant 18°C - bring light jacket"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Longji Rice Terraces",
              "name_en": "龙脊梯田",
              "location": "",
              "type": "natural_landscape",
              "cost": 13.5,
              "cost_eur": 13.5,
              "opening_hours": "07:30-18:00",
              "recommended_duration": "6h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Two main areas: Ping'an Terraces (平安梯田, closer, easier) and Jinkeng/Dazhai Terraces (金坑梯田, more spectacular)",
                "FULL DAY trip from Guilin or stay overnight in village guesthouse (recommended)",
                "Hike from village to viewpoints: Viewpoint 1 (九龙五虎, 30 min), Viewpoint 2 (七星伴月, 1 hour)"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Elephant Trunk Hill",
              "name_en": "象鼻山",
              "location": "",
              "type": "natural_landmark",
              "cost": 9.5,
              "cost_eur": 9.5,
              "opening_hours": "06:30-21:30",
              "recommended_duration": "1h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Can photograph from outside park for free (across river), but entry worthwhile for close views",
                "Climb to Puxian Pagoda on top of 'elephant's back' for river views",
                "Night illumination creates beautiful reflections in river - best photos around 20:00"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Two Rivers and Four Lakes Cruise",
              "name_en": "两江四湖游船",
              "location": "",
              "type": "sightseeing_cruise",
              "cost": 28,
              "cost_eur": 28,
              "opening_hours": "Cruises 19:00-21:00 (night cruise), 14:00-16:00 (day cruise)",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Night cruise more spectacular than daytime - illuminated landmarks and reflections",
                "Book online in advance for better prices and seat selection",
                "Two-hour circuit with audio commentary (Chinese/English)"
              ],
              "time": null,
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": null,
          "budget": {
            "meals": 0,
            "attractions": 101.0,
            "entertainment": 0,
            "accommodation": 0,
            "total": 101.0
          }
        }
      ]
    },
    {
      "name": "Zhangjiajie",
      "days_label": "1 day",
      "cover": "https://images.unsplash.com/photo-1470004914212-05527e49370b?w=1200&h=400&fit=crop",
      "days": [
        {
          "day": 8,
          "date": "City 8",
          "location": "Zhangjiajie",
          "cover": "https://images.unsplash.com/photo-1470004914212-05527e49370b?w=1200&h=400&fit=crop",
          "user_plans": [
            "5 attractions available"
          ],
          "meals": {
            "breakfast": {
              "name": "Hunan Restaurant",
              "name_en": "湘里人家",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "lunch": {
              "name": "Yinmanzuofang Restaurant",
              "name_en": "银满座房",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "dinner": {
              "name": "Scenic Area Restaurants",
              "name_en": "景区餐厅",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            }
          },
          "attractions": [
            {
              "name": "Zhangjiajie National Forest Park (Avatar Mountains)",
              "name_en": "张家界国家森林公园",
              "location": "",
              "type": "natural_landscape",
              "cost": 33,
              "cost_eur": 33,
              "opening_hours": "07:00-18:00 (last entry 16:00)",
              "recommended_duration": "8h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "MULTI-DAY ticket valid for 4 days - plan 2-3 day visit to see main areas",
                "Core scenic areas: Yuanjiajie (袁家界, Avatar Hallelujah Mountain), Tianzi Mountain (天子山), Golden Whip Stream (金鞭溪)",
                "Bailong Elevator (百龙天梯) - world's tallest outdoor elevator (326m), 9.5 EUR one-way, saves 2-hour climb"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Tianmen Mountain & Glass Skywalk",
              "name_en": "天门山 & 玻璃栈道",
              "location": "",
              "type": "natural_landscape",
              "cost": 38,
              "cost_eur": 38,
              "opening_hours": "08:00-16:30 (last cable car up)",
              "recommended_duration": "5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Two routes: Cable car up → explore peak → escalator/stairs down to Tianmen Cave → shuttle bus down 99-Bend Road, OR reverse",
                "Recommended: Cable car UP (better views), then DOWN via road - more logical flow",
                "Glass Skywalk (玻璃栈道) requires separate shoe covers (2 EUR) - not for those with fear of heights!"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Baofeng Lake",
              "name_en": "宝峰湖",
              "location": "",
              "type": "natural_landscape",
              "cost": 13,
              "cost_eur": 13,
              "opening_hours": "07:00-17:30",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Boat tour included in ticket - 30 minutes on lake with commentary",
                "Folk singers perform traditional Tujia songs from boat - unique cultural experience",
                "Baofeng Waterfall at entrance - 1.4 EUR, can skip if short on time"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Zhangjiajie Grand Canyon & Glass Bridge",
              "name_en": "张家界大峡谷 & 玻璃桥",
              "location": "",
              "type": "natural_landscape",
              "cost": 21,
              "cost_eur": 21,
              "opening_hours": "08:00-16:00 (glass bridge), 07:30-17:30 (canyon)",
              "recommended_duration": "4h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Two options: Glass Bridge only (21 EUR) or Bridge + Canyon (32 EUR) - recommend combo",
                "MUST book online 1 day in advance - daily visitor limits (8,000 people)",
                "Glass bridge crossing takes 15-20 minutes - all electronics/bags stored (safety)"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Yellow Dragon Cave",
              "name_en": "黄龙洞",
              "location": "",
              "type": "natural_landscape",
              "cost": 13.5,
              "cost_eur": 13.5,
              "opening_hours": "08:00-17:00",
              "recommended_duration": "2.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Guided tour mandatory (included) - 2-hour route through 3km of chambers",
                "Includes boat ride on underground river",
                "Temperature constant 16°C - bring jacket or sweater"
              ],
              "time": null,
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": null,
          "budget": {
            "meals": 0,
            "attractions": 118.5,
            "entertainment": 0,
            "accommodation": 0,
            "total": 118.5
          }
        }
      ]
    },
    {
      "name": "Hong Kong",
      "days_label": "1 day",
      "cover": "https://images.unsplash.com/photo-1609766856923-7e0a23024e9c?w=1200&h=400&fit=crop",
      "days": [
        {
          "day": 9,
          "date": "City 9",
          "location": "Hong Kong",
          "cover": "https://images.unsplash.com/photo-1609766856923-7e0a23024e9c?w=1200&h=400&fit=crop",
          "user_plans": [
            "7 attractions available"
          ],
          "meals": {
            "breakfast": {
              "name": "Tim Ho Wan",
              "name_en": "添好运",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "lunch": {
              "name": "Yat Lok",
              "name_en": "一乐烧鹅",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "dinner": {
              "name": "Mak's Noodle",
              "name_en": "麥奀記",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            }
          },
          "attractions": [
            {
              "name": "Victoria Peak",
              "name_en": "太平山",
              "location": "",
              "type": "viewpoint",
              "cost": 12,
              "cost_eur": 12,
              "opening_hours": "Peak Tram: 07:00-midnight, Peak Tower: 10:00-23:00",
              "recommended_duration": "2.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Peak Tram round-trip (12 EUR) + Sky Terrace 428 (6 EUR) combo tickets available online",
                "Book tickets online to skip long queues (can be 1-2 hours wait during peak)",
                "For free views, walk to Peak Circle Walk or Lugard Road - no entry fee, better views than paid observation decks"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Tsim Sha Tsui Promenade & Symphony of Lights",
              "name_en": "尖沙咀海滨长廊 & 幻彩咏香江",
              "location": "",
              "type": "waterfront",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (Symphony of Lights show at 20:00 nightly)",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Symphony of Lights show at 20:00 sharp every night (13 minutes) - FREE from promenade",
                "Best viewing spot: Avenue of Stars or Tsim Sha Tsui waterfront (not crowded)",
                "Avenue of Stars: Hong Kong's Walk of Fame with Bruce Lee statue and handprints"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Lantau Island: Big Buddha & Ngong Ping 360",
              "name_en": "大屿山: 天坛大佛 & 昂坪360",
              "location": "",
              "type": "cultural_site",
              "cost": 27,
              "cost_eur": 27,
              "opening_hours": "Cable car: 10:00-18:00 (weekdays), 09:00-18:30 (weekends). Big Buddha: 10:00-17:30",
              "recommended_duration": "4h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Cable car round-trip: Standard Cabin (27 EUR) or Crystal Cabin with glass floor (38 EUR)",
                "Book online 1 day in advance to skip ticket queues (can be very long)",
                "Big Buddha visit FREE but climb 268 steps to reach base"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Central-Mid-Levels Escalators & SoHo",
              "name_en": "中环至半山自动扶梯 & 荷南美食区",
              "location": "",
              "type": "urban_experience",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "Down: 06:00-10:00, Up: 10:30-midnight",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "FREE to ride - just step on (operates as public transport)",
                "Upward direction only after 10:30 (downward only before) - plan accordingly",
                "Hop on/off at different levels to explore neighborhoods: Soho, Mid-Levels"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Dragon's Back Hike",
              "name_en": "龙脊远足径",
              "location": "",
              "type": "hiking_trail",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (daylight hiking recommended)",
              "recommended_duration": "3.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Moderate difficulty - some steep sections but well-maintained trail",
                "Full hike: Shek O Road → Dragon's Back Ridge → Big Wave Bay Beach (3-4 hours)",
                "Bring: plenty of water (2L), sun protection, snacks, proper hiking shoes"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Temple Street Night Market",
              "name_en": "庙街夜市",
              "location": "",
              "type": "night_market",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "18:00-midnight (best 20:00-23:00)",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Bargaining expected - start at 50% of asking price for clothing/souvenirs",
                "Try dai pai dong (大排档) street food: claypot rice, seafood, noodles",
                "Fortune tellers and face readers - cultural experience (20-50 HKD)"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Chi Lin Nunnery & Nan Lian Garden",
              "name_en": "志莲净苑 & 南莲园池",
              "location": "",
              "type": "temple_garden",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "Nunnery: 09:00-16:30, Garden: 07:00-21:00",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Completely FREE - both nunnery and garden",
                "Chi Lin Nunnery built entirely with wood in Tang Dynasty style - no nails used",
                "Respectful behavior and dress required (active religious site)"
              ],
              "time": null,
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": null,
          "budget": {
            "meals": 0,
            "attractions": 39,
            "entertainment": 0,
            "accommodation": 0,
            "total": 39
          }
        }
      ]
    },
    {
      "name": "Macau",
      "days_label": "1 day",
      "cover": "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=400&fit=crop",
      "days": [
        {
          "day": 10,
          "date": "City 10",
          "location": "Macau",
          "cover": "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=400&fit=crop",
          "user_plans": [
            "7 attractions available"
          ],
          "meals": {
            "breakfast": {
              "name": "Lord Stow's Bakery",
              "name_en": "安德鲁饼店",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "lunch": {
              "name": "Margaret's Cafe e Nata",
              "name_en": "玛嘉烈蛋挞店",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            },
            "dinner": {
              "name": "Riquexo",
              "name_en": "礼记餐厅",
              "cost": 0,
              "cuisine": "",
              "signature_dishes": "",
              "image": "https://images.unsplash.com/photo-1496116218417-1a781b1c416c?w=300&h=200&fit=crop",
              "time": null,
              "links": {}
            }
          },
          "attractions": [
            {
              "name": "Ruins of St. Paul's",
              "name_en": "大三巴牌坊",
              "location": "",
              "type": "historical_site",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (Museum of Sacred Art behind ruins: 09:00-18:00, closed Tuesdays)",
              "recommended_duration": "1h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "FREE to visit facade and surrounding area",
                "Climb stairs to facade for detailed carvings - Biblical scenes and Jesuit symbols",
                "Museum of Sacred Art behind ruins (free) - religious artifacts and history"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Senado Square",
              "name_en": "议事亭前地",
              "location": "",
              "type": "cultural_district",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (shops 10:00-22:00)",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Starting point for Historic Centre walking tour",
                "Portuguese wave-pattern pavement (calçada portuguesa) - beautiful for photos",
                "Leal Senado Building (民政总署大楼) - Portuguese colonial architecture, free garden courtyard"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "A-Ma Temple",
              "name_en": "妈阁庙",
              "location": "",
              "type": "religious_site",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "07:00-18:00",
              "recommended_duration": "0.75h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "FREE entry - donations welcome",
                "Six main areas ascending hillside - Prayer Hall, Hall of Benevolence, Hall of Guanyin",
                "Active worship site - respectful behavior required"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "The Venetian Macao",
              "name_en": "澳门威尼斯人",
              "location": "",
              "type": "casino_resort",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "FREE to walk around - no entry fee for non-gamblers",
                "Grand Canal Shoppes - three Venetian canal sections with painted sky ceiling",
                "Gondola rides (17 EUR for 15 minutes) - gondoliers sing Italian songs"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Macau Tower",
              "name_en": "澳门旅游塔",
              "location": "",
              "type": "observation_tower",
              "cost": 19,
              "cost_eur": 19,
              "opening_hours": "10:00-21:00 (weekdays), 09:00-21:00 (weekends)",
              "recommended_duration": "1.5h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Observation deck entry: 19 EUR (includes levels 58 and 61)",
                "Bungee jump (233m) - 380 EUR, world's highest commercial jump",
                "Skywalk X (233m) - 100 EUR, walk around outer rim of tower"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Coloane Village",
              "name_en": "路环村",
              "location": "",
              "type": "village",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "24/7 (village), shops 09:00-18:00",
              "recommended_duration": "2h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Lord Stow's Bakery ORIGINAL location - best Portuguese egg tarts in Macau (1.50 EUR)",
                "Chapel of St. Francis Xavier - yellow colonial church, beautiful for photos",
                "Tam Kung Temple (谭公庙) - small seaside temple dedicated to sea god"
              ],
              "time": null,
              "links": {}
            },
            {
              "name": "Taipa Houses Museum",
              "name_en": "龙环葡韵住宅式博物馆",
              "location": "",
              "type": "museum",
              "cost": 0,
              "cost_eur": 0,
              "opening_hours": "10:00-19:00 (closed Mondays)",
              "recommended_duration": "1h",
              "image": "https://images.unsplash.com/photo-1548013146-72479768bada?w=400&h=300&fit=crop",
              "highlights": [
                "Completely FREE entry to all five houses",
                "Each house has different theme: Macanese home, traditions, exhibitions",
                "Lotus pond in front - reflection photos of green houses (Instagram favorite)"
              ],
              "time": null,
              "links": {}
            }
          ],
          "entertainment": [],
          "accommodation": null,
          "budget": {
            "meals": 0,
            "attractions": 19,
            "entertainment": 0,
            "accommodation": 0,
            "total": 19
          }
        }
      ]
    }
  ]
};

    
// ============================================================
// HOOKS
// ============================================================
const { useState, useEffect, useCallback } = React;

const useBreakpoint = () => {
  const [bp, setBp] = useState(() => {
    const w = window.innerWidth;
    return w < 640 ? 'sm' : w < 960 ? 'md' : 'lg';
  });
  useEffect(() => {
    const h = () => { const w = window.innerWidth; setBp(w < 640 ? 'sm' : w < 960 ? 'md' : 'lg'); };
    window.addEventListener('resize', h);
    return () => window.removeEventListener('resize', h);
  }, []);
  return bp;
};

// ============================================================
// ATOMS
// ============================================================
const LinkChip = ({ href, type, compact }) => {
  if (!href) return null;
  const cfg = {
    google_maps: { icon: '🌍', label: 'Google Maps', bg: '#edf2fc', color: '#2b63b5' },
    gaode: { icon: '🗺️', label: '高德', bg: '#e9f5ec', color: '#1a7a32' },
    xiaohongshu: { icon: '📕', label: '小红书', bg: '#fce8e6', color: '#c5221f' },
    booking: { icon: '🏨', label: 'Booking', bg: '#e8eaf6', color: '#1a237e' },
    dianping: { icon: '⭐', label: '点评', bg: '#fff3e0', color: '#e65100' }
  }[type] || { icon: '🔗', label: 'Link', bg: '#f5f5f5', color: '#666' };
  return (
    <a href={href} target="_blank" rel="noopener noreferrer" style={{
      display: 'inline-flex', alignItems: 'center', gap: '3px',
      padding: compact ? '2px 5px' : '2px 8px',
      background: cfg.bg, color: cfg.color,
      borderRadius: '3px', fontSize: compact ? '10px' : '11px',
      fontWeight: '500', textDecoration: 'none', transition: 'opacity .12s'
    }}
      onMouseEnter={e => e.currentTarget.style.opacity = '0.7'}
      onMouseLeave={e => e.currentTarget.style.opacity = '1'}
    >{cfg.icon}{compact ? '' : ` ${cfg.label}`}</a>
  );
};

const LinksRow = ({ links, compact }) => {
  if (!links || !Object.keys(links).length) return null;
  return (
    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '4px', marginTop: '8px' }}>
      {Object.entries(links).map(([t, u]) => <LinkChip key={t} href={u} type={t} compact={compact} />)}
    </div>
  );
};

const PropertyRow = ({ label, children }) => (
  <div style={{ display: 'flex', alignItems: 'baseline', padding: '5px 0', fontSize: '14px', lineHeight: '1.6' }}>
    <span style={{ width: '130px', flexShrink: 0, color: '#9b9a97', fontSize: '13px' }}>{label}</span>
    <span style={{ color: '#37352f' }}>{children}</span>
  </div>
);

const Section = ({ title, icon, children }) => (
  <div style={{ marginBottom: '32px' }}>
    <div style={{
      display: 'flex', alignItems: 'center', gap: '8px',
      fontSize: '15px', fontWeight: '600', color: '#37352f',
      paddingBottom: '6px', marginBottom: '14px',
      borderBottom: '1px solid #edece9'
    }}>
      <span style={{ fontSize: '16px' }}>{icon}</span> {title}
    </div>
    {children}
  </div>
);

const Donut = ({ budget, size = 80 }) => {
  const items = [
    { v: budget.meals || 0, c: '#f0b429' },
    { v: budget.attractions || 0, c: '#4a90d9' },
    { v: budget.entertainment || 0, c: '#9b6dd7' },
    { v: budget.accommodation || 0, c: '#45b26b' }
  ].filter(i => i.v > 0);
  const t = items.reduce((s, i) => s + i.v, 0);
  if (t === 0) return null;
  let cum = 0;
  const p = (r, a) => ({ x: 50 + r * Math.cos((a - 90) * Math.PI / 180), y: 50 + r * Math.sin((a - 90) * Math.PI / 180) });
  const arc = (sa, ea) => { const s = p(44, ea), e = p(44, sa); return `M${s.x},${s.y}A44,44,0,${ea - sa > 180 ? 1 : 0},0,${e.x},${e.y}L50,50Z`; };
  return (
    <svg viewBox="0 0 100 100" style={{ width: size, height: size }}>
      {items.map((it, i) => { const a = (it.v / t) * 360; const d = arc(cum, cum + a); cum += a; return <path key={i} d={d} fill={it.c} />; })}
      <circle cx="50" cy="50" r="24" fill="white" />
    </svg>
  );
};

const PropLine = ({ label, value }) => (
  <div style={{ fontSize: '12px', lineHeight: 1.7 }}>
    <span style={{ color: '#9b9a97' }}>{label}</span>{' '}
    <span style={{ color: '#37352f' }}>{value}</span>
  </div>
);

// ============================================================
// SIDEBAR
// ============================================================
const Sidebar = ({ trips, selTrip, selDay, onSelect, isOpen, onClose, bp }) => {
  const [exp, setExp] = useState({ [trips[0]?.name]: true });
  const mobile = bp === 'sm';
  const W = bp === 'lg' ? 240 : 220;

  return (
    <>
      {mobile && isOpen && <div onClick={onClose} style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.2)', zIndex: 199 }} />}
      <div style={{
        width: W, flexShrink: 0, background: '#fbfbfa', borderRight: '1px solid #f0efed',
        padding: '14px 8px', overflowY: 'auto', height: '100vh',
        position: mobile ? 'fixed' : 'sticky', top: 0, left: 0, zIndex: 200,
        transform: mobile && !isOpen ? `translateX(-${W + 10}px)` : 'none',
        transition: 'transform .25s ease',
        boxShadow: mobile && isOpen ? '2px 0 8px rgba(0,0,0,0.06)' : 'none'
      }}>
        <div style={{ padding: '4px 10px 12px', fontSize: '12px', fontWeight: '600', color: '#37352f', display: 'flex', alignItems: 'center', gap: '6px', lineHeight: '1.45' }}>
          <span>📋</span>
          <span style={{ flex: 1 }}>{PLAN_DATA.trip_summary.description}</span>
          {mobile && <button onClick={onClose} style={{ background: 'none', border: 'none', cursor: 'pointer', color: '#b4b4b4', fontSize: '14px' }}>✕</button>}
        </div>

        {trips.map((trip, ti) => {
          const open = exp[trip.name] !== false;
          const has = trip.days.length > 0;
          return (
            <div key={trip.name}>
              <div
                onClick={() => { setExp(p => ({ ...p, [trip.name]: !p[trip.name] })); if (has) onSelect(ti, 0); if (mobile) onClose(); }}
                style={{
                  display: 'flex', alignItems: 'center', gap: '4px',
                  padding: '5px 10px', borderRadius: '5px', cursor: 'pointer',
                  fontSize: '13px', color: '#37352f',
                  background: selTrip === ti ? 'rgba(55,53,47,0.06)' : 'transparent',
                  borderLeft: selTrip === ti ? '2px solid #37352f' : '2px solid transparent',
                  transition: 'all .1s'
                }}
                onMouseEnter={e => { if (selTrip !== ti) e.currentTarget.style.background = 'rgba(55,53,47,0.03)'; }}
                onMouseLeave={e => { if (selTrip !== ti) e.currentTarget.style.background = 'transparent'; }}
              >
                <span style={{ fontSize: '9px', color: '#b4b4b4', transform: open ? 'rotate(90deg)' : '', transition: 'transform .15s', display: 'inline-block', marginRight: '2px' }}>▶</span>
                <span style={{ fontWeight: '500', flex: 1 }}>{trip.name}</span>
                <span style={{ fontSize: '11px', color: '#b4b4b4' }}>({trip.days_label})</span>
              </div>
              {open && has && (
                <div style={{ marginLeft: '16px' }}>
                  {trip.days.map((d, di) => {
                    const active = selTrip === ti && selDay === di;
                    return (
                      <div key={di}
                        onClick={() => { onSelect(ti, di); if (mobile) onClose(); }}
                        style={{
                          padding: '4px 10px', borderRadius: '5px', cursor: 'pointer',
                          fontSize: '13px', color: '#37352f',
                          background: active ? 'rgba(55,53,47,0.06)' : 'transparent',
                          fontWeight: active ? '500' : '400',
                          borderLeft: active ? '2px solid #37352f' : '2px solid transparent',
                          transition: 'all .1s'
                        }}
                        onMouseEnter={e => { if (!active) e.currentTarget.style.background = 'rgba(55,53,47,0.03)'; }}
                        onMouseLeave={e => { if (!active) e.currentTarget.style.background = active ? 'rgba(55,53,47,0.06)' : 'transparent'; }}
                      >📄 Day {d.day}</div>
                    );
                  })}
                </div>
              )}
            </div>
          );
        })}
      </div>
    </>
  );
};

// ============================================================
// ITEM DETAIL SIDEBAR
// ============================================================
const ItemDetailSidebar = ({ item, type, onClose, bp }) => {
  if (!item) return null;
  const sm = bp === 'sm';
  const W = sm ? '85%' : '400px';

  return (
    <>
      <div onClick={onClose} style={{
        position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.2)', zIndex: 299
      }} />
      <div style={{
        position: 'fixed', right: 0, top: 0, bottom: 0,
        width: W, background: '#fff',
        boxShadow: '-2px 0 8px rgba(0,0,0,0.08)',
        overflowY: 'auto', zIndex: 300,
        animation: 'slideIn 0.25s ease',
        padding: '24px'
      }}>
        <style>{`@keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }`}</style>

        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '20px' }}>
          <div style={{ fontSize: '20px' }}>
            {{ meal: '🍽️', attraction: '📍', entertainment: '🎭', accommodation: '🏨' }[type] || '📄'}
          </div>
          <button onClick={onClose} style={{
            background: 'none', border: 'none', cursor: 'pointer',
            fontSize: '20px', color: '#b4b4b4', padding: '4px 8px'
          }}>✕</button>
        </div>

        {item.image && (
          <div style={{
            width: '100%', height: '200px', borderRadius: '8px',
            overflow: 'hidden', marginBottom: '20px', background: '#f5f3ef'
          }}>
            <img src={item.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover' }}
              onError={e => e.target.style.display = 'none'} />
          </div>
        )}

        <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#37352f', margin: '0 0 4px' }}>
          {item.name}
        </h2>
        {item.name_en && (
          <div style={{ fontSize: '14px', color: '#9b9a97', marginBottom: '20px' }}>{item.name_en}</div>
        )}
        {item.name_cn && (
          <div style={{ fontSize: '14px', color: '#9b9a97', marginBottom: '20px' }}>{item.name_cn}</div>
        )}

        <div style={{ borderTop: '1px solid #f0efed', paddingTop: '16px' }}>
          {item.time && (
            <PropertyRow label="Time">
              {item.time.start} – {item.time.end}
            </PropertyRow>
          )}
          {item.cost !== undefined && (
            <PropertyRow label="Cost">
              {item.cost === 0 ? 'Free' : `${item.cost} CNY`}
              {item.cost_eur && ` (€${item.cost_eur})`}
            </PropertyRow>
          )}
          {item.cuisine && <PropertyRow label="Cuisine">{item.cuisine}</PropertyRow>}
          {item.signature_dishes && <PropertyRow label="Signature Dishes">{item.signature_dishes}</PropertyRow>}
          {item.type && <PropertyRow label="Type">{item.type}</PropertyRow>}
          {item.location && <PropertyRow label="Location">{item.location}</PropertyRow>}
          {item.opening_hours && <PropertyRow label="Opening Hours">{item.opening_hours}</PropertyRow>}
          {item.recommended_duration && <PropertyRow label="Duration">{item.recommended_duration}</PropertyRow>}
          {item.duration && <PropertyRow label="Duration">{item.duration}</PropertyRow>}
          {item.stars && (
            <PropertyRow label="Stars">
              <span style={{ color: '#e9b200', letterSpacing: '1px' }}>{'★'.repeat(item.stars)}</span>
            </PropertyRow>
          )}
          {item.highlights && item.highlights.length > 0 && (
            <div style={{ marginTop: '16px' }}>
              <div style={{ fontSize: '13px', fontWeight: '600', color: '#37352f', marginBottom: '8px' }}>
                Highlights
              </div>
              <ul style={{ margin: 0, paddingLeft: '20px', fontSize: '14px', lineHeight: 1.8, color: '#37352f' }}>
                {item.highlights.map((h, i) => <li key={i}>{h}</li>)}
              </ul>
            </div>
          )}
          {item.note && (
            <div style={{
              marginTop: '16px', padding: '12px 16px',
              background: '#fffdf5', borderRadius: '6px',
              border: '1px solid #f5ecd7', fontSize: '13px', color: '#9a6700'
            }}>
              💡 {item.note}
            </div>
          )}
          {item.links && Object.keys(item.links).length > 0 && (
            <div style={{ marginTop: '20px' }}>
              <div style={{ fontSize: '13px', fontWeight: '600', color: '#37352f', marginBottom: '8px' }}>
                Links
              </div>
              <LinksRow links={item.links} />
            </div>
          )}
        </div>
      </div>
    </>
  );
};

// ============================================================
// BUDGET DETAIL SIDEBAR
// ============================================================
const BudgetDetailSidebar = ({ category, items, total, onClose, bp }) => {
  if (!category) return null;
  const sm = bp === 'sm';
  const W = sm ? '85%' : '400px';

  const categoryConfig = {
    meals: { icon: '🍽️', label: 'Meals', color: '#f0b429' },
    attractions: { icon: '📍', label: 'Attractions', color: '#4a90d9' },
    entertainment: { icon: '🎭', label: 'Entertainment', color: '#9b6dd7' },
    accommodation: { icon: '🏨', label: 'Accommodation', color: '#45b26b' }
  };
  const cfg = categoryConfig[category] || { icon: '💰', label: 'Budget', color: '#37352f' };

  return (
    <>
      <div onClick={onClose} style={{
        position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.2)', zIndex: 299
      }} />
      <div style={{
        position: 'fixed', right: 0, top: 0, bottom: 0,
        width: W, background: '#fff',
        boxShadow: '-2px 0 8px rgba(0,0,0,0.08)',
        overflowY: 'auto', zIndex: 300,
        animation: 'slideIn 0.25s ease',
        padding: '24px'
      }}>
        <style>{`@keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }`}</style>

        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '24px' }}>
          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
            <div style={{ fontSize: '24px' }}>{cfg.icon}</div>
            <h2 style={{ fontSize: '20px', fontWeight: '700', color: '#37352f', margin: 0 }}>
              {cfg.label}
            </h2>
          </div>
          <button onClick={onClose} style={{
            background: 'none', border: 'none', cursor: 'pointer',
            fontSize: '20px', color: '#b4b4b4', padding: '4px 8px'
          }}>✕</button>
        </div>

        {items && items.length > 0 ? (
          <div>
            {items.map((item, i) => (
              <div key={i} style={{
                padding: '14px 16px',
                background: '#fbfbfa',
                borderRadius: '6px',
                border: '1px solid #f0efed',
                marginBottom: '10px'
              }}>
                <div style={{ fontSize: '14px', fontWeight: '600', color: '#37352f', marginBottom: '4px' }}>
                  {item.name}
                </div>
                {item.name_en && (
                  <div style={{ fontSize: '12px', color: '#9b9a97', marginBottom: '6px' }}>{item.name_en}</div>
                )}
                {item.name_cn && (
                  <div style={{ fontSize: '12px', color: '#9b9a97', marginBottom: '6px' }}>{item.name_cn}</div>
                )}
                <div style={{
                  display: 'flex', justifyContent: 'space-between',
                  fontSize: '14px', marginTop: '8px'
                }}>
                  <span style={{ color: '#9b9a97' }}>Cost</span>
                  <span style={{ fontWeight: '600', color: cfg.color }}>
                    {item.cost === 0 ? 'Free' : `${item.cost} CNY`}
                  </span>
                </div>
              </div>
            ))}

            <div style={{
              marginTop: '20px', paddingTop: '16px',
              borderTop: '2px solid #edece9'
            }}>
              <div style={{
                display: 'flex', justifyContent: 'space-between',
                fontSize: '16px', fontWeight: '700', color: '#37352f'
              }}>
                <span>Total</span>
                <span style={{ color: cfg.color }}>{total} CNY</span>
              </div>
            </div>
          </div>
        ) : (
          <div style={{ padding: '40px 20px', textAlign: 'center', color: '#9b9a97' }}>
            <div style={{ fontSize: '48px', marginBottom: '12px' }}>{cfg.icon}</div>
            <div style={{ fontSize: '14px' }}>No items in this category</div>
          </div>
        )}
      </div>
    </>
  );
};

// ============================================================
// KANBAN VIEW
// ============================================================
const KanbanView = ({ day, tripSummary, showSummary, bp, onItemClick, onBudgetClick }) => {
  const sm = bp === 'sm';
  const px = sm ? '16px' : bp === 'md' ? '32px' : '48px';

  return (
    <div style={{ maxWidth: '960px' }}>
      <div style={{
        width: '100%',
        height: sm ? '120px' : '200px',
        background: `linear-gradient(to bottom, rgba(0,0,0,0) 50%, rgba(0,0,0,0.03) 100%), url(${day.cover || 'https://images.unsplash.com/photo-1609766856923-7e0a23024e9c?w=1200&h=400&fit=crop'})`,
        backgroundSize: 'cover', backgroundPosition: 'center'
      }} />

      <div style={{ padding: `0 ${px}` }}>
        <div style={{ marginTop: sm ? '-24px' : '-36px', marginBottom: '24px' }}>
          <div style={{ fontSize: sm ? '40px' : '56px', lineHeight: 1, marginBottom: '8px' }}>🗺️</div>

          {showSummary ? (
            <>
              <h1 style={{ fontSize: sm ? '24px' : '36px', fontWeight: '700', color: '#37352f', margin: '0 0 20px', lineHeight: 1.25 }}>
                {tripSummary.description}
              </h1>
              <div style={{
                padding: sm ? '12px' : '16px 20px',
                background: '#fbfbfa', borderRadius: '8px',
                border: '1px solid #f0efed', marginBottom: '32px'
              }}>
                <PropertyRow label="Trip Type">{tripSummary.trip_type}</PropertyRow>
                <PropertyRow label="Base Location">{tripSummary.base_location}</PropertyRow>
                <PropertyRow label="Period">{tripSummary.period}</PropertyRow>
                <PropertyRow label="Travelers">{tripSummary.travelers}</PropertyRow>
                <PropertyRow label="Budget / Trip">{tripSummary.budget_per_trip}</PropertyRow>
                <PropertyRow label="Preferences">{tripSummary.preferences}</PropertyRow>
              </div>
            </>
          ) : (
            <h1 style={{ fontSize: sm ? '24px' : '36px', fontWeight: '700', color: '#37352f', margin: '0 0 24px', lineHeight: 1.25 }}>
              Day {day.day} – {day.location}
            </h1>
          )}

          {showSummary && (
            <h2 style={{ fontSize: sm ? '20px' : '26px', fontWeight: '700', color: '#37352f', margin: '0 0 28px' }}>
              Day {day.day} – {day.location}
            </h2>
          )}
        </div>

        {/* User Plans */}
        {day.user_plans && day.user_plans.length > 0 && (
          <Section title="User Plans" icon="📝">
            <div style={{
              padding: '14px 18px', background: '#fafafa', borderRadius: '6px',
              border: '1px solid #f0efed'
            }}>
              <ul style={{ margin: 0, padding: '0 0 0 18px', fontSize: '14px', lineHeight: 2, color: '#37352f' }}>
                {day.user_plans.map((p, i) => <li key={i}>{p}</li>)}
              </ul>
            </div>
          </Section>
        )}

        {/* Meals */}
        <Section title="Meals" icon="🍽️">
          <div style={{ display: 'grid', gridTemplateColumns: sm ? '1fr' : 'repeat(3, 1fr)', gap: '14px' }}>
            {['breakfast', 'lunch', 'dinner'].map(type => {
              const meal = day.meals[type];
              if (!meal) return null;
              const lb = { breakfast: '🌅 Breakfast', lunch: '☀️ Lunch', dinner: '🌙 Dinner' }[type];
              return (
                <div key={type} style={{
                  background: '#fff', borderRadius: '8px',
                  boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)',
                  overflow: 'hidden', transition: 'box-shadow .15s', cursor: 'pointer'
                }}
                  onClick={() => onItemClick && onItemClick(meal, 'meal')}
                  onMouseEnter={e => e.currentTarget.style.boxShadow = '0 2px 8px rgba(0,0,0,0.08), 0 0 0 1px rgba(0,0,0,0.04)'}
                  onMouseLeave={e => e.currentTarget.style.boxShadow = '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)'}
                >
                  <div style={{ width: '100%', height: sm ? '100px' : '130px', overflow: 'hidden', background: '#f5f3ef' }}>
                    <img src={meal.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover' }}
                      onError={e => { e.target.style.display = 'none'; }} />
                  </div>
                  <div style={{ padding: '12px 14px' }}>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: '#37352f', marginBottom: '6px' }}>
                      {lb}: {meal.name}
                    </div>
                    {meal.name_en && <div style={{ fontSize: '12px', color: '#9b9a97', marginBottom: '6px' }}>{meal.name_en}</div>}
                    <div style={{ fontSize: '12px', color: '#6b6b6b', lineHeight: 1.7 }}>
                      <div><span style={{ color: '#9b9a97' }}>Cost</span> {meal.cost === 0 ? 'Free' : `${meal.cost} CNY`}</div>
                      {meal.cuisine && <div><span style={{ color: '#9b9a97' }}>Cuisine</span> {meal.cuisine}</div>}
                      {meal.signature_dishes && !sm && <div><span style={{ color: '#9b9a97' }}>Signature</span> {meal.signature_dishes}</div>}
                    </div>
                    <LinksRow links={meal.links} compact={sm} />
                  </div>
                </div>
              );
            })}
          </div>
        </Section>

        {/* Attractions + Right column */}
        <div style={{ display: 'grid', gridTemplateColumns: sm ? '1fr' : '1fr 1fr', gap: '24px' }}>
          {/* Attractions */}
          <Section title="Attractions" icon="📍">
            {day.attractions.map((attr, i) => (
              <div key={i} style={{
                background: '#fff', borderRadius: '8px',
                boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)',
                overflow: 'hidden', marginBottom: '14px', transition: 'box-shadow .15s', cursor: 'pointer'
              }}
                onClick={() => onItemClick && onItemClick(attr, 'attraction')}
                onMouseEnter={e => e.currentTarget.style.boxShadow = '0 2px 8px rgba(0,0,0,0.08), 0 0 0 1px rgba(0,0,0,0.04)'}
                onMouseLeave={e => e.currentTarget.style.boxShadow = '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)'}
              >
                {sm ? (
                  <>
                    <div style={{ height: '110px', overflow: 'hidden', background: '#eef4f9' }}>
                      <img src={attr.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover' }} onError={e => e.target.style.display = 'none'} />
                    </div>
                    <div style={{ padding: '12px 14px' }}>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#37352f', marginBottom: '4px' }}>{attr.name}</div>
                      {attr.name_en && <div style={{ fontSize: '12px', color: '#9b9a97', marginBottom: '6px' }}>{attr.name_en}</div>}
                      <PropLine label="Cost" value={attr.cost === 0 ? 'Free' : `${attr.cost} CNY${attr.cost_eur ? ` (€${attr.cost_eur})` : ''}`} />
                      <PropLine label="Hours" value={attr.opening_hours} />
                      <PropLine label="Duration" value={attr.recommended_duration} />
                      <LinksRow links={attr.links} compact />
                    </div>
                  </>
                ) : (
                  <div style={{ display: 'flex' }}>
                    <div style={{ width: '140px', flexShrink: 0, overflow: 'hidden', background: '#eef4f9' }}>
                      <img src={attr.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover', minHeight: '160px' }} onError={e => e.target.style.display = 'none'} />
                    </div>
                    <div style={{ padding: '14px 16px', flex: 1, lineHeight: 1.7 }}>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#37352f', marginBottom: '2px' }}>{attr.name}</div>
                      {attr.name_en && <div style={{ fontSize: '12px', color: '#9b9a97', marginBottom: '8px' }}>{attr.name_en}</div>}
                      {attr.location && <PropLine label="Location" value={attr.location} />}
                      <PropLine label="Type" value={attr.type} />
                      <PropLine label="Cost" value={attr.cost === 0 ? 'Free' : `${attr.cost} CNY${attr.cost_eur ? ` (€${attr.cost_eur})` : ''}`} />
                      <PropLine label="Hours" value={attr.opening_hours} />
                      <PropLine label="Duration" value={attr.recommended_duration} />
                      {attr.highlights && attr.highlights.length > 0 && (
                        <div style={{ marginTop: '6px' }}>
                          <span style={{ fontSize: '12px', color: '#9b9a97' }}>Highlights</span>
                          <ul style={{ margin: '2px 0 0', paddingLeft: '16px', fontSize: '12px', color: '#37352f', lineHeight: 1.7 }}>
                            {attr.highlights.map((h, j) => <li key={j}>{h}</li>)}
                          </ul>
                        </div>
                      )}
                      <LinksRow links={attr.links} />
                    </div>
                  </div>
                )}
              </div>
            ))}
          </Section>

          {/* Right column */}
          <div>
            {day.entertainment?.length > 0 && (
              <Section title="Entertainment" icon="🎭">
                {day.entertainment.map((ent, i) => (
                  <div key={i} style={{
                    background: '#fff', borderRadius: '8px',
                    boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)',
                    padding: '14px 16px', marginBottom: '10px', cursor: 'pointer'
                  }}
                    onClick={() => onItemClick && onItemClick(ent, 'entertainment')}
                  >
                    <div style={{ fontSize: '14px', fontWeight: '600', color: '#37352f', marginBottom: '8px' }}>{ent.name}</div>
                    {ent.name_en && <div style={{ fontSize: '12px', color: '#9b9a97', marginBottom: '6px' }}>{ent.name_en}</div>}
                    <PropLine label="Type" value={ent.type} />
                    <PropLine label="Cost" value={`${ent.cost} CNY`} />
                    <PropLine label="Duration" value={ent.duration} />
                    {ent.note && (
                      <div style={{ marginTop: '8px', padding: '8px 12px', background: '#fffdf5', borderRadius: '5px', border: '1px solid #f5ecd7', fontSize: '12px', color: '#9a6700' }}>
                        💡 {ent.note}
                      </div>
                    )}
                    <LinksRow links={ent.links} compact={sm} />
                  </div>
                ))}
              </Section>
            )}

            {day.accommodation && (
              <Section title="Accommodation" icon="🏨">
                <div style={{
                  background: '#fff', borderRadius: '8px',
                  boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)',
                  padding: '14px 16px', cursor: 'pointer'
                }}
                  onClick={() => onItemClick && onItemClick(day.accommodation, 'accommodation')}
                >
                  <div style={{ fontSize: '14px', fontWeight: '600', color: '#37352f', marginBottom: '4px' }}>{day.accommodation.name}</div>
                  {day.accommodation.name_cn && <div style={{ fontSize: '12px', color: '#9b9a97', marginBottom: '8px' }}>{day.accommodation.name_cn}</div>}
                  <PropLine label="Type" value={day.accommodation.type} />
                  <PropLine label="Stars" value={<span style={{ color: '#e9b200', letterSpacing: '1px' }}>{'★'.repeat(day.accommodation.stars)}</span>} />
                  <PropLine label="Location" value={day.accommodation.location} />
                  <PropLine label="Cost" value={`${day.accommodation.cost} CNY`} />
                  <LinksRow links={day.accommodation.links} compact={sm} />
                </div>
              </Section>
            )}

            <Section title="Budget" icon="💰">
              <div style={{
                background: '#fff', borderRadius: '8px',
                boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03)',
                padding: '16px'
              }}>
                <div style={{ display: 'flex', alignItems: sm ? 'center' : 'center', gap: '20px', flexDirection: sm ? 'column' : 'row' }}>
                  <Donut budget={day.budget} size={sm ? 72 : 88} />
                  <div style={{ fontSize: '13px', color: '#6b6b6b', lineHeight: 2, flex: 1, width: '100%' }}>
                    {[
                      { k: 'meals', l: 'Meals', c: '#f0b429' },
                      { k: 'attractions', l: 'Attractions', c: '#4a90d9' },
                      { k: 'entertainment', l: 'Entertainment', c: '#9b6dd7' },
                      { k: 'accommodation', l: 'Accommodation', c: '#45b26b' }
                    ].filter(r => day.budget[r.k] > 0).map(r => (
                      <div key={r.k} style={{
                        display: 'flex', alignItems: 'center', gap: '8px',
                        cursor: 'pointer', padding: '4px 6px', margin: '0 -6px',
                        borderRadius: '4px', transition: 'background .12s'
                      }}
                        onClick={() => onBudgetClick && onBudgetClick(r.k, day)}
                        onMouseEnter={e => e.currentTarget.style.background = 'rgba(55,53,47,0.04)'}
                        onMouseLeave={e => e.currentTarget.style.background = 'transparent'}
                      >
                        <span style={{ width: '10px', height: '10px', borderRadius: '3px', background: r.c, flexShrink: 0 }} />
                        <span style={{ flex: 1 }}>{r.l}</span>
                        <span style={{ fontWeight: '600', color: '#37352f' }}>{day.budget[r.k]} CNY</span>
                      </div>
                    ))}
                    <div style={{ borderTop: '1px solid #edece9', marginTop: '8px', paddingTop: '8px', fontWeight: '700', color: '#37352f', display: 'flex', justifyContent: 'space-between' }}>
                      <span>Total</span><span>{day.budget.total} CNY</span>
                    </div>
                  </div>
                </div>
              </div>
            </Section>
          </div>
        </div>
      </div>
    </div>
  );
};

// ============================================================
// TIMELINE VIEW
// ============================================================
const TimelineView = ({ day, bp, onItemClick }) => {
  const sm = bp === 'sm';
  const px = sm ? '16px' : bp === 'md' ? '32px' : '48px';
  const timeW = sm ? '48px' : '62px';

  const entries = [];
  const add = (item, type, label) => {
    // Only add if item has valid time with start and end
    if (item?.time?.start && item?.time?.end) {
      entries.push({ ...item, _type: type, _label: label });
    }
  };
  add(day.meals.breakfast, 'meal', 'Breakfast');
  add(day.meals.lunch, 'meal', 'Lunch');
  add(day.meals.dinner, 'meal', 'Dinner');
  day.attractions?.forEach(a => add(a, 'attraction', 'Attraction'));
  day.entertainment?.forEach(e => add(e, 'entertainment', 'Entertainment'));
  if (day.accommodation) add(day.accommodation, 'accommodation', 'Check-in');

  // Sort by start time
  entries.sort((a, b) => a.time.start.localeCompare(b.time.start));

  const firstH = entries.length ? parseInt(entries[0].time.start) : 8;
  const lastH = entries.length ? Math.min(parseInt(entries[entries.length - 1].time.start) + 2, 24) : 20;
  const hours = []; for (let h = firstH; h <= lastH; h++) hours.push(h);

  const hH = sm ? 68 : 80;
  const typeStyle = {
    meal: { bg: '#fffdf5', border: '#ebd984', dot: '#f0b429' },
    attraction: { bg: '#f6fafd', border: '#a8cceb', dot: '#4a90d9' },
    entertainment: { bg: '#faf6fd', border: '#c9aee6', dot: '#9b6dd7' },
    accommodation: { bg: '#f5fbf6', border: '#a2d9b1', dot: '#45b26b' }
  };

  const top = (t) => { const [h, m] = t.split(':').map(Number); return (h - firstH) * hH + (m / 60) * hH; };
  const hgt = (s, e) => Math.max(top(e) - top(s), sm ? 56 : 64);

  // Debug: log entries count
  if (entries.length === 0) {
    console.warn('Timeline has no entries for day:', day.day, day.location);
  }

  return (
    <div style={{ maxWidth: '900px' }}>
      <div style={{
        width: '100%', height: sm ? '100px' : '160px',
        background: `url(${day.cover || 'https://images.unsplash.com/photo-1609766856923-7e0a23024e9c?w=1200&h=400&fit=crop'})`,
        backgroundSize: 'cover', backgroundPosition: 'center'
      }} />

      <div style={{ padding: `0 ${px}` }}>
        <div style={{ marginTop: sm ? '-20px' : '-30px', marginBottom: '24px' }}>
          <div style={{ fontSize: sm ? '36px' : '48px', lineHeight: 1, marginBottom: '6px' }}>📍</div>
          <h2 style={{ fontSize: sm ? '22px' : '28px', fontWeight: '700', color: '#37352f', margin: 0 }}>
            Day {day.day} – {day.location}
          </h2>
        </div>

        {entries.length === 0 ? (
          <div style={{ padding: '40px 20px', textAlign: 'center', color: '#9b9a97' }}>
            <div style={{ fontSize: '48px', marginBottom: '16px' }}>⏰</div>
            <div style={{ fontSize: '16px', marginBottom: '8px' }}>No timeline data available</div>
            <div style={{ fontSize: '13px' }}>This day has no scheduled activities with time information</div>
          </div>
        ) : (
          <div style={{ display: 'flex', position: 'relative' }}>
          <div style={{ width: timeW, flexShrink: 0 }}>
            {hours.map(h => (
              <div key={h} style={{ height: hH, fontSize: '12px', color: '#c4c4c0', fontFamily: 'ui-monospace, monospace', paddingTop: '2px' }}>
                {String(h).padStart(2, '0')}:00
              </div>
            ))}
          </div>

          <div style={{ flex: 1, position: 'relative', borderLeft: '1px dashed #e5e4e1', minWidth: 0 }}>
            {hours.map(h => <div key={h} style={{ height: hH, borderBottom: '1px solid #f5f5f3' }} />)}

            {entries.map((entry, i) => {
              const st = typeStyle[entry._type] || typeStyle.attraction;
              const t = top(entry.time.start);
              const h = hgt(entry.time.start, entry.time.end);
              return (
                <div key={i} style={{
                  position: 'absolute', top: t, left: '10px', right: '10px',
                  minHeight: h - 4,
                  background: st.bg, borderLeft: `3px solid ${st.border}`,
                  borderRadius: '6px', padding: sm ? '8px 10px' : '10px 14px',
                  display: 'flex', gap: '10px', alignItems: 'flex-start',
                  boxShadow: '0 1px 3px rgba(0,0,0,0.04)',
                  zIndex: 2, overflow: 'hidden', transition: 'box-shadow .15s', cursor: 'pointer'
                }}
                  onClick={() => onItemClick && onItemClick(entry, entry._type)}
                  onMouseEnter={e => e.currentTarget.style.boxShadow = '0 2px 8px rgba(0,0,0,0.08)'}
                  onMouseLeave={e => e.currentTarget.style.boxShadow = '0 1px 3px rgba(0,0,0,0.04)'}
                >
                  <div style={{
                    position: 'absolute', left: '-8px', top: '50%', transform: 'translateY(-50%)',
                    width: '8px', height: '8px', borderRadius: '50%',
                    background: st.dot, border: '2px solid #fff'
                  }} />

                  {entry.image && !sm && (
                    <div style={{ width: '50px', height: '50px', borderRadius: '6px', overflow: 'hidden', flexShrink: 0 }}>
                      <img src={entry.image} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover' }} onError={e => e.target.style.display = 'none'} />
                    </div>
                  )}
                  <div style={{ flex: 1, minWidth: 0 }}>
                    <div style={{ fontSize: '11px', color: '#b4b4b4' }}>{entry.time.start} – {entry.time.end}</div>
                    <div style={{
                      fontSize: sm ? '12px' : '14px', fontWeight: '600', color: '#37352f',
                      whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis'
                    }}>
                      {entry._label}: {entry.name}
                    </div>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '6px', fontSize: '11px', color: '#9b9a97', flexWrap: 'wrap', marginTop: '2px' }}>
                      {entry.recommended_duration && <span>⏱ {entry.recommended_duration}</span>}
                      {entry.cost !== undefined && (
                        <span style={{
                          padding: '1px 6px', borderRadius: '3px', fontWeight: '600',
                          background: entry.cost === 0 ? '#e9f5ec' : '#f5f5f3',
                          color: entry.cost === 0 ? '#1a7a32' : '#37352f'
                        }}>
                          {entry.cost === 0 ? 'Free' : `¥${entry.cost}`}
                        </span>
                      )}
                      {entry.stars && <span style={{ color: '#e9b200' }}>{'★'.repeat(entry.stars)}</span>}
                    </div>
                    <LinksRow links={entry.links} compact={sm} />
                  </div>
                </div>
              );
            })}
          </div>
        </div>
        )}
      </div>
    </div>
  );
};

// ============================================================
// APP
// ============================================================
function NotionTravelApp() {
  const [selTrip, setSelTrip] = useState(0);
  const [selDay, setSelDay] = useState(0);
  const [view, setView] = useState('kanban');
  const [sbOpen, setSbOpen] = useState(false);
  const [selectedItem, setSelectedItem] = useState(null);
  const [selectedBudgetCat, setSelectedBudgetCat] = useState(null);
  const bp = useBreakpoint();
  const sm = bp === 'sm';

  const trip = PLAN_DATA.trips[selTrip];
  const day = trip?.days?.[selDay];

  const handleItemClick = (item, type) => {
    setSelectedBudgetCat(null);
    setSelectedItem({ item, type });
  };

  const handleBudgetClick = (category, dayData) => {
    setSelectedItem(null);

    let items = [];
    let total = 0;

    if (category === 'meals') {
      ['breakfast', 'lunch', 'dinner'].forEach(mealType => {
        if (dayData.meals[mealType]) {
          items.push(dayData.meals[mealType]);
          total += dayData.meals[mealType].cost || 0;
        }
      });
    } else if (category === 'attractions') {
      items = dayData.attractions || [];
      total = dayData.budget.attractions || 0;
    } else if (category === 'entertainment') {
      items = dayData.entertainment || [];
      total = dayData.budget.entertainment || 0;
    } else if (category === 'accommodation') {
      items = dayData.accommodation ? [dayData.accommodation] : [];
      total = dayData.budget.accommodation || 0;
    }

    setSelectedBudgetCat({ category, items, total });
  };

  return (
    <div style={{
      display: 'flex',
      fontFamily: "ui-sans-serif, -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, 'Noto Sans SC', sans-serif",
      background: '#ffffff', minHeight: '100vh', color: '#37352f'
    }}>
      <Sidebar
        trips={PLAN_DATA.trips} selTrip={selTrip} selDay={selDay}
        onSelect={(ti, di) => { setSelTrip(ti); setSelDay(di); }}
        isOpen={sbOpen} onClose={() => setSbOpen(false)} bp={bp}
      />

      <div style={{ flex: 1, minWidth: 0 }}>
        <div style={{
          borderBottom: '1px solid #f0efed',
          padding: `0 ${sm ? '12px' : '20px'}`,
          display: 'flex', alignItems: 'center',
          position: 'sticky', top: 0, background: 'rgba(255,255,255,0.97)',
          backdropFilter: 'blur(8px)', zIndex: 50, gap: '2px'
        }}>
          {sm && (
            <button onClick={() => setSbOpen(true)} style={{
              background: 'none', border: 'none', cursor: 'pointer',
              fontSize: '17px', padding: '10px 6px 10px 2px', color: '#37352f'
            }}>☰</button>
          )}
          {['kanban', 'timeline'].map(m => (
            <button key={m} onClick={() => setView(m)} style={{
              padding: sm ? '10px 8px' : '11px 16px', background: 'none', border: 'none',
              borderBottom: view === m ? '2px solid #37352f' : '2px solid transparent',
              fontSize: '14px', fontWeight: view === m ? '600' : '400',
              color: view === m ? '#37352f' : '#b4b4b4',
              cursor: 'pointer', transition: 'all .12s', whiteSpace: 'nowrap'
            }}>
              {m === 'kanban' ? 'Kanban View' : 'Timeline View'}
            </button>
          ))}
        </div>

        {day ? (
          view === 'kanban'
            ? <KanbanView
                day={day}
                tripSummary={PLAN_DATA.trip_summary}
                showSummary={selDay === 0 && selTrip === 0}
                bp={bp}
                onItemClick={handleItemClick}
                onBudgetClick={handleBudgetClick}
              />
            : <TimelineView
                day={day}
                bp={bp}
                onItemClick={handleItemClick}
              />
        ) : (
          <div style={{ padding: `60px ${sm ? '16px' : '48px'}`, color: '#c4c4c0' }}>
            <div style={{ fontSize: '48px', marginBottom: '12px' }}>🗺️</div>
            <div style={{ fontWeight: '500', fontSize: '16px', color: '#9b9a97' }}>{trip?.name}</div>
            <div style={{ marginTop: '4px' }}>Itinerary coming soon...</div>
          </div>
        )}

        {selectedItem && (
          <ItemDetailSidebar
            item={selectedItem.item}
            type={selectedItem.type}
            onClose={() => setSelectedItem(null)}
            bp={bp}
          />
        )}

        {selectedBudgetCat && (
          <BudgetDetailSidebar
            category={selectedBudgetCat.category}
            items={selectedBudgetCat.items}
            total={selectedBudgetCat.total}
            onClose={() => setSelectedBudgetCat(null)}
            bp={bp}
          />
        )}
      </div>
    </div>
  );
}


    // Render app
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<NotionTravelApp />);
  </script>
</body>
</html>